import{j as e,f as We,u as ze,h as ve,a as Rt,b as Qt,c as Ut,C as Mt,d as it,e as ne,S as vt,g as ct,O as Ot,i as Bt,A as Ht}from"./components-DhJOc2l3.js";import{r as l,u as fe,a as tt,b as jt,R as Vt,B as zt,c as dt,d as ae,N as mt}from"./router-cMghrlxF.js";import{a as Gt}from"./vendor-DavUf6mE.js";import{g as Ye,i as we,U as Ae,l as De,E as Ne,L as le,D as de,R as Ce,m as _t,n as ut,o as gt,S as Xe,H as wt,p as Oe,A as Kt,q as Wt,r as Jt,e as Ue,a as Be,F as Le,X as et,M as Zt,c as me,s as He,t as Nt,b as Ve,u as St,G as kt,v as Yt,w as je,x as Xt,y as Ct,T as ht,z as es,Z as be,J as ts,h as ss,K as xt,f as pt,N as Je,O as At,Q as as}from"./ui--EKNAzw6.js";(function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const x of i)if(x.type==="childList")for(const f of x.addedNodes)f.tagName==="LINK"&&f.rel==="modulepreload"&&n(f)}).observe(document,{childList:!0,subtree:!0});function p(i){const x={};return i.integrity&&(x.integrity=i.integrity),i.referrerPolicy&&(x.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?x.credentials="include":i.crossOrigin==="anonymous"?x.credentials="omit":x.credentials="same-origin",x}function n(i){if(i.ep)return;i.ep=!0;const x=p(i);fetch(i.href,x)}})();var Me={},bt;function rs(){if(bt)return Me;bt=1;var t=Gt();return Me.createRoot=t.createRoot,Me.hydrateRoot=t.hydrateRoot,Me}var ns=rs();const $e=({error:t,onClose:o,autoClose:p=!0,autoCloseDelay:n=5e3,type:i="error"})=>{const[x,f]=l.useState(!1);if(l.useEffect(()=>{if(t){if(console.log("🔔 [ErrorNotification] Error received:",t),f(!0),p){const E=setTimeout(()=>{console.log("🔔 [ErrorNotification] Auto-closing notification"),f(!1),setTimeout(o,300)},n);return()=>clearTimeout(E)}}else console.log("🔔 [ErrorNotification] No error, hiding notification"),f(!1)},[t,p,n,o]),!t)return null;const P={error:{container:"bg-red-50 border-red-200",icon:"text-red-500",title:"text-red-800",text:"text-red-700",closeButton:"text-red-400 hover:text-red-600",progressBg:"bg-red-200",progressBar:"bg-red-500",titleText:"Authentication Error"},warning:{container:"bg-yellow-50 border-yellow-200",icon:"text-yellow-500",title:"text-yellow-800",text:"text-yellow-700",closeButton:"text-yellow-400 hover:text-yellow-600",progressBg:"bg-yellow-200",progressBar:"bg-yellow-500",titleText:"Warning"},info:{container:"bg-blue-50 border-blue-200",icon:"text-blue-500",title:"text-blue-800",text:"text-blue-700",closeButton:"text-blue-400 hover:text-blue-600",progressBg:"bg-blue-200",progressBar:"bg-blue-500",titleText:"Information"}}[i];return e.jsx("div",{className:"fixed top-4 right-4 z-50 max-w-sm w-full",children:e.jsx("div",{className:`transform transition-all duration-300 ease-in-out ${x?"translate-x-0 opacity-100 scale-100":"translate-x-full opacity-0 scale-95"}`,children:e.jsxs("div",{className:`border rounded-lg shadow-lg p-4 relative ${P.container}`,children:[e.jsx("button",{onClick:()=>{f(!1),setTimeout(o,300)},className:`absolute top-2 right-2 transition-colors focus:outline-none focus:ring-2 focus:ring-offset-2 rounded-full p-1 ${P.closeButton}`,"aria-label":"Close notification",children:e.jsx(Ye,{className:"w-4 h-4"})}),e.jsxs("div",{className:"flex items-start gap-3 pr-6",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(we,{className:`w-5 h-5 ${P.icon}`})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:`text-sm font-semibold mb-1 ${P.title}`,children:P.titleText}),e.jsx("p",{className:`text-sm leading-relaxed ${P.text}`,children:t})]})]}),p&&e.jsx("div",{className:`mt-3 h-1 rounded-full overflow-hidden ${P.progressBg}`,children:e.jsx("div",{className:`h-full rounded-full transition-all duration-300 ease-linear ${P.progressBar}`,style:{width:x?"0%":"100%",transitionDuration:`${n}ms`}})})]})})})},st=()=>{const t=l.useCallback((h,P)=>{const E=h.target,S=E.value,q=We(S);return q!==S?(E.value=q,P(q),E.dispatchEvent(new Event("input",{bubbles:!0})),E.dispatchEvent(new Event("change",{bubbles:!0})),q):(P(S),S)},[]),o=l.useCallback((h,P)=>{h.preventDefault();const E=h.clipboardData.getData("text"),S=We(E),q=h.target;return q.value=S,P(S),q.dispatchEvent(new Event("input",{bubbles:!0})),S},[]),p=l.useCallback(h=>h.key==="Backspace"||h.key==="Delete"||h.key==="ArrowLeft"||h.key==="ArrowRight"||h.key==="ArrowUp"||h.key==="ArrowDown"||h.key==="Tab"||h.key==="Enter"||h.key==="Escape"||h.key==="Home"||h.key==="End"||h.key==="PageUp"||h.key==="PageDown"||h.key==="Shift"||h.key==="Control"||h.key==="Alt"||h.key==="Meta"?!0:(h.ctrlKey||h.metaKey||h.altKey)&&(h.key==="."||h.key===";"||h.key==="=")||h.key.length>1&&(h.key.includes("Emoji")||h.key.includes("emoji"))?(h.preventDefault(),!1):!0,[]),n=l.useCallback(h=>(h.preventDefault(),!1),[]),i=l.useCallback(h=>(h.preventDefault(),!1),[]),x=l.useCallback(h=>(h.preventDefault(),!1),[]),f=l.useCallback((h,P)=>{const E=h.target,S=E.value,q=We(S);return P(q),q!==S&&(E.value=q,E.dispatchEvent(new Event("input",{bubbles:!0})),E.dispatchEvent(new Event("change",{bubbles:!0}))),q},[]);return{handleInputChange:t,handleInputChangeAggressive:f,handlePaste:o,handleKeyDown:p,handleCompositionStart:n,handleCompositionUpdate:i,handleCompositionEnd:x}},se={localPart:{minLength:1,maxLength:64,allowedChars:/^[a-zA-Z0-9._%+-]+$/,startEndRules:/^[a-zA-Z0-9].*[a-zA-Z0-9]$/,consecutiveDots:/\.{2,}/,consecutiveSpecial:/[._%+-]{2,}/},domain:{minLength:2,maxLength:63,allowedChars:/^[a-zA-Z0-9.-]+$/,startEndRules:/^[a-zA-Z0-9].*[a-zA-Z0-9]$/,consecutiveDots:/\.{2,}/,consecutiveHyphens:/-{2,}/,tldMinLength:2,tldMaxLength:10},overall:{maxLength:254}},Et=t=>{const o=[],p=[];if(!t||typeof t!="string")return{isValid:!1,errors:["Email address is required"]};t.length>se.overall.maxLength&&o.push(`Email address is too long (maximum ${se.overall.maxLength} characters)`);const n=(t.match(/@/g)||[]).length;if(n===0?o.push("Email address must contain an @ symbol"):n>1&&o.push("Email address can only contain one @ symbol"),n!==1)return{isValid:!1,errors:o,suggestions:p};const[i,x]=t.split("@");return!i||i.length===0?o.push("Email address must have a local part (before @)"):ls(i,o,p),!x||x.length===0?o.push("Email address must have a domain part (after @)"):is(x,o,p),{isValid:o.length===0,errors:o,suggestions:p.length>0?p:void 0}},ge=t=>t.toLowerCase().endsWith("@gmail.com")?os(t):Et(t),os=t=>{const o=[],p=[];if(!t||typeof t!="string")return{isValid:!1,errors:["Email address is required"]};const n=t.split("@")[0];n.length<6&&o.push("Gmail local part must be at least 6 characters long"),n.length>30&&o.push("Gmail local part cannot exceed 30 characters"),(n.startsWith(".")||n.endsWith("."))&&o.push("Gmail local part must start and end with a letter or number"),/\.{2,}/.test(n)&&o.push("Gmail local part cannot contain consecutive dots");const i=Et(t);return o.push(...i.errors),{isValid:o.length===0,errors:o,suggestions:p.length>0?p:void 0}},ls=(t,o,p)=>{t.length<se.localPart.minLength&&o.push(`Local part must be at least ${se.localPart.minLength} characters long`),t.length>se.localPart.maxLength&&o.push(`Local part cannot exceed ${se.localPart.maxLength} characters`),se.localPart.allowedChars.test(t)||(o.push("Local part can only contain letters, numbers, and the following characters: . _ % + -"),p.push("Remove any special characters that are not allowed")),se.localPart.startEndRules.test(t)||(o.push("Local part must start and end with a letter or number"),p.push("Ensure the local part starts and ends with a letter or number")),se.localPart.consecutiveDots.test(t)&&(o.push("Local part cannot contain consecutive dots"),p.push("Remove consecutive dots from the local part")),se.localPart.consecutiveSpecial.test(t)&&(o.push("Local part cannot contain consecutive special characters"),p.push("Remove consecutive special characters from the local part")),(t.toLowerCase()==="gmail"||t.toLowerCase()==="google")&&(o.push("This local part is not allowed by Gmail"),p.push("Choose a different local part for your email address")),["admin","administrator","postmaster","abuse","webmaster","support","info"].includes(t.toLowerCase())&&p.push("This local part might be reserved. Consider using a different one.")},is=(t,o,p)=>{t.length<se.domain.minLength&&o.push(`Domain must be at least ${se.domain.minLength} characters long`),t.length>se.domain.maxLength&&o.push(`Domain cannot exceed ${se.domain.maxLength} characters`),se.domain.allowedChars.test(t)||(o.push("Domain can only contain letters, numbers, dots, and hyphens"),p.push("Remove any special characters that are not allowed in the domain")),se.domain.startEndRules.test(t)||(o.push("Domain must start and end with a letter or number"),p.push("Ensure the domain starts and ends with a letter or number")),se.domain.consecutiveDots.test(t)&&(o.push("Domain cannot contain consecutive dots"),p.push("Remove consecutive dots from the domain")),se.domain.consecutiveHyphens.test(t)&&(o.push("Domain cannot contain consecutive hyphens"),p.push("Remove consecutive hyphens from the domain"));const n=t.split(".");if(n.length<2)o.push("Domain must have at least one dot (e.g., .com, .org)");else{const i=n[n.length-1];i.length<se.domain.tldMinLength&&o.push(`Top-level domain must be at least ${se.domain.tldMinLength} characters long`),i.length>se.domain.tldMaxLength&&o.push(`Top-level domain cannot exceed ${se.domain.tldMaxLength} characters`),/^[a-zA-Z]+$/.test(i)||(o.push("Top-level domain can only contain letters"),p.push("Ensure the top-level domain contains only letters (e.g., .com, .org)"))}(t.toLowerCase()==="localhost"||t.toLowerCase()==="test")&&(o.push("This domain is not valid for email addresses"),p.push("Use a real domain name for your email address"))},he=(t,o)=>{if(o.isValid)return"";const p=o.errors[0];return{"Email address is required":"Please enter your email address","Email address must contain an @ symbol":"Please enter a valid email address","Email address can only contain one @ symbol":"Please enter a valid email address","Email address must have a local part (before @)":"Please enter a valid email address","Email address must have a domain part (after @)":"Please enter a valid email address","Local part must be at least 1 characters long":"Please enter a valid email address","Local part cannot exceed 64 characters":"Please enter a valid email address","Local part can only contain letters, numbers, and the following characters: . _ % + -":"Please enter a valid email address","Local part must start and end with a letter or number":"Please enter a valid email address","Local part cannot contain consecutive dots":"Please enter a valid email address","Local part cannot contain consecutive special characters":"Please enter a valid email address","Domain must be at least 2 characters long":"Please enter a valid email address","Domain cannot exceed 63 characters":"Please enter a valid email address","Domain can only contain letters, numbers, dots, and hyphens":"Please enter a valid email address","Domain must start and end with a letter or number":"Please enter a valid email address","Domain cannot contain consecutive dots":"Please enter a valid email address","Domain cannot contain consecutive hyphens":"Please enter a valid email address","Domain must have at least one dot (e.g., .com, .org)":"Please enter a valid email address","Top-level domain must be at least 2 characters long":"Please enter a valid email address","Top-level domain cannot exceed 10 characters":"Please enter a valid email address","Top-level domain can only contain letters":"Please enter a valid email address","Email address is too long (maximum 254 characters)":"Please enter a valid email address","Gmail local part must be at least 6 characters long":"Gmail addresses must be at least 6 characters before @","Gmail local part cannot exceed 30 characters":"Gmail addresses cannot exceed 30 characters before @","Gmail local part must start and end with a letter or number":"Gmail addresses must start and end with a letter or number"}[p]||"Please enter a valid email address"},Ee=t=>{if(!t)return"";let o=t.trim().toLowerCase();return o=o.replace(/\s+/g,""),o},cs=()=>{const[t,o]=l.useState({email:"",password:""}),[p,n]=l.useState(!1),[i,x]=l.useState(!1),[f,h]=l.useState({}),[P,E]=l.useState(null),[S,q]=l.useState(!0),T=fe(),R=tt(),{login:C,error:v,clearError:D,isAuthenticated:w,user:N}=ze(),{handleInputChangeAggressive:U,handlePaste:J,handleKeyDown:ee}=st();l.useEffect(()=>{o({email:"",password:""}),h({}),E(null),q(!0),R.state?.message&&(E(R.state.message),R.state.email&&o(g=>({...g,email:R.state.email})));const u=setTimeout(()=>{q(!1)},200);return()=>clearTimeout(u)},[R.state]),l.useEffect(()=>{v&&console.log("🔍 [Login] Error state changed:",v)},[v]),l.useEffect(()=>{w&&N&&(console.log("[Login] User is authenticated via AuthContext, redirecting to overview..."),T("/overview",{replace:!0}))},[T,w,N]),l.useEffect(()=>{const u=new URLSearchParams(window.location.search),g=u.has("code")||u.has("state")||u.has("error");g&&window.history.replaceState({},"","/login");const j=Q=>{g&&(window.location.pathname==="/login"||window.location.pathname==="/")&&window.history.replaceState({},"","/login")};return window.addEventListener("popstate",j),()=>{window.removeEventListener("popstate",j)}},[]);const k=(u,g)=>{if(u==="email"){if(!g.trim())return"Please enter your email address";const j=ge(g);return j.isValid?void 0:he(g,j)}if(u==="password")return g.trim()?void 0:"Please enter your password"},$=()=>{const u={},g=k("email",t.email),j=k("password",t.password);return g&&(u.email=g),j&&(u.password=j),h(u),Object.keys(u).length===0},Y=u=>{const{name:g,value:j}=u.target,Q=k(g,j);h(_=>({..._,[g]:Q}))},Z=async u=>{if(u.preventDefault(),!i)try{if(h({}),E(null),!$())return;x(!0),D();try{console.log("[Login] Attempting local login with:",{email:t.email,passwordLength:t.password?t.password.length:0}),await C("local",{email:t.email,password:t.password}),console.log("[Login] Local login successful")}catch(g){console.error("[Login] Local login error:",g);let j="Invalid credentials. Please check your email and password.";g&&typeof g=="object"&&(g.message&&typeof g.message=="string"?g.message.includes("Network")||g.message.includes("fetch")||g.message.includes("Failed to fetch")?j="Network error. Please check your connection and try again.":g.message.includes("timeout")||g.message.includes("Timeout")?j="Request timed out. Please try again.":g.message.includes("401")||g.message.includes("Unauthorized")?j="Invalid credentials. Please check your email and password.":g.message.includes("404")||g.message.includes("Not Found")?j="Account not found. Please check your email or sign up.":g.message.includes("500")||g.message.includes("Internal Server Error")?j="Server error. Please try again later.":g.message.includes("verify your email")&&(j=g.message):g.error&&typeof g.error=="string"&&(g.error.includes("Network")||g.error.includes("connection")?j="Network error. Please check your connection and try again.":g.error.includes("Invalid")||g.error.includes("credentials")?j="Invalid credentials. Please check your email and password.":g.error.includes("verify your email")&&(j=g.error))),E(j)}finally{x(!1)}}catch(g){console.error("[Login] Unexpected error during form submission:",g),E("An unexpected error occurred. Please try again."),x(!1)}},O=async()=>{if(!i){D(),E(null),x(!0);try{await C("google"),console.log("[Login] Google sign-in successful")}catch(u){console.error("[Login] Google sign-in error:",u);let g="Google sign-in failed. Please try again.";if(u&&typeof u=="object"&&u.message&&typeof u.message=="string")if(u.message.includes("cancelled")||u.message.includes("Cancelled")||u.message.includes("popup_closed_by_user")){x(!1);return}else u.message.includes("timed out")||u.message.includes("Timed out")?g="Google sign-in timed out. Please try again.":u.message.includes("Network")||u.message.includes("fetch")?g="Network error. Please check your connection and try again.":u.message.includes("access_denied")&&(g="Google sign-in was denied. Please try again.");E(g)}finally{x(!1)}}},y=async()=>{if(!i){D(),E(null),x(!0);try{console.log("[Login] Starting Microsoft sign-in..."),await C("microsoft"),console.log("[Login] Microsoft sign-in successful")}catch(u){console.error("[Login] Microsoft sign-in error:",u);let g="Microsoft sign-in failed. Please try again.";if(u&&typeof u=="object"&&u.message&&typeof u.message=="string")if(u.message.includes("cancelled")||u.message.includes("Cancelled")||u.message.includes("user_cancelled")){x(!1);return}else u.message.includes("timed out")||u.message.includes("Timed out")?g="Microsoft sign-in timed out. Please try again.":u.message.includes("Network")||u.message.includes("fetch")?g="Network error. Please check your connection and try again.":u.message.includes("access_denied")?g="Microsoft sign-in was denied. Please try again.":u.message.includes("invalid_client")&&(g="Microsoft sign-in configuration error. Please contact support.");E(g)}finally{x(!1)}}};return e.jsxs("div",{className:"min-h-screen flex items-center justify-center bg-gray-100 px-4 relative overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 bg-gray-200/30"}),e.jsx("div",{className:"absolute inset-0 bg-gray-300/20"}),e.jsx("div",{className:"absolute top-0 left-0 w-96 h-96 bg-gray-400/40 rounded-full blur-3xl -translate-x-1/2 -translate-y-1/2 animate-pulse"}),e.jsx("div",{className:"absolute bottom-0 right-0 w-[500px] h-[500px] bg-gray-500/40 rounded-full blur-3xl translate-x-1/2 translate-y-1/2 animate-pulse",style:{animationDelay:"1s"}}),e.jsx("div",{className:"absolute top-1/2 left-1/2 w-80 h-80 bg-gray-600/35 rounded-full blur-3xl -translate-x-1/2 -translate-y-1/2 animate-pulse",style:{animationDelay:"2s"}}),e.jsx("div",{className:"absolute top-1/4 right-1/4 w-32 h-32 bg-gradient-to-br from-cyan-300/30 to-blue-300/30 rounded-full blur-2xl animate-bounce",style:{animationDelay:"0.5s"}}),e.jsx("div",{className:"absolute bottom-1/4 left-1/4 w-24 h-24 bg-gradient-to-br from-purple-300/30 to-pink-300/30 rounded-full blur-2xl animate-bounce",style:{animationDelay:"1.5s"}}),e.jsx("div",{className:"absolute top-3/4 left-1/3 w-20 h-20 bg-gradient-to-br from-indigo-300/30 to-purple-300/30 rounded-full blur-2xl animate-bounce",style:{animationDelay:"2.5s"}}),e.jsx("div",{className:"absolute top-1/3 left-1/6 w-16 h-16 bg-gradient-to-br from-indigo-400/25 to-purple-400/25 rotate-45 blur-xl animate-spin",style:{animationDuration:"8s"}}),e.jsx("div",{className:"absolute bottom-1/3 right-1/6 w-20 h-20 bg-gradient-to-br from-blue-400/25 to-cyan-400/25 rotate-12 blur-xl animate-spin",style:{animationDuration:"12s",animationDirection:"reverse"}}),e.jsx("div",{className:"absolute top-1/6 right-1/3 w-12 h-12 bg-gradient-to-br from-pink-400/25 to-purple-400/25 rotate-30 blur-lg animate-spin",style:{animationDuration:"6s"}}),e.jsx("div",{className:"absolute top-1/5 left-1/5 w-8 h-8 bg-gradient-to-br from-cyan-400/20 to-blue-400/20 rounded-full blur-md animate-ping",style:{animationDelay:"0s"}}),e.jsx("div",{className:"absolute top-2/5 right-1/5 w-6 h-6 bg-gradient-to-br from-purple-400/20 to-pink-400/20 rounded-full blur-md animate-ping",style:{animationDelay:"1s"}}),e.jsx("div",{className:"absolute bottom-1/5 left-2/5 w-10 h-10 bg-gradient-to-br from-indigo-400/20 to-blue-400/20 rounded-full blur-md animate-ping",style:{animationDelay:"2s"}}),e.jsx("div",{className:"absolute bottom-2/5 right-2/5 w-7 h-7 bg-gradient-to-br from-cyan-400/20 to-indigo-400/20 rounded-full blur-md animate-ping",style:{animationDelay:"3s"}}),e.jsx("div",{className:"absolute top-0 left-1/2 w-64 h-64 bg-gradient-to-br from-blue-300/15 to-indigo-300/15 rounded-full blur-2xl animate-pulse",style:{animationDuration:"4s"}}),e.jsx("div",{className:"absolute bottom-0 left-1/4 w-48 h-48 bg-gradient-to-br from-purple-300/15 to-pink-300/15 rounded-full blur-2xl animate-pulse",style:{animationDuration:"6s",animationDelay:"1s"}}),e.jsxs("div",{className:"w-full max-w-lg mx-auto p-8 bg-white/90 backdrop-blur-md rounded-2xl shadow-2xl border border-white/30 relative z-10 bg-gradient-to-br from-white/95 via-white/90 to-white/95",children:[e.jsxs("div",{className:"text-center mb-10",children:[e.jsx("div",{className:"w-24 h-24 bg-blue-600 rounded-2xl flex items-center justify-center mx-auto mb-6 shadow-lg",children:e.jsx(Ae,{className:"w-12 h-12 text-white"})}),e.jsx("h1",{className:"text-4xl font-bold text-black mb-3",children:"Welcome to kabini.ai"}),e.jsx("p",{className:"text-gray-600 text-lg",children:"Sign in to your account to continue"})]}),e.jsxs("form",{onSubmit:Z,className:"space-y-8",children:[e.jsxs("div",{style:{display:"none"},children:[e.jsx("input",{type:"text",name:"fake-email",autoComplete:"username"}),e.jsx("input",{type:"password",name:"fake-password",autoComplete:"current-password"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-bold text-gray-900 mb-3",children:["Email ",e.jsx("span",{className:"text-red-600",children:"*"})]}),e.jsx("input",{type:"email",name:"email",value:t.email,onChange:u=>U(u,g=>{const j=Ee(g);o(_=>({..._,email:j}));const Q=ge(j);Q.isValid?h(_=>({..._,email:void 0})):h(_=>({..._,email:he(j,Q)}))}),onPaste:u=>J(u,g=>{const j=Ee(g);o(_=>({..._,email:j}));const Q=ge(j);Q.isValid?h(_=>({..._,email:void 0})):h(_=>({..._,email:he(j,Q)}))}),onKeyDown:ee,onCompositionStart:u=>u.preventDefault(),onCompositionUpdate:u=>u.preventDefault(),onCompositionEnd:u=>u.preventDefault(),onBlur:Y,required:!0,inputMode:"email",autoComplete:"off","data-form-type":"other","data-lpignore":"true",readOnly:S,"aria-invalid":!!f.email,"aria-describedby":f.email?"email-error":void 0,className:`w-full px-4 py-4 border-2 rounded-xl text-gray-900 placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-black focus:border-black transition-all ${f.email?"border-red-500 focus:ring-red-500 focus:border-red-500":"border-gray-300"}`,placeholder:"Enter your email address *"}),f.email&&e.jsxs("p",{id:"email-error",className:"mt-2 text-sm text-red-600 flex items-center gap-1",role:"alert","aria-live":"polite",children:[e.jsx("svg",{className:"w-4 h-4 flex-shrink-0",fill:"currentColor",viewBox:"0 0 20 20","aria-hidden":"true",children:e.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),f.email]})]}),e.jsxs("div",{className:"relative",children:[e.jsxs("label",{className:"block text-sm font-bold text-gray-900 mb-3",children:["Password ",e.jsx("span",{className:"text-red-600",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:p?"text":"password",name:"password",value:t.password,onChange:u=>U(u,g=>{o(j=>({...j,password:g})),g.trim()?h(j=>({...j,password:void 0})):h(j=>({...j,password:"Please enter your password"}))}),onPaste:u=>J(u,g=>{o(j=>({...j,password:g})),g.trim()?h(j=>({...j,password:void 0})):h(j=>({...j,password:"Please enter your password"}))}),onKeyDown:ee,onCompositionStart:u=>u.preventDefault(),onCompositionUpdate:u=>u.preventDefault(),onCompositionEnd:u=>u.preventDefault(),required:!0,autoComplete:"new-password","data-form-type":"other","data-lpignore":"true",readOnly:S,"aria-invalid":!!f.password,"aria-describedby":f.password?"password-error":void 0,placeholder:"Enter your password *",className:`w-full px-4 py-4 border-2 rounded-xl text-gray-900 placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-black focus:border-black transition-all ${f.password?"border-red-500 focus:ring-red-500 focus:border-red-500":"border-gray-300"}`}),e.jsx("button",{type:"button",onClick:()=>n(!p),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600 transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 rounded","aria-label":p?"Hide password":"Show password",title:p?"Hide password":"Show password",children:p?e.jsx(De,{className:"w-5 h-5"}):e.jsx(Ne,{className:"w-5 h-5"})})]}),f.password&&e.jsxs("p",{id:"password-error",className:"mt-2 text-sm text-red-600 flex items-center gap-1",role:"alert","aria-live":"polite",children:[e.jsx("svg",{className:"w-4 h-4 flex-shrink-0",fill:"currentColor",viewBox:"0 0 20 20","aria-hidden":"true",children:e.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),f.password]})]}),e.jsx("button",{type:"submit",className:"w-full bg-blue-600 text-white font-bold py-4 px-6 rounded-xl hover:bg-blue-700 transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2 shadow-lg transform hover:scale-[1.02]",disabled:i,children:i?e.jsx(le,{className:"w-5 h-5 animate-spin"}):"Sign In"})]}),e.jsxs("div",{className:"mt-6 text-center space-y-2",children:[e.jsx("div",{children:e.jsx("span",{onClick:()=>T("/forgot-password"),className:"text-sm text-black hover:text-gray-700 underline hover:no-underline transition-colors cursor-pointer",children:"Forgot your password?"})}),e.jsx("div",{children:e.jsx("span",{onClick:()=>T("/signup"),className:"text-sm text-black hover:text-gray-700 underline hover:no-underline transition-colors cursor-pointer",children:"Don't have an account? Sign up"})})]}),e.jsxs("div",{className:"mt-10 space-y-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-0 flex items-center",children:e.jsx("div",{className:"w-full border-t border-gray-300"})}),e.jsx("div",{className:"relative flex justify-center text-sm",children:e.jsx("span",{className:"px-2 bg-white text-gray-500",children:"Or continue with"})})]}),e.jsx("button",{onClick:O,disabled:i,className:"w-full bg-white border-2 border-grey-300 text-black font-semibold py-4 px-6 rounded-xl hover:bg-grey-50 hover:border-grey-400 hover:text-gray-700 transition-all flex items-center justify-center gap-4 disabled:opacity-50 disabled:cursor-not-allowed",children:i?e.jsxs(e.Fragment,{children:[e.jsx(le,{className:"w-6 h-6 animate-spin"}),e.jsx("span",{children:"Signing in with Google..."})]}):e.jsxs(e.Fragment,{children:[e.jsx("img",{src:"/google.svg",alt:"Google",className:"w-6 h-6"}),"Sign in with Google"]})}),e.jsxs("button",{onClick:y,disabled:i,className:"w-full bg-white border-2 border-grey-300 text-black font-semibold py-4 px-6 rounded-xl hover:bg-grey-50 hover:border-grey-400 hover:text-gray-700 transition-all flex items-center justify-center gap-4 disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx("img",{src:"/microsoft.svg",alt:"Microsoft",className:"w-6 h-6"}),"Sign in with Microsoft"]})]})]}),e.jsx($e,{error:P||(v&&typeof v=="string"?v:null),onClose:()=>{E(null),D()},autoClose:!0,autoCloseDelay:5e3})]})};function ds(t,o,p){const n=new Blob([t],{type:p}),i=URL.createObjectURL(n),x=document.createElement("a");x.href=i,x.download=o,document.body.appendChild(x),x.click(),document.body.removeChild(x),URL.revokeObjectURL(i)}function ms({qaItems:t,onExport:o}){const[p,n]=l.useState([]),[i,x]=l.useState([]),[f,h]=l.useState([]),[P,E]=l.useState(new Set),[S,q]=l.useState(new Set),[T,R]=l.useState(0),[C,v]=l.useState({searchTerm:"",dateFilter:"all",specificDate:"",typeFilter:"all",statusFilter:"all",showFilters:!1,groupBy:"date",sortBy:"date",sortOrder:"desc"});l.useEffect(()=>{(async()=>{try{const r=await ve.getHistoryItems();console.log("[History] Loaded items:",r.length,r);const b=r.filter(d=>d&&typeof d=="object"&&d.id&&d.type&&d.name&&d.timestamp);console.log("[History] Valid items:",b.length,b),n(b)}catch(r){console.error("[History] Error loading history items:",r),n([])}})()},[T]),l.useEffect(()=>{(async()=>{console.log("[History] Component mounted, loading initial history items");try{const r=await ve.getHistoryItems();n(r)}catch(r){console.error("[History] Error loading initial history items:",r),n([])}})()},[]),l.useEffect(()=>{t&&t.length>0&&(console.log("[History] qaItems prop changed, syncing with history service"),R(a=>a+1))},[t]),l.useEffect(()=>{const a=d=>{d.key&&d.key.includes("comprehensive_history")&&(console.log("[History] Storage changed, refreshing history"),R(V=>V+1))},r=()=>{console.log("[History] New analysis event received, refreshing history"),R(d=>d+1)};window.addEventListener("new-analysis-created",r),window.addEventListener("storage",a);const b=async()=>{try{const d=await ve.getHistoryItems();d.length!==p.length&&(console.log("[History] Item count changed on focus, refreshing history"),n(d))}catch(d){console.error("[History] Error checking history on focus:",d)}};return window.addEventListener("focus",b),()=>{window.removeEventListener("new-analysis-created",r),window.removeEventListener("storage",a),window.removeEventListener("focus",b)}},[p.length]);const D=l.useMemo(()=>{const a=new Set,r=new Set;return p.forEach(b=>{b.type&&a.add(b.type),b.status&&r.add(b.status)}),{types:Array.from(a).filter(Boolean).sort(),statuses:Array.from(r).filter(Boolean).sort()}},[p,T]);l.useEffect(()=>{console.log("[History] History items updated:",p.length,"items"),console.log("[History] History data:",p);let a=[...p];if(C.searchTerm&&(a=a.filter(r=>r.name.toLowerCase().includes(C.searchTerm.toLowerCase())||r.description?.toLowerCase().includes(C.searchTerm.toLowerCase())||r.type==="qa"&&r.sessionData.qaData.some(b=>b.question.toLowerCase().includes(C.searchTerm.toLowerCase())||b.answer.toLowerCase().includes(C.searchTerm.toLowerCase()))||r.type==="ai-visibility"&&r.company.toLowerCase().includes(C.searchTerm.toLowerCase()))),C.dateFilter!=="all"){const r=new Date,b=new Date;switch(C.dateFilter){case"today":b.setHours(0,0,0,0);break;case"week":b.setDate(r.getDate()-7);break;case"month":b.setMonth(r.getMonth()-1);break;case"year":b.setFullYear(r.getFullYear()-1);break;case"specific":if(C.specificDate){const d=new Date(C.specificDate);d.setHours(0,0,0,0);const V=new Date(C.specificDate);V.setHours(23,59,59,999),a=a.filter(G=>{const B=new Date(G.timestamp);return B>=d&&B<=V})}break}C.dateFilter!=="specific"&&(a=a.filter(d=>new Date(d.timestamp)>=b))}C.typeFilter!=="all"&&(a=a.filter(r=>r.type===C.typeFilter)),C.statusFilter!=="all"&&(a=a.filter(r=>r.status===C.statusFilter)),a.sort((r,b)=>{let d,V;switch(C.sortBy){case"date":d=new Date(r.timestamp).getTime(),V=new Date(b.timestamp).getTime();break;case"name":d=r.name.toLowerCase(),V=b.name.toLowerCase();break;case"type":d=r.type,V=b.type;break;case"status":d=r.status,V=b.status;break;default:d=new Date(r.timestamp).getTime(),V=new Date(b.timestamp).getTime()}return C.sortOrder==="asc"?d>V?1:-1:d<V?1:-1}),console.log("[History] Filtered items:",a.length,"items"),x(a)},[p,C,T]),l.useEffect(()=>{const a=[],r=new Map;i.forEach(b=>{let d="";switch(C.groupBy){case"date":const V=new Date(b.timestamp);d=V.toDateString(),V.toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"});break;case"type":d=b.type,U(b.type);break;case"status":d=b.status,b.status.charAt(0).toUpperCase()+b.status.slice(1);break}r.has(d)||r.set(d,[]),r.get(d).push(b)}),r.forEach((b,d)=>{let V=d;C.groupBy==="date"?V=new Date(d).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"}):C.groupBy==="type"?V=U(d):C.groupBy==="status"&&(V=d.charAt(0).toUpperCase()+d.slice(1)),a.push({groupKey:d,groupTitle:V,groupType:C.groupBy,items:b,totalItems:b.length,dateRange:C.groupBy==="date"?d:void 0})}),a.sort((b,d)=>C.groupBy==="date"?new Date(d.groupKey).getTime()-new Date(b.groupKey).getTime():b.groupTitle.localeCompare(d.groupTitle)),h(a)},[i,C.groupBy,T]);const w=a=>{const r=new Set(P);r.has(a)?r.delete(a):r.add(a),E(r)},N=a=>{const r=new Set(S);r.has(a)?r.delete(a):r.add(a),q(r)},U=a=>{if(!a)return"Unknown";switch(a){case"qa":return"Q&A Sessions";case"ai-visibility":return"AI Visibility Analysis";case"content-analysis":return"Content Analysis";case"structure-analysis":return"Structure Analysis";default:return a}},J=a=>{switch(a){case"completed":return"text-green-600 bg-green-100";case"in-progress":return"text-yellow-600 bg-yellow-100";case"failed":return"text-red-600 bg-red-100";default:return"text-gray-600 bg-gray-100"}},ee=a=>{try{if(!a||!a.type)return console.error("[History] Invalid item:",a),e.jsx("div",{className:"text-red-500",children:"Invalid item data"});switch(a.type){case"qa":return k(a);case"ai-visibility":return $(a);case"content-analysis":return Y(a);case"structure-analysis":return Z(a);default:return e.jsxs("div",{className:"text-orange-500",children:["Unknown item type: ",a.type]})}}catch(r){return console.error("[History] Error rendering item:",r,a),e.jsxs("div",{className:"text-red-500",children:["Error rendering item: ",r.message]})}},k=a=>e.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 bg-gray-50",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-blue-500 rounded-full flex items-center justify-center",children:e.jsx(Le,{className:"h-4 w-4 text-white"})}),e.jsxs("div",{children:[e.jsx("div",{className:"font-bold text-black",children:a.name}),e.jsx("div",{className:"text-xs text-grey-600",children:Q(a.timestamp)}),e.jsxs("div",{className:"text-xs text-black",children:[a.sessionData.qaData.length," Q&A pairs"]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${J(a.status)}`,children:a.status}),e.jsx("input",{type:"checkbox",checked:S.has(a.id),onChange:()=>N(a.id),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"})]})]}),e.jsxs("div",{className:"space-y-3",children:[a.sessionData.qaData.slice(0,3).map((r,b)=>e.jsxs("div",{className:"bg-white rounded-lg p-3 border border-gray-200",children:[e.jsxs("div",{className:"font-semibold text-gray-900 mb-2",children:["Q",b+1,": ",r.question]}),r.answer&&e.jsxs("div",{className:"text-sm text-gray-700 mb-2",children:[r.answer.substring(0,100),"..."]}),e.jsxs("div",{className:"flex gap-2 text-xs text-gray-500",children:[e.jsxs("span",{children:["Accuracy: ",r.accuracy||"N/A"]}),e.jsxs("span",{children:["Sentiment: ",r.sentiment||"N/A"]}),e.jsxs("span",{children:["Cost: $",(r.cost||0).toFixed(4)]})]})]},b)),a.sessionData.qaData.length>3&&e.jsxs("div",{className:"text-center text-sm text-gray-500",children:["+",a.sessionData.qaData.length-3," more Q&A pairs"]})]}),e.jsxs("div",{className:"flex gap-2 mt-4",children:[e.jsxs("button",{onClick:()=>y(a.id),className:"bg-blue-600 text-white px-3 py-1 rounded text-sm hover:bg-blue-700 transition flex items-center gap-1",children:[e.jsx(de,{className:"h-3 w-3"}),"JSON"]}),e.jsxs("button",{onClick:()=>u(a.id),className:"bg-green-600 text-white px-3 py-1 rounded text-sm hover:bg-green-700 transition flex items-center gap-1",children:[e.jsx(de,{className:"h-3 w-3"}),"CSV"]}),e.jsxs("button",{onClick:()=>g(a.id),className:"bg-red-600 text-white px-3 py-1 rounded text-sm hover:bg-red-700 transition flex items-center gap-1",children:[e.jsx(Ue,{className:"h-3 w-3"}),"Delete"]})]})]}),$=a=>!a.analysis||!a.analysis.competitors?e.jsxs("div",{className:"border border-red-200 rounded-lg p-4 bg-red-50",children:[e.jsx("div",{className:"text-red-600",children:"Invalid AI Visibility data structure"}),e.jsx("div",{className:"text-xs text-red-500 mt-2",children:"Missing analysis or competitors data"})]}):e.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 bg-gray-50",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-purple-500 rounded-full flex items-center justify-center",children:e.jsx(Ne,{className:"h-4 w-4 text-white"})}),e.jsxs("div",{children:[e.jsx("div",{className:"font-bold text-black",children:a.name}),e.jsx("div",{className:"text-xs text-grey-600",children:Q(a.timestamp)}),e.jsxs("div",{className:"text-xs text-purple-600",children:[a.analysis.competitors?.length||0," competitors analyzed"]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${J(a.status)}`,children:a.status}),e.jsx("input",{type:"checkbox",checked:S.has(a.id),onChange:()=>N(a.id),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"bg-white rounded-lg p-3 border border-gray-200",children:[e.jsxs("div",{className:"font-semibold text-gray-900 mb-2",children:["Company: ",a.company]}),a.industry&&e.jsxs("div",{className:"text-sm text-gray-600 mb-2",children:["Industry: ",a.industry]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs",children:[e.jsxs("div",{children:["Top Competitor: ",a.analysis.summary?.topCompetitor||"N/A"]}),e.jsxs("div",{children:["Avg Score: ",a.analysis.summary?.averageVisibilityScore?.toFixed(1)||"N/A"]})]})]}),e.jsxs("div",{className:"space-y-2",children:[a.analysis.competitors.slice(0,3).map((r,b)=>e.jsxs("div",{className:"bg-white rounded-lg p-2 border border-gray-200",children:[e.jsx("div",{className:"font-medium text-sm",children:r.name}),e.jsxs("div",{className:"text-xs text-gray-600",children:["Avg Score: ",r.visibilityScores?.average?.toFixed(1)||"N/A"]})]},b)),a.analysis.competitors.length>3&&e.jsxs("div",{className:"text-center text-sm text-gray-500",children:["+",a.analysis.competitors.length-3," more competitors"]})]})]}),e.jsxs("div",{className:"flex gap-2 mt-4",children:[e.jsxs("button",{onClick:()=>y(a.id),className:"bg-blue-600 text-white px-3 py-1 rounded text-sm hover:bg-blue-700 transition flex items-center gap-1",children:[e.jsx(de,{className:"h-3 w-3"}),"JSON"]}),e.jsxs("button",{onClick:()=>u(a.id),className:"bg-green-600 text-white px-3 py-1 rounded text-sm hover:bg-green-700 transition flex items-center gap-1",children:[e.jsx(de,{className:"h-3 w-3"}),"CSV"]}),e.jsxs("button",{onClick:()=>g(a.id),className:"bg-red-600 text-white px-3 py-1 rounded text-sm hover:bg-red-700 transition flex items-center gap-1",children:[e.jsx(Ue,{className:"h-3 w-3"}),"Delete"]})]})]}),Y=a=>a.analysis?e.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 bg-gray-50",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-green-500 rounded-full flex items-center justify-center",children:e.jsx(Be,{className:"h-4 w-4 text-white"})}),e.jsxs("div",{children:[e.jsx("div",{className:"font-bold text-black",children:a.name}),e.jsx("div",{className:"text-xs text-grey-600",children:Q(a.timestamp)}),e.jsxs("div",{className:"text-xs text-green-600",children:["SEO Score: ",a.analysis?.seoScore||"N/A","/100"]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${J(a.status)}`,children:a.status}),e.jsx("input",{type:"checkbox",checked:S.has(a.id),onChange:()=>N(a.id),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"})]})]}),e.jsxs("div",{className:"bg-white rounded-lg p-3 border border-gray-200",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold text-gray-900",children:"SEO Score"}),e.jsx("div",{className:"text-2xl font-bold text-green-600",children:a.analysis?.seoScore||"N/A"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold text-gray-900",children:"Readability"}),e.jsx("div",{className:"text-2xl font-bold text-black",children:a.analysis?.readabilityScore||"N/A"})]})]}),a.analysis?.suggestions?.length>0&&e.jsxs("div",{className:"mt-3",children:[e.jsx("div",{className:"font-semibold text-gray-900 mb-2",children:"Suggestions"}),e.jsxs("div",{className:"space-y-1",children:[a.analysis.suggestions.slice(0,3).map((r,b)=>e.jsxs("div",{className:"text-xs text-gray-600",children:["• ",r.description]},b)),a.analysis.suggestions.length>3&&e.jsxs("div",{className:"text-xs text-gray-500",children:["+",a.analysis.suggestions.length-3," more suggestions"]})]})]})]}),e.jsxs("div",{className:"flex gap-2 mt-4",children:[e.jsxs("button",{onClick:()=>y(a.id),className:"bg-blue-600 text-white px-3 py-1 rounded text-sm hover:bg-blue-700 transition flex items-center gap-1",children:[e.jsx(de,{className:"h-3 w-3"}),"JSON"]}),e.jsxs("button",{onClick:()=>u(a.id),className:"bg-green-600 text-white px-3 py-1 rounded text-sm hover:bg-green-700 transition flex items-center gap-1",children:[e.jsx(de,{className:"h-3 w-3"}),"CSV"]}),e.jsxs("button",{onClick:()=>g(a.id),className:"bg-red-600 text-white px-3 py-1 rounded text-sm hover:bg-red-700 transition flex items-center gap-1",children:[e.jsx(Ue,{className:"h-3 w-3"}),"Delete"]})]})]}):e.jsxs("div",{className:"border border-red-200 rounded-lg p-4 bg-red-50",children:[e.jsx("div",{className:"text-red-600",children:"Invalid Content Analysis data structure"}),e.jsx("div",{className:"text-xs text-red-500 mt-2",children:"Missing analysis data"})]}),Z=a=>e.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 bg-gray-50",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-orange-500 rounded-full flex items-center justify-center",children:e.jsx(Jt,{className:"h-4 w-4 text-white"})}),e.jsxs("div",{children:[e.jsx("div",{className:"font-bold text-black",children:a.name}),e.jsx("div",{className:"text-xs text-grey-600",children:Q(a.timestamp)}),e.jsxs("div",{className:"text-xs text-orange-600",children:[a.analysis.suggestions?.length||0," suggestions"]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${J(a.status)}`,children:a.status}),e.jsx("input",{type:"checkbox",checked:S.has(a.id),onChange:()=>N(a.id),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"})]})]}),e.jsxs("div",{className:"bg-white rounded-lg p-3 border border-gray-200",children:[a.analysis.geoScoreTotal!==void 0||a.analysis.contentQualityScoreTotal!==void 0?e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm mb-4",children:[a.analysis.geoScoreTotal!==void 0&&e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold text-gray-900",children:"GEO Score"}),e.jsxs("div",{className:"text-xl font-bold text-red-600",children:[a.analysis.geoScoreTotal,"/100"]}),e.jsx("div",{className:"text-xs text-gray-600",children:"AI visibility & search optimization"})]}),a.analysis.contentQualityScoreTotal!==void 0&&e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold text-gray-900",children:"Content Quality"}),e.jsxs("div",{className:"text-xl font-bold text-orange-600",children:[a.analysis.contentQualityScoreTotal,"/100"]}),e.jsx("div",{className:"text-xs text-gray-600",children:"Human/editorial score"})]})]}):null,e.jsxs("div",{className:"grid grid-cols-4 gap-2 text-xs text-gray-600 mb-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:a.analysis.wordCount||a.analysis.metadata?.wordCount||0}),e.jsx("div",{children:"Words"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:a.analysis.readingTime||a.analysis.metadata?.readingTime||1}),e.jsx("div",{children:"Min Read"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:a.analysis.suggestionsCount||a.analysis.suggestions?.length||0}),e.jsx("div",{children:"Suggestions"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:(a.analysis.language||a.analysis.metadata?.language||"en").toUpperCase()}),e.jsx("div",{children:"Language"})]})]}),a.analysis.suggestions&&a.analysis.suggestions.length>0&&e.jsxs("div",{className:"mt-3",children:[e.jsxs("div",{className:"font-semibold text-gray-900 mb-2",children:["Top Suggestions (",a.analysis.suggestions.length," total)"]}),e.jsxs("div",{className:"space-y-2",children:[a.analysis.suggestions.slice(0,5).map((r,b)=>e.jsxs("div",{className:"bg-gray-50 rounded p-2 border-l-4 border-blue-500",children:[e.jsxs("div",{className:"text-xs text-gray-600 font-medium mb-1",children:[r.type.charAt(0).toUpperCase()+r.type.slice(1)," • ",r.priority]}),e.jsx("div",{className:"text-xs text-gray-800",children:r.description}),r.impact&&e.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Impact: ",r.impact]})]},b)),a.analysis.suggestions.length>5&&e.jsxs("div",{className:"text-center text-xs text-gray-500 bg-gray-100 rounded p-2",children:["+",a.analysis.suggestions.length-5," more suggestions available"]})]})]})]}),e.jsxs("div",{className:"flex gap-2 mt-4",children:[e.jsxs("button",{onClick:()=>y(a.id),className:"bg-blue-600 text-white px-3 py-1 rounded text-sm hover:bg-blue-700 transition flex items-center gap-1",children:[e.jsx(de,{className:"h-3 w-3"}),"JSON"]}),e.jsxs("button",{onClick:()=>u(a.id),className:"bg-green-600 text-white px-3 py-1 rounded text-sm hover:bg-green-700 transition flex items-center gap-1",children:[e.jsx(de,{className:"h-3 w-3"}),"CSV"]}),e.jsxs("button",{onClick:()=>g(a.id),className:"bg-red-600 text-white px-3 py-1 rounded text-sm hover:bg-red-700 transition flex items-center gap-1",children:[e.jsx(Ue,{className:"h-3 w-3"}),"Delete"]})]})]}),O=()=>{const a=S.size>0?i.filter(G=>S.has(G.id)):i;let r="";a.forEach(G=>{switch(G.type){case"qa":const B=G;r+=`
=== Q&A SESSION: ${B.name} ===
`,r+=`Session ID,${B.id}
`,r+=`Timestamp,${new Date(B.timestamp).toISOString()}
`,r+=`Model,${B.sessionData.model}
`,r+=`Total Questions,${B.sessionData.qaData.length}
`,r+=`Total Cost,${B.sessionData.statistics.totalCost}
`,r+=`Average Accuracy,${B.sessionData.statistics.avgAccuracy}%
`,r+=`Blog Content,"${B.sessionData.blogContent.replace(/"/g,'""')}"
`,r+=`
Question,Answer,Accuracy,Sentiment,Geo Score,Citation Likelihood,Input Tokens,Output Tokens,Total Tokens,Cost
`,B.sessionData.qaData.forEach((H,at)=>{r+=`"${H.question.replace(/"/g,'""')}","${H.answer.replace(/"/g,'""')}",${H.accuracy}%,${H.sentiment},${H.geoScore},${H.citationLikelihood},${H.inputTokens},${H.outputTokens},${H.totalTokens},$${H.cost}
`});break;case"ai-visibility":const X=G;r+=`
=== AI VISIBILITY ANALYSIS: ${X.name} ===
`,r+=`Company,${X.company}
`,r+=`Industry,${X.industry||"N/A"}
`,r+=`Timestamp,${new Date(X.timestamp).toISOString()}
`,r+=`Overall Score,${X.analysis.overallScore}
`,r+=`Content Quality,${X.analysis.contentQuality}
`,r+=`Technical SEO,${X.analysis.technicalSEO}
`,r+=`User Experience,${X.analysis.userExperience}
`,r+=`Competitive Position,${X.analysis.competitivePosition}
`,r+=`
Competitors Found:
`,r+=`Competitor Name,Website,Relevance Score,Strengths,Weaknesses
`,X.analysis.competitors.forEach(H=>{r+=`"${H.name}","${H.website}",${H.relevanceScore},"${H.strengths.join("; ").replace(/"/g,'""')}","${H.weaknesses.join("; ").replace(/"/g,'""')}"
`}),r+=`
Recommendations:
`,r+=`Priority,Recommendation,Impact,Effort
`,X.analysis.recommendations.forEach(H=>{r+=`${H.priority},"${H.recommendation.replace(/"/g,'""')}",${H.impact},${H.effort}
`});break;case"content-analysis":const M=G;r+=`
=== CONTENT ANALYSIS: ${M.name} ===
`,r+=`URL,${M.url||"N/A"}
`,r+=`Timestamp,${new Date(M.timestamp).toISOString()}
`,r+=`SEO Score,${M.analysis.seoScore}
`,r+=`Readability Score,${M.analysis.readabilityScore}
`,r+=`Content Length,${M.analysis.contentLength} words
`,r+=`Keyword Density,${M.analysis.keywordDensity}%
`,r+=`
Analyzed Content:
`,r+=`"${M.content.replace(/"/g,'""')}"
`,r+=`
Suggestions:
`,r+=`Category,Suggestion,Priority
`,M.analysis.suggestions.forEach(H=>{r+=`${H.category},"${H.suggestion.replace(/"/g,'""')}",${H.priority}
`});break;case"structure-analysis":const F=G;r+=`
=== STRUCTURE ANALYSIS: ${F.name} ===
`,r+=`Timestamp,${new Date(F.timestamp).toISOString()}
`,r+=`Original Content Length,${F.originalContent.length} characters
`,r+=`Structured Content Length,${F.structuredContent.length} characters
`,r+=`
Analysis Scores:
`,F.analysis.geoScoreTotal!==void 0&&(r+=`GEO Score,${F.analysis.geoScoreTotal}/100
`),F.analysis.contentQualityScoreTotal!==void 0&&(r+=`Content Quality Score,${F.analysis.contentQualityScoreTotal}/100
`),r+=`
Content Metadata:
`,r+=`Title,${F.analysis.metadata.title}
`,r+=`Description,${F.analysis.metadata.description}
`,r+=`Keywords,"${F.analysis.metadata.keywords.join(", ")}"
`,r+=`Author,${F.analysis.metadata.author}
`,r+=`Publish Date,${F.analysis.metadata.publishDate}
`,r+=`Last Modified,${F.analysis.metadata.lastModified}
`,r+=`Reading Time,${F.analysis.metadata.readingTime} minutes
`,r+=`Word Count,${F.analysis.metadata.wordCount}
`,r+=`Language,${F.analysis.metadata.language}
`,r+=`
Original Content:
`,r+=`"${F.originalContent.replace(/"/g,'""')}"
`,r+=`
Structured Content:
`,r+=`"${F.structuredContent.replace(/"/g,'""')}"
`,r+=`
Structure Suggestions:
`,r+=`Type,Priority,Description,Implementation,Impact
`,F.analysis.suggestions.forEach(H=>{r+=`${H.type},${H.priority},"${H.description.replace(/"/g,'""')}","${H.implementation.replace(/"/g,'""')}","${H.impact.replace(/"/g,'""')}"
`});break;default:r+=`
=== UNKNOWN TYPE: ${G.name} ===
`,r+=`ID,${G.id}
`,r+=`Type,${G.type}
`,r+=`Status,${G.status}
`,r+=`Timestamp,${new Date(G.timestamp).toISOString()}
`,r+=`Description,${G.description||"N/A"}
`}r+=`
`+"=".repeat(80)+`
`});const b=`COMPREHENSIVE HISTORY EXPORT
`,d=`Export Date: ${new Date().toISOString()}
`,V=`Total Items: ${a.length}
`;o(b+d+V+r,"comprehensive-history-detailed.csv","text/csv")},y=a=>{console.log("[History] Downloading item:",a);try{const r=ve.exportHistoryItem(a);r&&r.content?(console.log("[History] Export data:",r),o(r.content,r.filename,r.mimeType)):(console.error("[History] No export data found for item:",a),alert("No data found for this item. It might be sample data or corrupted."))}catch(r){console.error("[History] Error downloading item:",r),alert("Error downloading item. Please try again.")}},u=a=>{console.log("[History] Downloading item as CSV:",a);const b=ve.getHistoryItems().find(G=>G.id===a);if(!b){alert("Item not found!");return}let d="";switch(b.type){case"qa":const G=b;d+=`Q&A Session Export
`,d+=`Session Name,${G.name}
`,d+=`Session ID,${G.id}
`,d+=`Timestamp,${new Date(G.timestamp).toISOString()}
`,d+=`Model,${G.sessionData.model}
`,d+=`Total Questions,${G.sessionData.qaData.length}
`,d+=`Total Cost,${G.sessionData.statistics.totalCost}
`,d+=`Average Accuracy,${G.sessionData.statistics.avgAccuracy}%
`,d+=`Blog Content,"${G.sessionData.blogContent.replace(/"/g,'""')}"

`,d+=`Question,Answer,Accuracy,Sentiment,Geo Score,Citation Likelihood,Input Tokens,Output Tokens,Total Tokens,Cost
`,G.sessionData.qaData.forEach((F,H)=>{d+=`"${F.question.replace(/"/g,'""')}","${F.answer.replace(/"/g,'""')}",${F.accuracy}%,${F.sentiment},${F.geoScore},${F.citationLikelihood},${F.inputTokens},${F.outputTokens},${F.totalTokens},$${F.cost}
`});break;case"ai-visibility":const B=b;d+=`AI Visibility Analysis Export
`,d+=`Analysis Name,${B.name}
`,d+=`Company,${B.company}
`,d+=`Industry,${B.industry||"N/A"}
`,d+=`Timestamp,${new Date(B.timestamp).toISOString()}
`,d+=`Overall Score,${B.analysis.overallScore}
`,d+=`Content Quality,${B.analysis.contentQuality}
`,d+=`Technical SEO,${B.analysis.technicalSEO}
`,d+=`User Experience,${B.analysis.userExperience}
`,d+=`Competitive Position,${B.analysis.competitivePosition}

`,d+=`Competitors:
`,d+=`Name,Website,Relevance Score,Strengths,Weaknesses
`,B.analysis.competitors.forEach(F=>{d+=`"${F.name}","${F.website}",${F.relevanceScore},"${F.strengths.join("; ").replace(/"/g,'""')}","${F.weaknesses.join("; ").replace(/"/g,'""')}"
`}),d+=`
Recommendations:
`,d+=`Priority,Recommendation,Impact,Effort
`,B.analysis.recommendations.forEach(F=>{d+=`${F.priority},"${F.recommendation.replace(/"/g,'""')}",${F.impact},${F.effort}
`});break;case"content-analysis":const X=b;d+=`Content Analysis Export
`,d+=`Analysis Name,${X.name}
`,d+=`URL,${X.url||"N/A"}
`,d+=`Timestamp,${new Date(X.timestamp).toISOString()}
`,d+=`SEO Score,${X.analysis.seoScore}
`,d+=`Readability Score,${X.analysis.readabilityScore}
`,d+=`Content Length,${X.analysis.contentLength} words
`,d+=`Keyword Density,${X.analysis.keywordDensity}%

`,d+=`Analyzed Content:
`,d+=`"${X.content.replace(/"/g,'""')}"

`,d+=`Suggestions:
`,d+=`Category,Suggestion,Priority
`,X.analysis.suggestions.forEach(F=>{d+=`${F.category},"${F.suggestion.replace(/"/g,'""')}",${F.priority}
`});break;case"structure-analysis":const M=b;d+=`Structure Analysis Export
`,d+=`Analysis Name,${M.name}
`,d+=`Timestamp,${new Date(M.timestamp).toISOString()}
`,d+=`Original Content Length,${M.originalContent.length} characters
`,d+=`Structured Content Length,${M.structuredContent.length} characters

`,d+=`Analysis Scores:
`,M.analysis.geoScoreTotal!==void 0&&(d+=`GEO Score,${M.analysis.geoScoreTotal}/100
`),M.analysis.contentQualityScoreTotal!==void 0&&(d+=`Content Quality Score,${M.analysis.contentQualityScoreTotal}/100
`),d+=`
`,d+=`Content Metadata:
`,d+=`Title,${M.analysis.metadata.title}
`,d+=`Description,${M.analysis.metadata.description}
`,d+=`Keywords,"${M.analysis.metadata.keywords.join(", ")}"
`,d+=`Author,${M.analysis.metadata.author}
`,d+=`Publish Date,${M.analysis.metadata.publishDate}
`,d+=`Last Modified,${M.analysis.metadata.lastModified}
`,d+=`Reading Time,${M.analysis.metadata.readingTime} minutes
`,d+=`Word Count,${M.analysis.metadata.wordCount}
`,d+=`Language,${M.analysis.metadata.language}

`,d+=`Original Content:
`,d+=`"${M.originalContent.replace(/"/g,'""')}"

`,d+=`Structured Content:
`,d+=`"${M.structuredContent.replace(/"/g,'""')}"

`,d+=`Structure Suggestions:
`,d+=`Type,Priority,Description,Implementation,Impact
`,M.analysis.suggestions.forEach(F=>{d+=`${F.type},${F.priority},"${F.description.replace(/"/g,'""')}","${F.implementation.replace(/"/g,'""')}","${F.impact.replace(/"/g,'""')}"
`});break;default:d+=`Unknown Type Export
`,d+=`Name,${b.name}
`,d+=`Type,${b.type}
`,d+=`Status,${b.status}
`,d+=`Timestamp,${new Date(b.timestamp).toISOString()}
`,d+=`Description,${b.description||"N/A"}
`}const V=`${b.type}-${b.name.replace(/[^a-zA-Z0-9]/g,"-")}-${new Date(b.timestamp).toISOString().split("T")[0]}.csv`;o(d,V,"text/csv")},g=a=>{confirm("Are you sure you want to delete this history item? This action cannot be undone.")&&(ve.deleteHistoryItem(a),R(r=>r+1))},j=()=>{const a=S.size>0?i.filter(b=>S.has(b.id)):i,r={exportedAt:new Date().toISOString(),total:a.length,filtersApplied:{...C},items:a};o(JSON.stringify(r,null,2),"history-export.json","application/json")},Q=a=>new Date(a).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),_=a=>{switch(a){case"date":return e.jsx(Wt,{className:"h-4 w-4"});case"type":return e.jsx(Oe,{className:"h-4 w-4"});case"status":return e.jsx(Kt,{className:"h-4 w-4"});default:return e.jsx(Oe,{className:"h-4 w-4"})}};return e.jsxs("div",{className:"max-w-7xl mx-auto py-6 px-4",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h1",{className:"text-2xl lg:text-3xl font-bold text-gray-900 mb-3",children:"Comprehensive History"}),e.jsx("p",{className:"text-gray-600 text-base lg:text-lg",children:"View and manage all your analysis history including Q&A, AI visibility, content analysis, and structure analysis"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[e.jsxs("div",{className:"bg-white rounded-lg p-4 border border-gray-200 text-center shadow-sm",children:[e.jsx("div",{className:"text-sm font-semibold text-gray-700 mb-1",children:"Total Items"}),e.jsx("div",{className:"text-2xl font-bold text-gray-900",children:i.length})]}),e.jsxs("div",{className:"bg-white rounded-lg p-4 border border-gray-200 text-center shadow-sm",children:[e.jsx("div",{className:"text-sm font-semibold text-gray-700 mb-1",children:"Q&A Sessions"}),e.jsx("div",{className:"text-2xl font-bold text-gray-900",children:i.filter(a=>a.type==="qa").length})]}),e.jsxs("div",{className:"bg-white rounded-lg p-4 border border-gray-200 text-center shadow-sm",children:[e.jsx("div",{className:"text-sm font-semibold text-gray-700 mb-1",children:"AI Visibility"}),e.jsx("div",{className:"text-2xl font-bold text-gray-900",children:i.filter(a=>a.type==="ai-visibility").length})]}),e.jsxs("div",{className:"bg-white rounded-lg p-4 border border-gray-200 text-center shadow-sm",children:[e.jsx("div",{className:"text-sm font-semibold text-gray-700 mb-1",children:"Selected Items"}),e.jsx("div",{className:"text-2xl font-bold text-gray-900",children:S.size})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 mb-6",children:[e.jsxs("button",{onClick:O,className:"bg-blue-600 text-white px-4 py-2 rounded-lg font-semibold shadow hover:bg-blue-700 transition flex items-center gap-2 justify-center",children:[e.jsx(de,{className:"h-4 w-4"}),"Export CSV"]}),e.jsxs("button",{onClick:j,className:"bg-blue-600 text-white px-4 py-2 rounded-lg font-semibold shadow hover:bg-blue-700 transition flex items-center gap-2 justify-center",children:[e.jsx(de,{className:"h-4 w-4"}),"Export JSON"]}),e.jsxs("button",{onClick:()=>{localStorage.removeItem("comprehensive_history"),n([]),x([]),h([]),alert("History cleared. Please refresh the page.")},className:"bg-blue-600 text-white px-4 py-2 rounded-lg font-semibold shadow hover:bg-blue-700 transition flex items-center gap-2 justify-center",children:[e.jsx(Ce,{className:"h-4 w-4"}),"Reset History"]})]}),e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-4 mb-6 overflow-visible relative",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h2",{className:"text-lg font-semibold text-gray-900 flex items-center gap-2",children:[e.jsx(_t,{className:"h-5 w-5"}),"Filters & Organization"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{onClick:()=>v(a=>({...a,showFilters:!a.showFilters})),className:"bg-gray-100 hover:bg-gray-200 text-gray-700 px-3 py-2 rounded-lg flex items-center gap-2 transition text-sm",children:[C.showFilters?e.jsx(ut,{className:"h-4 w-4"}):e.jsx(gt,{className:"h-4 w-4"}),C.showFilters?"Hide":"Show"," Filters"]}),e.jsxs("button",{onClick:()=>{console.log("[History] Manual refresh triggered");const a=ve.getHistoryItems();n(a),R(r=>r+1)},className:"bg-green-100 hover:bg-green-200 text-green-700 px-3 py-2 rounded-lg flex items-center gap-2 transition text-sm",children:[e.jsx(Ce,{className:"h-4 w-4"}),"Refresh"]}),e.jsxs("div",{className:"flex items-center gap-1 bg-blue-50 px-3 py-2 rounded-lg",children:[e.jsx("span",{className:"text-sm font-medium text-black",children:"Group by:"}),e.jsxs("select",{value:C.groupBy,onChange:a=>v(r=>({...r,groupBy:a.target.value})),className:"text-sm border-0 bg-transparent text-blue-700 font-medium focus:ring-0 focus:outline-none",children:[e.jsx("option",{value:"date",children:"Date"}),e.jsx("option",{value:"type",children:"Type"}),e.jsx("option",{value:"status",children:"Status"})]})]})]})]}),C.showFilters&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Search"}),e.jsxs("div",{className:"relative",children:[e.jsx(Xe,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search all analysis...",value:C.searchTerm,onChange:a=>Qt(a,r=>v(b=>({...b,searchTerm:r}))),onPaste:a=>Rt(a,r=>v(b=>({...b,searchTerm:r}))),onKeyDown:a=>{Ut(a)||a.preventDefault()},className:"w-full pl-10 pr-4 py-2 border border-grey-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-white text-blue-600 placeholder-grey-400 relative z-10"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date Range"}),e.jsxs("select",{value:C.dateFilter,onChange:a=>v(r=>({...r,dateFilter:a.target.value})),className:"w-full px-3 py-2 border border-grey-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-white text-blue-600 relative z-10",children:[e.jsx("option",{value:"all",children:"All Time"}),e.jsx("option",{value:"today",children:"Today"}),e.jsx("option",{value:"week",children:"Last 7 Days"}),e.jsx("option",{value:"month",children:"Last 30 Days"}),e.jsx("option",{value:"year",children:"Last Year"}),e.jsx("option",{value:"specific",children:"Specific date…"})]}),C.dateFilter==="specific"&&e.jsx("div",{className:"mt-2",children:e.jsx("input",{type:"date",value:C.specificDate,onChange:a=>v(r=>({...r,specificDate:a.target.value})),className:"w-full px-3 py-2 border border-grey-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-white text-blue-600"})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Analysis Type"}),e.jsxs("select",{value:C.typeFilter,onChange:a=>v(r=>({...r,typeFilter:a.target.value})),className:"w-full px-3 py-2 border border-grey-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-white text-blue-600 relative z-10",children:[e.jsx("option",{value:"all",children:"All Types"}),D.types.map(a=>e.jsx("option",{value:a,children:a?U(a):"Unknown"},a))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Status"}),e.jsxs("select",{value:C.statusFilter,onChange:a=>v(r=>({...r,statusFilter:a.target.value})),className:"w-full px-3 py-2 border border-grey-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-white text-blue-600 relative z-10",children:[e.jsx("option",{value:"all",children:"All Status"}),D.statuses.map(a=>e.jsx("option",{value:a,children:a?a.charAt(0).toUpperCase()+a.slice(1):"Unknown"},a))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Sort By"}),e.jsxs("select",{value:C.sortBy,onChange:a=>v(r=>({...r,sortBy:a.target.value})),className:"w-full px-3 py-2 border border-grey-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-white text-blue-600 relative z-10",children:[e.jsx("option",{value:"date",children:"Date"}),e.jsx("option",{value:"name",children:"Name"}),e.jsx("option",{value:"type",children:"Type"}),e.jsx("option",{value:"status",children:"Status"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Sort Order"}),e.jsxs("select",{value:C.sortOrder,onChange:a=>v(r=>({...r,sortOrder:a.target.value})),className:"w-full px-3 py-2 border border-grey-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-white text-blue-600 relative z-10",children:[e.jsx("option",{value:"desc",children:"Newest First"}),e.jsx("option",{value:"asc",children:"Oldest First"})]})]})]})]}),e.jsx("div",{className:"space-y-4",children:f.length===0?e.jsxs("div",{className:"py-12 bg-white rounded-lg border border-gray-200 shadow-sm",children:[e.jsx(wt,{className:"h-12 w-12 text-gray-400 mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No history found"}),e.jsx("p",{className:"text-gray-500",children:"Try adjusting your filters or create some analysis first."})]}):f.map(a=>e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden shadow-sm",children:[e.jsx("div",{className:"p-4 cursor-pointer hover:bg-gray-50 transition-colors border-b border-gray-200",onClick:()=>w(a.groupKey),children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[_(a.groupType),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:a.groupTitle}),e.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-600",children:[e.jsxs("span",{children:[a.items.length," items"]}),e.jsxs("span",{children:[a.totalItems," total"]})]})]})]}),e.jsx("div",{className:"flex items-center gap-2",children:P.has(a.groupKey)?e.jsx(ut,{className:"h-5 w-5 text-gray-500"}):e.jsx(gt,{className:"h-5 w-5 text-gray-500"})})]})}),P.has(a.groupKey)&&e.jsx("div",{className:"p-4 space-y-3",children:a.items.map(r=>{try{return e.jsx("div",{className:"border border-gray-200 rounded-lg p-3",children:ee(r)},r.id)}catch(b){return console.error("[History] Error rendering item in group:",b,r),e.jsxs("div",{className:"border border-red-200 rounded-lg p-3 bg-red-50",children:[e.jsxs("div",{className:"text-red-600",children:["Error rendering item: ",b.message]}),e.jsxs("div",{className:"text-xs text-red-500 mt-2",children:["Item ID: ",r.id]})]},r.id)}})})]},a.groupKey))})]})}function us(t){return e.jsxs("div",{className:"max-w-3xl mx-auto p-8",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Content Analysis"}),e.jsx("p",{className:"text-gray-600",children:"This page is currently disabled."})]})}const gs=()=>{const[t]=jt(),o=fe(),[p,n]=l.useState("loading"),[i,x]=l.useState(""),[f,h]=l.useState(!1),[P,E]=l.useState(""),[S,q]=l.useState(""),T=t.get("token");l.useEffect(()=>{T?R(T):(n("error"),x("No verification token provided"))},[T]);const R=async D=>{try{const w=await fetch("/api/auth/verify-email",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:D})}),N=await w.json();w.ok&&N.success?(n("success"),x(N.message),setTimeout(()=>{o("/login")},3e3)):(N.error.includes("expired")?n("expired"):n("error"),x(N.error))}catch(w){console.error("Email verification error:",w),n("error"),x("Failed to verify email. Please try again.")}},C=async()=>{if(!S){E("Please enter your email address");return}h(!0),E("");try{const D=await fetch("/api/auth/resend-verification",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:S})}),w=await D.json();D.ok&&w.success?E("Verification email sent successfully! Please check your inbox."):E(w.error||"Failed to resend verification email")}catch(D){console.error("Resend verification error:",D),E("Failed to resend verification email. Please try again.")}finally{h(!1)}},v=()=>{switch(p){case"loading":return e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-b-2 border-blue-600 mx-auto mb-4"}),e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Verifying your email..."}),e.jsx("p",{className:"text-gray-600",children:"Please wait while we verify your email address."})]});case"success":return e.jsxs("div",{className:"text-center",children:[e.jsx(me,{className:"w-16 h-16 text-green-500 mx-auto mb-4"}),e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Email Verified Successfully!"}),e.jsx("p",{className:"text-gray-600 mb-4",children:i}),e.jsx("p",{className:"text-sm text-gray-500",children:"Redirecting to login page..."})]});case"expired":return e.jsxs("div",{className:"text-center",children:[e.jsx(et,{className:"w-16 h-16 text-red-500 mx-auto mb-4"}),e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Verification Link Expired"}),e.jsx("p",{className:"text-gray-600 mb-6",children:i}),e.jsxs("div",{className:"bg-gray-50 p-6 rounded-lg",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Resend Verification Email"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email Address"}),e.jsx("input",{type:"email",value:S,onChange:D=>q(D.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter your email address"})]}),e.jsx("button",{onClick:C,disabled:f||!S,className:"w-full bg-blue-600 text-white py-2 px-4 rounded-md hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:f?e.jsxs(e.Fragment,{children:[e.jsx(Ce,{className:"w-4 h-4 animate-spin"}),"Sending..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Zt,{className:"w-4 h-4"}),"Resend Verification Email"]})}),P&&e.jsx("p",{className:`text-sm ${P.includes("successfully")?"text-green-600":"text-red-600"}`,children:P})]})]})]});case"error":return e.jsxs("div",{className:"text-center",children:[e.jsx(et,{className:"w-16 h-16 text-red-500 mx-auto mb-4"}),e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Verification Failed"}),e.jsx("p",{className:"text-gray-600 mb-6",children:i}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("button",{onClick:()=>o("/login"),className:"w-full bg-blue-600 text-white py-2 px-4 rounded-md hover:bg-blue-700",children:"Go to Login"}),e.jsx("button",{onClick:()=>o("/signup"),className:"w-full bg-gray-600 text-white py-2 px-4 rounded-md hover:bg-gray-700",children:"Create New Account"})]})]});default:return null}};return e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-100 px-4",children:e.jsx("div",{className:"max-w-md w-full bg-white rounded-lg shadow-md p-8",children:v()})})};class hs extends Vt.Component{constructor(o){super(o),this.state={hasError:!1}}static getDerivedStateFromError(o){return{hasError:!0,message:String(o?.message||"Unexpected error")}}componentDidCatch(o,p){console.error("[ErrorBoundary]",o,p)}handleReset=()=>{try{Object.keys(localStorage).forEach(o=>{o.startsWith("structure_analysis_state")&&localStorage.removeItem(o)})}catch{}this.setState({hasError:!1,message:void 0});try{window.location.reload()}catch{}};render(){return this.state.hasError?e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center p-6",children:e.jsxs("div",{className:"max-w-lg w-full bg-white border border-gray-200 rounded-xl p-6 text-center",children:[e.jsx("h2",{className:"text-xl font-bold text-black mb-2",children:"Something went wrong"}),e.jsx("p",{className:"text-sm text-gray-600 mb-4",children:this.state.message||"The page failed to render."}),e.jsx("button",{className:"bg-black text-white px-4 py-2 rounded-lg hover:bg-gray-800",onClick:this.handleReset,children:"Reset Structure Analysis"})]})}):this.props.children}}function xs(){const t=tt(),o=fe(),{content:p="",url:n=""}=t.state||{},i=()=>{o(-1)};return e.jsx(hs,{fallbackMessage:"Structure analysis failed. Click reset and then Restore Last Analysis to reload your previous results.",children:e.jsx(Mt,{content:p,url:n,onBack:i})})}const ps=({password:t,className:o=""})=>{const p=/[A-Z]/.test(t),n=/[a-z]/.test(t),i=/\d/.test(t),x=/[!@#$%^&*()_+\-=\[\]{};':"\\|,.<>\/?]/.test(t),f=t.length>=8,h=p&&n&&i&&x&&f;return t.length===0?null:e.jsx("div",{className:`text-sm ${h?"text-green-600":"text-red-600"} ${o}`,children:h?"✅ Password meets all requirements":"❌ Password must contain: at least 8 characters, one uppercase letter, one lowercase letter, one number, and one special character"})},bs=()=>{const[t,o]=l.useState({firstName:"",lastName:"",email:"",password:"",confirmPassword:""}),[p,n]=l.useState(""),[i,x]=l.useState(""),[f,h]=l.useState(!1),[P,E]=l.useState(!1),[S,q]=l.useState(!1),[T,R]=l.useState(!1),[C,v]=l.useState(null),[D,w]=l.useState(!0),N=fe(),{login:U,error:J,clearError:ee,isAuthenticated:k}=ze(),{handleInputChangeAggressive:$,handlePaste:Y,handleKeyDown:Z}=st();l.useEffect(()=>{const y=setTimeout(()=>{w(!1)},100);return()=>clearTimeout(y)},[]),l.useEffect(()=>{const y=async()=>{if(k){console.log("[SignUp] User is authenticated via AuthContext, redirecting to overview..."),N("/overview",{replace:!0});return}if(it.isAuthenticated()){console.log("[SignUp] User is authenticated via authService, redirecting to overview..."),N("/overview",{replace:!0});return}};y();const u=setInterval(y,100);return()=>clearInterval(u)},[N,k]);const O=async y=>{if(y.preventDefault(),n(""),x(""),v(null),!t.firstName.trim()){n("First name is required");return}if(!t.lastName.trim()){n("Last name is required");return}if(!t.email.trim()){n("Email is required");return}if(!t.password.trim()){n("Password is required");return}if(!t.confirmPassword.trim()){n("Please confirm your password");return}const u=/^[A-Za-z]+$/;if(!u.test(t.firstName)){if(/[\u{1F600}-\u{1F64F}]|[\u{1F300}-\u{1F5FF}]|[\u{1F680}-\u{1F6FF}]|[\u{1F1E0}-\u{1F1FF}]|[\u{2600}-\u{26FF}]|[\u{2700}-\u{27BF}]/u.test(t.firstName)){n("First name cannot contain emojis");return}if(/[^A-Za-z]/.test(t.firstName)){n("First name can only contain letters (A-Z, a-z). No numbers, spaces, or special characters allowed.");return}n("First name can contain only letters (A-Z, a-z)");return}if(!u.test(t.lastName)){if(/[\u{1F600}-\u{1F64F}]|[\u{1F300}-\u{1F5FF}]|[\u{1F680}-\u{1F6FF}]|[\u{1F1E0}-\u{1F1FF}]|[\u{2600}-\u{26FF}]|[\u{2700}-\u{27BF}]/u.test(t.lastName)){n("Last name cannot contain emojis");return}if(/[^A-Za-z]/.test(t.lastName)){n("Last name can only contain letters (A-Z, a-z). No numbers, spaces, or special characters allowed.");return}n("Last name can contain only letters (A-Z, a-z)");return}if(t.firstName.trim().length<2){n("First name must be at least 2 characters long");return}if(t.firstName.trim().length>30){n("First name cannot exceed 30 characters");return}if(t.lastName.trim().length<2){n("Last name must be at least 2 characters long");return}if(t.lastName.trim().length>30){n("Last name cannot exceed 30 characters");return}const g=ge(t.email);if(!g.isValid){x(he(t.email,g));return}x("");const j=t.password;if(j.length<4){n("Password must be at least 4 characters long");return}if(j.length>128){n("Password cannot exceed 128 characters");return}if(!/[A-Z]/.test(j)){n("Password must contain at least one uppercase letter (A-Z)");return}if(!/[a-z]/.test(j)){n("Password must contain at least one lowercase letter (a-z)");return}if(!/\d/.test(j)){n("Password must contain at least one number (0-9)");return}if(!/[!@#$%^&*()_+\-=\[\]{};':"\\|,.<>\/?]/.test(j)){n("Password must contain at least one special character (!@#$%^&*()_+-=[]{};':\"\\|,.<>/?`)");return}if(/(.)\1{2,}/.test(j)){n("Password cannot contain 3 or more repeated characters");return}if(/abc|bcd|cde|def|efg|fgh|ghi|hij|ijk|jkl|klm|lmn|mno|nop|opq|pqr|qrs|rst|stu|tuv|uvw|vwx|wxy|xyz/i.test(j)){n("Password cannot contain sequential characters (abc, 123, etc.)");return}if(/qwerty|asdfgh|zxcvbn|123456|654321/i.test(j)){n("Password cannot contain common keyboard patterns");return}if(t.password!==t.confirmPassword){n("Passwords do not match");return}h(!0),ee();try{const Q=await it.register({email:t.email,password:t.password,name:`${t.firstName} ${t.lastName}`,displayName:`${t.firstName} ${t.lastName}`});Q.success?(console.log("[SignUp] Sign up successful"),Q.emailVerificationRequired?(v(""),n(""),x(""),v("Account created successfully! Please check your email to verify your account before logging in."),setTimeout(()=>{N("/login",{state:{message:"Account created successfully! Please check your email to verify your account.",email:t.email}})},3e3)):(v(""),n(""),x(""),console.log("[SignUp] Forcing immediate navigation to overview..."),N("/overview",{replace:!0}))):n(Q.error||"Sign up failed. Please try again.")}catch(Q){console.error("[SignUp] Sign up error:",Q);let _="Sign up failed. Please try again.";Q&&typeof Q=="object"&&(Q.message&&typeof Q.message=="string"?Q.message.includes("already exists")||Q.message.includes("duplicate")?_="Account already exists on this email":Q.message.includes("Network")||Q.message.includes("fetch")?_="Network error. Please check your connection and try again.":_=Q.message:Q.error&&typeof Q.error=="string"&&(Q.error.includes("already exists")||Q.error.includes("duplicate")?_="Account already exists on this email":Q.error.includes("Network")||Q.error.includes("connection")?_="Network error. Please check your connection and try again.":_=Q.error)),console.log("[SignUp] Setting authentication error message:",_),v(_),n(""),x("")}finally{h(!1)}};return e.jsxs("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-blue-100 via-indigo-100 to-purple-100 px-4 relative overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-blue-300/30 via-indigo-300/30 to-purple-300/30"}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-tr from-cyan-200/20 via-blue-200/20 to-indigo-200/20"}),e.jsx("div",{className:"absolute top-0 left-0 w-96 h-96 bg-gradient-to-br from-blue-400/40 to-cyan-400/40 rounded-full blur-3xl -translate-x-1/2 -translate-y-1/2 animate-pulse"}),e.jsx("div",{className:"absolute bottom-0 right-0 w-[500px] h-[500px] bg-gradient-to-tl from-purple-400/40 to-pink-400/40 rounded-full blur-3xl translate-x-1/2 translate-y-1/2 animate-pulse",style:{animationDelay:"1s"}}),e.jsx("div",{className:"absolute top-1/2 left-1/2 w-80 h-80 bg-gradient-to-r from-indigo-400/35 to-blue-400/35 rounded-full blur-3xl -translate-x-1/2 -translate-y-1/2 animate-pulse",style:{animationDelay:"2s"}}),e.jsx("div",{className:"absolute top-1/4 right-1/4 w-32 h-32 bg-gradient-to-br from-cyan-300/30 to-blue-300/30 rounded-full blur-2xl animate-bounce",style:{animationDelay:"0.5s"}}),e.jsx("div",{className:"absolute bottom-1/4 left-1/4 w-24 h-24 bg-gradient-to-br from-purple-300/30 to-pink-300/30 rounded-full blur-2xl animate-bounce",style:{animationDelay:"1.5s"}}),e.jsxs("div",{className:"w-full max-w-md mx-auto p-8 bg-white/90 backdrop-blur-md rounded-2xl shadow-2xl border border-white/30 relative z-10 bg-gradient-to-br from-white/95 via-white/90 to-white/95",children:[e.jsxs("div",{className:"text-center mb-10",children:[e.jsx("div",{className:"w-24 h-24 bg-black rounded-2xl flex items-center justify-center mx-auto mb-6 shadow-lg",children:e.jsx(Ae,{className:"w-12 h-12 text-white"})}),e.jsx("h1",{className:"text-4xl font-bold text-black mb-3",children:"Create your account"}),e.jsx("p",{className:"text-gray-600 text-lg",children:"Sign up to get started with kabini.ai"})]}),e.jsxs("form",{onSubmit:O,className:"space-y-8",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-bold text-gray-900 mb-2",children:["First Name ",e.jsx("span",{className:"text-red-600",children:"*"})]}),e.jsx("input",{type:"text",name:"firstName",value:t.firstName,onChange:y=>$(y,u=>{const g=u.replace(/[^A-Za-z]/g,"");if(/[\u{1F600}-\u{1F64F}]|[\u{1F300}-\u{1F5FF}]|[\u{1F680}-\u{1F6FF}]|[\u{1F1E0}-\u{1F1FF}]|[\u{2600}-\u{26FF}]|[\u{2700}-\u{27BF}]/u.test(u)){n("First name cannot contain emojis");return}o(j=>({...j,firstName:g})),p&&n(""),i&&x("")}),onPaste:y=>Y(y,u=>{const g=u.replace(/[^A-Za-z]/g,"");o(j=>({...j,firstName:g}))}),onKeyDown:Z,onCompositionStart:y=>y.preventDefault(),onCompositionUpdate:y=>y.preventDefault(),onCompositionEnd:y=>y.preventDefault(),required:!0,placeholder:"Enter your first name *",pattern:"[A-Za-z]+",autoComplete:"off","data-form-type":"other",readOnly:D,className:"w-full px-4 py-4 border-2 border-gray-300 rounded-xl text-gray-900 placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-black focus:border-black transition-all"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-bold text-gray-900 mb-2",children:["Last Name ",e.jsx("span",{className:"text-red-600",children:"*"})]}),e.jsx("input",{type:"text",name:"lastName",value:t.lastName,onChange:y=>$(y,u=>{const g=u.replace(/[^A-Za-z]/g,"");if(/[\u{1F600}-\u{1F64F}]|[\u{1F300}-\u{1F5FF}]|[\u{1F680}-\u{1F6FF}]|[\u{1F1E0}-\u{1F1FF}]|[\u{2600}-\u{26FF}]|[\u{2700}-\u{27BF}]/u.test(u)){n("Last name cannot contain emojis");return}o(j=>({...j,lastName:g})),p&&n(""),i&&x("")}),onPaste:y=>Y(y,u=>{const g=u.replace(/[^A-Za-z]/g,"");o(j=>({...j,lastName:g}))}),onKeyDown:Z,onCompositionStart:y=>y.preventDefault(),onCompositionUpdate:y=>y.preventDefault(),onCompositionEnd:y=>y.preventDefault(),required:!0,placeholder:"Enter your last name *",pattern:"[A-Za-z]+",autoComplete:"off","data-form-type":"other",readOnly:D,className:"w-full px-4 py-4 border-2 border-gray-300 rounded-xl text-gray-900 placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-black focus:border-black transition-all"})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-bold text-gray-900 mb-2",children:["Email ",e.jsx("span",{className:"text-red-600",children:"*"})]}),e.jsx("input",{type:"email",name:"email",value:t.email,onChange:y=>$(y,u=>{const g=Ee(u);if(o(j=>({...j,email:g})),p&&n(""),i&&x(""),!g.trim())x("");else{const j=ge(g);j.isValid?x(""):x(he(g,j))}}),onPaste:y=>Y(y,u=>{const g=Ee(u);o(Q=>({...Q,email:g}));const j=ge(g);j.isValid?x(""):x(he(g,j))}),onKeyDown:Z,onCompositionStart:y=>y.preventDefault(),onCompositionUpdate:y=>y.preventDefault(),onCompositionEnd:y=>y.preventDefault(),required:!0,autoComplete:"off","data-form-type":"other",readOnly:D,placeholder:"Enter your email address *",className:`w-full px-4 py-4 border-2 rounded-xl text-gray-900 placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-black focus:border-black transition-all ${i?"border-red-500 focus:ring-red-500 focus:border-red-500":"border-gray-300"}`}),i&&e.jsx("div",{className:"mt-2 text-sm text-red-600",children:"Please enter valid email address"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-bold text-gray-900 mb-2",children:["Password ",e.jsx("span",{className:"text-red-600",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:P?"text":"password",name:"password",value:t.password,onChange:y=>$(y,u=>{o(b=>({...b,password:u})),p&&n(""),i&&x("");const g=/[A-Z]/.test(u),j=/[a-z]/.test(u),Q=/\d/.test(u),_=/[!@#$%^&*()_+\-=\[\]{};':"\\|,.<>\/?]/.test(u),a=u.length>=8,r=g&&j&&Q&&_&&a;R(r),r&&n("")}),onPaste:y=>Y(y,u=>{o(b=>({...b,password:u}));const g=/[A-Z]/.test(u),j=/[a-z]/.test(u),Q=/\d/.test(u),_=/[!@#$%^&*()_+\-=\[\]{};':"\\|,.<>\/?]/.test(u),a=u.length>=8,r=g&&j&&Q&&_&&a;R(r),r&&n("")}),onKeyDown:Z,onCompositionStart:y=>y.preventDefault(),onCompositionUpdate:y=>y.preventDefault(),onCompositionEnd:y=>y.preventDefault(),required:!0,autoComplete:"new-password","data-form-type":"other",readOnly:D,placeholder:"Create a password *",className:"w-full px-4 pr-12 py-4 border-2 border-gray-300 rounded-xl text-gray-900 placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-black focus:border-black transition-all"}),e.jsx("button",{type:"button",onClick:()=>E(!P),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600 transition-colors focus:outline-none",tabIndex:-1,"aria-label":P?"Hide password":"Show password",children:P?e.jsx(De,{className:"w-5 h-5"}):e.jsx(Ne,{className:"w-5 h-5"})})]}),e.jsx(ps,{password:t.password,className:"mt-3"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-bold text-gray-900 mb-2",children:["Confirm Password ",e.jsx("span",{className:"text-red-600",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:S?"text":"password",name:"confirmPassword",value:t.confirmPassword,onChange:y=>$(y,u=>{o(g=>({...g,confirmPassword:u})),p&&n("")}),onPaste:y=>Y(y,u=>{o(g=>({...g,confirmPassword:u}))}),onKeyDown:Z,onCompositionStart:y=>y.preventDefault(),onCompositionUpdate:y=>y.preventDefault(),onCompositionEnd:y=>y.preventDefault(),required:!0,autoComplete:"new-password","data-form-type":"other",readOnly:D,placeholder:"Re-enter your password *",className:"w-full px-4 pr-12 py-4 border-2 border-gray-300 rounded-xl text-gray-900 placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-black focus:border-black transition-all"}),e.jsx("button",{type:"button",onClick:()=>q(!S),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600 transition-colors focus:outline-none",tabIndex:-1,"aria-label":S?"Hide confirm password":"Show confirm password",children:S?e.jsx(De,{className:"w-5 h-5"}):e.jsx(Ne,{className:"w-5 h-5"})})]})]}),e.jsx("button",{type:"submit",disabled:f,className:"w-full bg-black text-white font-bold py-4 px-6 rounded-xl hover:bg-gray-800 transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2 shadow-lg transform hover:scale-[1.02]",children:f?e.jsx(le,{className:"w-5 h-5 animate-spin"}):"Create Account"})]}),e.jsx("div",{className:"mt-6 text-center",children:e.jsx("span",{onClick:()=>N("/login"),className:"text-sm text-black hover:text-gray-700 underline hover:no-underline transition-colors cursor-pointer",children:"Already have an account? Sign in"})})]}),e.jsx($e,{error:C||J,onClose:()=>{v(null),ee()},autoClose:!0,autoCloseDelay:5e3})]})},fs=()=>{const[t,o]=l.useState(""),[p,n]=l.useState(!1),[i,x]=l.useState(null),[f,h]=l.useState(null),[P,E]=l.useState(!1),S=fe(),{handleInputChangeAggressive:q,handlePaste:T,handleKeyDown:R}=st(),C=async v=>{if(v.preventDefault(),console.log("[ForgotPassword] Form submitted, clearing previous errors"),x(""),!t||!t.trim()){console.log("[ForgotPassword] Email is empty, setting validation error"),h("Please enter your email address");return}try{const D=ge(t);if(!D||!D.isValid){console.log("[ForgotPassword] Email validation failed, setting validation error"),h(he(t,D));return}}catch(D){console.log("[ForgotPassword] Email validation error:",D),h("Please enter a valid email address");return}console.log("[ForgotPassword] Starting API call to forgot-password endpoint"),E(!0);try{const D=await fetch("/api/auth/forgot-password",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:t.trim()})}),w=await D.json();console.log("[ForgotPassword] Response:",D.status,w),D.ok?(console.log("[ForgotPassword] Password reset email sent successfully"),n(!0)):(console.error("[ForgotPassword] Failed to send reset email:",w.error),x(w.error||"Failed to send reset email. Please try again."))}catch(D){console.error("[ForgotPassword] Error during forgot password request:",D),x("Network error. Please check your connection and try again.")}finally{E(!1)}};return e.jsxs("div",{className:"min-h-screen flex items-center justify-center bg-gray-100 px-4 relative overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 bg-gray-200/30"}),e.jsx("div",{className:"absolute inset-0 bg-gray-300/20"}),e.jsx("div",{className:"absolute top-0 left-0 w-96 h-96 bg-gradient-to-br from-blue-400/40 to-cyan-400/40 rounded-full blur-3xl -translate-x-1/2 -translate-y-1/2 animate-pulse"}),e.jsx("div",{className:"absolute bottom-0 right-0 w-[500px] h-[500px] bg-gradient-to-tl from-purple-400/40 to-pink-400/40 rounded-full blur-3xl translate-x-1/2 translate-y-1/2 animate-pulse",style:{animationDelay:"1s"}}),e.jsx("div",{className:"absolute top-1/2 left-1/2 w-80 h-80 bg-gradient-to-r from-indigo-400/35 to-blue-400/35 rounded-full blur-3xl -translate-x-1/2 -translate-y-1/2 animate-pulse",style:{animationDelay:"2s"}}),e.jsx("div",{className:"absolute top-1/4 right-1/4 w-32 h-32 bg-gradient-to-br from-cyan-300/30 to-blue-300/30 rounded-full blur-2xl animate-bounce",style:{animationDelay:"0.5s"}}),e.jsx("div",{className:"absolute bottom-1/4 left-1/4 w-24 h-24 bg-gradient-to-br from-purple-300/30 to-pink-300/30 rounded-full blur-2xl animate-bounce",style:{animationDelay:"1.5s"}}),e.jsxs("div",{className:"w-full max-w-md mx-auto p-8 bg-white/90 backdrop-blur-md rounded-2xl shadow-2xl border border-white/30 relative z-10 bg-gradient-to-br from-white/95 via-white/90 to-white/95",children:[e.jsxs("div",{className:"text-center mb-10",children:[e.jsx("div",{className:"w-24 h-24 bg-black rounded-2xl flex items-center justify-center mx-auto mb-6 shadow-lg",children:e.jsx(Ae,{className:"w-12 h-12 text-white"})}),e.jsx("h1",{className:"text-4xl font-bold text-black mb-3",children:"Forgot your password?"}),e.jsx("p",{className:"text-gray-600 text-lg",children:"Enter your email address and we'll send you a link to reset your password."})]}),p?e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-6 mb-6",children:[e.jsx("div",{className:"text-green-600 font-semibold mb-2",children:"Check your email"}),e.jsxs("div",{className:"text-gray-600 text-sm",children:["If an account with that email exists, a reset link has been sent to ",e.jsx("strong",{children:t}),"."]})]}),e.jsxs("button",{onClick:()=>S("/login"),className:"w-full bg-black text-white font-bold py-4 px-6 rounded-xl hover:bg-gray-800 transition-all duration-200 flex items-center justify-center gap-2 shadow-lg transform hover:scale-[1.02]",children:[e.jsx(He,{className:"w-5 h-5"}),"Back to Login"]})]}):e.jsxs("form",{onSubmit:C,className:"space-y-8",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-bold text-gray-900 mb-3",children:["Email ",e.jsx("span",{className:"text-red-600",children:"*"})]}),e.jsx("input",{type:"email",value:t,onChange:v=>q(v,D=>{const w=Ee(D);o(w);const N=ge(w);N.isValid?h(null):h(he(w,N))}),onPaste:v=>T(v,D=>{const w=Ee(D);o(w);const N=ge(w);N.isValid?h(null):h(he(w,N))}),onKeyDown:R,onCompositionStart:v=>v.preventDefault(),onCompositionUpdate:v=>v.preventDefault(),onCompositionEnd:v=>v.preventDefault(),required:!0,placeholder:"Enter your email address *",className:`w-full px-4 py-4 border-2 rounded-xl text-gray-900 placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-black focus:border-black transition-all ${f?"border-red-500 focus:ring-red-500 focus:border-red-500":"border-gray-300"}`}),f&&e.jsx("div",{className:"mt-2 text-sm text-red-600",children:"Please enter valid email address"})]}),e.jsx("button",{type:"submit",disabled:P||!!f,className:"w-full bg-black text-white font-bold py-4 px-6 rounded-xl hover:bg-gray-800 transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2 shadow-lg transform hover:scale-[1.02]",children:P?e.jsx(le,{className:"w-5 h-5 animate-spin"}):"Send Reset Link"}),e.jsxs("button",{type:"button",onClick:()=>S("/login"),className:"w-full bg-black text-white font-bold py-4 px-6 rounded-xl hover:bg-gray-800 transition-all duration-200 flex items-center justify-center gap-2 shadow-lg transform hover:scale-[1.02]",children:[e.jsx(He,{className:"w-5 h-5"}),"Back to Login"]})]})]}),e.jsx($e,{error:i,onClose:()=>x(null),autoClose:!0,autoCloseDelay:5e3,type:"error"})]})},ys=()=>{const[t]=jt(),[o,p]=l.useState({password:"",confirmPassword:""}),[n,i]=l.useState(""),[x,f]=l.useState(!1),[h,P]=l.useState(!1),[E,S]=l.useState(!1),[q,T]=l.useState(!0),[R,C]=l.useState(!1),[v,D]=l.useState(!1),[w,N]=l.useState(!1),U=fe(),J=t.get("token");l.useEffect(()=>{if(!J){i("Invalid reset link. Please request a new password reset."),T(!1);return}console.log("[ResetPassword] Token found in URL, showing reset form"),S(!0),T(!1)},[J]);const ee=Y=>{const{name:Z,value:O}=Y.target;if(p({...o,[Z]:O}),Z==="password"){const y=O.length>=8&&/[a-z]/.test(O)&&/[A-Z]/.test(O)&&/\d/.test(O);N(y)}},k=()=>o.password?o.confirmPassword?o.password.length<8?(i("Password must be at least 8 characters long"),!1):/(?=.*[a-z])/.test(o.password)?/(?=.*[A-Z])/.test(o.password)?/(?=.*\d)/.test(o.password)?o.password!==o.confirmPassword?(i("Passwords do not match"),!1):!0:(i("Password must contain at least one number"),!1):(i("Password must contain at least one uppercase letter"),!1):(i("Password must contain at least one lowercase letter"),!1):(i("Please confirm your password"),!1):(i("Password is required"),!1),$=async Y=>{if(Y.preventDefault(),i(""),!!k()){if(!J){i("Invalid reset token. Please request a new password reset.");return}f(!0);try{console.log("[ResetPassword] Attempting to reset password with token:",J);const Z=await fetch("/api/auth/reset-password",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:J,newPassword:o.password})}),O=await Z.json();console.log("[ResetPassword] Response:",Z.status,O),Z.ok?(console.log("[ResetPassword] Password reset successful"),P(!0)):(console.error("[ResetPassword] Password reset failed:",O.error),i(O.error||"Failed to reset password. Please try again."))}catch(Z){console.error("[ResetPassword] Error during password reset:",Z),i("Network error. Please check your connection and try again.")}finally{f(!1)}}};return q?e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-100",children:e.jsx("div",{className:"w-full max-w-md mx-auto p-8 bg-white rounded-lg shadow-sm",children:e.jsxs("div",{className:"text-center",children:[e.jsx(le,{className:"w-8 h-8 animate-spin mx-auto mb-4 text-blue-600"}),e.jsx("div",{className:"text-gray-600",children:"Verifying reset link..."})]})})}):E?h?e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-100",children:e.jsx("div",{className:"w-full max-w-md mx-auto p-8 bg-white rounded-lg shadow-sm",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-green-100 rounded-lg flex items-center justify-center mx-auto mb-4",children:e.jsx(me,{className:"w-8 h-8 text-green-600"})}),e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Password Reset Successfully"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"Your password has been updated. You can now log in with your new password."}),e.jsxs("button",{onClick:()=>U("/login"),className:"w-full bg-blue-600 text-white font-bold py-3 px-6 rounded-lg hover:bg-blue-700 transition-all flex items-center justify-center gap-2",children:[e.jsx(He,{className:"w-5 h-5"}),"Back to Login"]})]})})}):e.jsxs("div",{className:"min-h-screen flex items-center justify-center bg-gray-100",children:[e.jsxs("div",{className:"w-full max-w-md mx-auto p-8 bg-white rounded-lg shadow-sm",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("div",{className:"w-16 h-16 bg-blue-100 rounded-lg flex items-center justify-center mx-auto mb-4",children:e.jsx(Ae,{className:"w-8 h-8 text-blue-600"})}),e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Reset Your Password"}),e.jsx("p",{className:"text-gray-600",children:"Enter your new password below"})]}),e.jsxs("form",{onSubmit:$,className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-bold text-gray-900 mb-2",children:["New Password ",e.jsx("span",{className:"text-red-600",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:R?"text":"password",name:"password",value:o.password,onChange:ee,required:!0,placeholder:"Enter your new password",className:"w-full px-4 pr-12 py-3 border border-gray-300 rounded-lg text-gray-900 placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all"}),e.jsx("button",{type:"button",onClick:()=>C(!R),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600",tabIndex:-1,"aria-label":R?"Hide password":"Show password",children:R?e.jsx(De,{className:"w-5 h-5"}):e.jsx(Ne,{className:"w-5 h-5"})})]}),e.jsx("div",{className:`mt-2 text-xs ${w?"text-green-600":"text-gray-500"}`,children:w?"Password meets requirements":"Must be at least 8 characters with uppercase, lowercase, and number"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-bold text-gray-900 mb-2",children:["Confirm New Password ",e.jsx("span",{className:"text-red-600",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:v?"text":"password",name:"confirmPassword",value:o.confirmPassword,onChange:ee,required:!0,placeholder:"Re-enter your new password",className:"w-full px-4 pr-12 py-3 border border-gray-300 rounded-lg text-gray-900 placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all"}),e.jsx("button",{type:"button",onClick:()=>D(!v),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600",tabIndex:-1,"aria-label":v?"Hide confirm password":"Show confirm password",children:v?e.jsx(De,{className:"w-5 h-5"}):e.jsx(Ne,{className:"w-5 h-5"})})]})]}),e.jsx("button",{type:"submit",disabled:x,className:"w-full bg-blue-600 text-white font-bold py-3 px-6 rounded-lg hover:bg-blue-700 transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:x?e.jsx(le,{className:"w-5 h-5 animate-spin"}):"Reset Password"})]}),e.jsx("div",{className:"mt-6 text-center",children:e.jsxs("button",{type:"button",onClick:()=>U("/login"),className:"w-full bg-blue-500 border-2 border-blue-600 text-white hover:bg-blue-600 hover:text-white font-bold py-3 px-6 rounded-lg transition-all duration-200 flex items-center justify-center gap-2 shadow-lg",children:[e.jsx(He,{className:"w-5 h-5"}),"Back to Login"]})})]}),e.jsx($e,{error:n,onClose:()=>i(""),autoClose:!0,autoCloseDelay:5e3})]}):e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-100",children:e.jsx("div",{className:"w-full max-w-md mx-auto p-8 bg-white rounded-lg shadow-sm",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-red-100 rounded-lg flex items-center justify-center mx-auto mb-4",children:e.jsx(Ae,{className:"w-8 h-8 text-red-600"})}),e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Invalid Reset Link"}),e.jsx("p",{className:"text-gray-600 mb-6",children:n}),e.jsx("button",{onClick:()=>U("/forgot-password"),className:"w-full bg-blue-600 text-white font-bold py-3 px-6 rounded-lg hover:bg-blue-700 transition-all",children:"Request New Reset Link"})]})})})};function vs(t){const[o,p]=l.useState("integrations");return e.jsxs("div",{className:"p-6 max-w-6xl mx-auto",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-black mb-2",children:"Settings"}),e.jsx("p",{className:"text-gray-600",children:"Manage your integrations, usage, and account preferences"})]}),e.jsx("div",{className:"border-b border-gray-200 mb-8",children:e.jsx("nav",{className:"flex space-x-8",children:[{id:"integrations",label:"Integrations",icon:Nt},{id:"usage",label:"Plan Usage & Limits",icon:Ve},{id:"account",label:"Account Settings",icon:St}].map(n=>e.jsxs("button",{onClick:()=>p(n.id),className:`flex items-center gap-2 py-4 px-1 border-b-2 font-medium text-sm transition-colors ${o===n.id?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[e.jsx(n.icon,{className:"w-5 h-5"}),n.label]},n.id))})}),o==="integrations"&&e.jsx(js,{}),o==="usage"&&e.jsx(ws,{}),o==="account"&&e.jsx(Ns,{})]})}function js(){const[t,o]=l.useState({cms:{wordpress:!1,webflow:!1},analytics:{ga4:!1,searchConsole:!1},ecommerce:{shopify:!1,bigcommerce:!1,woocommerce:!1,magento:!1}}),p=[{category:"CMS Platforms",description:"Connect with your content management systems",integrations:[{id:"wordpress",name:"WordPress",icon:Le,status:t.cms.wordpress},{id:"webflow",name:"Webflow",icon:kt,status:t.cms.webflow}]},{category:"Analytics & Monitoring",description:"Track performance and user behavior",integrations:[{id:"ga4",name:"Google Analytics 4",icon:Ve,status:t.analytics.ga4},{id:"searchConsole",name:"Google Search Console",icon:Yt,status:t.analytics.searchConsole}]},{category:"E-commerce Platforms",description:"Integrate with your online stores",integrations:[{id:"shopify",name:"Shopify",icon:je,status:t.ecommerce.shopify},{id:"bigcommerce",name:"BigCommerce",icon:je,status:t.ecommerce.bigcommerce},{id:"woocommerce",name:"WooCommerce",icon:je,status:t.ecommerce.woocommerce},{id:"magento",name:"Magento",icon:je,status:t.ecommerce.magento}]}],n=(i,x)=>{o(f=>{const h=i,P=x;return{...f,[h]:{...f[h],[P]:!f[h][P]}}})};return e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-black mb-2",children:"Integrations"}),e.jsx("p",{className:"text-gray-600",children:"Connect with CMS platforms, analytics tools, and e-commerce systems to enhance your content optimization workflow."})]}),p.map((i,x)=>e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-black mb-1",children:i.category}),e.jsx("p",{className:"text-gray-600",children:i.description})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:i.integrations.map(f=>e.jsxs("div",{className:`border rounded-lg p-4 cursor-pointer transition-all ${f.status?"border-green-200 bg-green-50":"border-gray-200 bg-white hover:border-gray-300"}`,onClick:()=>n(i.category==="CMS Platforms"?"cms":i.category==="Analytics & Monitoring"?"analytics":"ecommerce",f.id),children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx(f.icon,{className:`w-6 h-6 ${f.status?"text-green-600":"text-gray-400"}`}),f.status?e.jsx(me,{className:"w-5 h-5 text-green-600"}):e.jsx(et,{className:"w-5 h-5 text-gray-400"})]}),e.jsx("h4",{className:"font-medium text-black mb-1",children:f.name}),e.jsx("p",{className:"text-sm text-gray-600",children:f.status?"Connected":"Not connected"})]},f.id))})]},x)),e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(Xt,{className:"w-5 h-5 text-black"}),e.jsx("h3",{className:"text-lg font-bold text-black",children:"Store Integration (Read-only)"})]}),e.jsx(Ss,{})]})]})}function ws(){const[t]=l.useState({analyses:{used:45,limit:100,type:"Content Analyses"},generations:{used:23,limit:50,type:"AI Generations"},monitoring:{used:12,limit:25,type:"Monitoring Jobs"}}),o=(n,i)=>Math.round(n/i*100),p=n=>n>=90?"text-red-600 bg-red-50":n>=75?"text-yellow-600 bg-yellow-50":"text-green-600 bg-green-50";return e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-black mb-2",children:"Plan Usage & Limits"}),e.jsx("p",{className:"text-gray-600",children:"Track your current usage against your plan limits and monitor quota consumption."})]}),e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:Object.entries(t).map(([n,i])=>{const x=o(i.used,i.limit),f=p(x);return e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"font-semibold text-black",children:i.type}),e.jsxs("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${f}`,children:[x,"% used"]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("div",{className:"flex justify-between text-sm text-gray-600 mb-2",children:[e.jsxs("span",{children:[i.used," used"]}),e.jsxs("span",{children:[i.limit," limit"]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:`h-2 rounded-full transition-all ${x>=90?"bg-red-500":x>=75?"bg-yellow-500":"bg-green-500"}`,style:{width:`${Math.min(x,100)}%`}})})]}),e.jsxs("div",{className:"text-sm text-gray-600",children:[i.limit-i.used," remaining"]})]},n)})}),e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-6",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(we,{className:"w-5 h-5 text-blue-600 mt-0.5"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-blue-900 mb-1",children:"Usage Tips"}),e.jsx("p",{className:"text-blue-800 text-sm",children:"Monitor your usage regularly to avoid hitting limits. Consider upgrading your plan if you're consistently approaching your limits."})]})]})})]})}function Ns(){const[t,o]=l.useState({workspace:"My Workspace",timezone:"UTC-8 (Pacific Time)",notifications:{email:!0,push:!1,weekly:!0}}),[p]=l.useState([{name:"John Doe",email:"john@example.com",role:"Admin",status:"Active"},{name:"Jane Smith",email:"jane@example.com",role:"Editor",status:"Active"},{name:"Mike Johnson",email:"mike@example.com",role:"Viewer",status:"Pending"}]);return e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-black mb-2",children:"Account Settings"}),e.jsx("p",{className:"text-gray-600",children:"Manage users, roles, billing, and workspace preferences."})]}),e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-black mb-4",children:"Workspace Settings"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Workspace Name"}),e.jsx("input",{type:"text",value:t.workspace,onChange:n=>o(i=>({...i,workspace:n.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Timezone"}),e.jsxs("select",{value:t.timezone,onChange:n=>o(i=>({...i,timezone:n.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[e.jsx("option",{value:"UTC-8 (Pacific Time)",children:"UTC-8 (Pacific Time)"}),e.jsx("option",{value:"UTC-5 (Eastern Time)",children:"UTC-5 (Eastern Time)"}),e.jsx("option",{value:"UTC+0 (GMT)",children:"UTC+0 (GMT)"}),e.jsx("option",{value:"UTC+1 (CET)",children:"UTC+1 (CET)"})]})]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-black",children:"User Management"}),e.jsxs("button",{className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors flex items-center gap-2",children:[e.jsx(Ct,{className:"w-4 h-4"}),"Invite User"]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-gray-200",children:[e.jsx("th",{className:"text-left py-3 px-4 font-medium text-gray-700",children:"Name"}),e.jsx("th",{className:"text-left py-3 px-4 font-medium text-gray-700",children:"Email"}),e.jsx("th",{className:"text-left py-3 px-4 font-medium text-gray-700",children:"Role"}),e.jsx("th",{className:"text-left py-3 px-4 font-medium text-gray-700",children:"Status"}),e.jsx("th",{className:"text-left py-3 px-4 font-medium text-gray-700",children:"Actions"})]})}),e.jsx("tbody",{children:p.map((n,i)=>e.jsxs("tr",{className:"border-b border-gray-100",children:[e.jsx("td",{className:"py-3 px-4 text-black",children:n.name}),e.jsx("td",{className:"py-3 px-4 text-gray-600",children:n.email}),e.jsx("td",{className:"py-3 px-4",children:e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${n.role==="Admin"?"bg-purple-100 text-purple-800":n.role==="Editor"?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-800"}`,children:n.role})}),e.jsx("td",{className:"py-3 px-4",children:e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${n.status==="Active"?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800"}`,children:n.status})}),e.jsx("td",{className:"py-3 px-4",children:e.jsx("button",{className:"text-blue-600 hover:text-blue-800 text-sm",children:"Edit"})})]},i))})]})})]}),e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-black mb-4",children:"Notification Preferences"}),e.jsx("div",{className:"space-y-4",children:Object.entries(t.notifications).map(([n,i])=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h4",{className:"font-medium text-black capitalize",children:[n," Notifications"]}),e.jsxs("p",{className:"text-sm text-gray-600",children:[n==="email"&&"Receive notifications via email",n==="push"&&"Receive push notifications in browser",n==="weekly"&&"Receive weekly summary reports"]})]}),e.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:i,onChange:x=>o(f=>({...f,notifications:{...f.notifications,[n]:x.target.checked}})),className:"sr-only peer"}),e.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]})]},n))})]}),e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-black mb-4",children:"Billing & Subscription"}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-black",children:"Pro Plan"}),e.jsx("p",{className:"text-sm text-gray-600",children:"$29/month • Next billing: Jan 15, 2024"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:"Update Payment"}),e.jsx("button",{className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Manage Subscription"})]})]})]})]})}function Ss(){const[t,o]=l.useState(""),[p,n]=l.useState({shop:"",accessToken:""}),[i,x]=l.useState({baseUrl:"",consumerKey:"",consumerSecret:""}),[f,h]=l.useState({baseUrl:"",token:""}),[P,E]=l.useState(null),[S,q]=l.useState(!1),T=t==="shopify"?p:t==="woocommerce"?i:t==="magento"?f:null,R=async()=>{if(!(!t||!T)){q(!0),E(null);try{const v=await ne.storeTest({platform:t,credentials:T});E(v?.success?`Connected ✓ (sample: ${v?.result?.sample??0})`:`Failed ✗ ${v?.result?.error||""}`)}catch(v){E(`Failed ✗ ${v.message}`)}finally{q(!1)}}},C=async()=>{if(!(!t||!T)){q(!0),E(null);try{const v=await ne.storeConnect({platform:t,credentials:T});E(v?.success?"Saved ✓":`Failed ✗ ${v?.error||""}`)}catch(v){E(`Failed ✗ ${v.message}`)}finally{q(!1)}}};return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold text-black mb-2",children:"Platform"}),e.jsxs("select",{value:t,onChange:v=>o(v.target.value),className:"w-full bg-white border border-black/20 rounded-lg px-3 py-2 text-black",children:[e.jsx("option",{value:"",children:"Select platform"}),e.jsx("option",{value:"shopify",children:"Shopify"}),e.jsx("option",{value:"woocommerce",children:"WooCommerce"}),e.jsx("option",{value:"magento",children:"Magento"})]})]}),t==="shopify"&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold text-black mb-2",children:"Shop Domain (myshop.myshopify.com or https://...)"}),e.jsx("input",{value:p.shop,onChange:v=>n({...p,shop:v.target.value}),className:"w-full bg-white border border-black/20 rounded-lg px-3 py-2 text-black"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold text-black mb-2",children:"Admin API Access Token"}),e.jsx("input",{value:p.accessToken,onChange:v=>n({...p,accessToken:v.target.value}),className:"w-full bg-white border border-black/20 rounded-lg px-3 py-2 text-black"})]})]}),t==="woocommerce"&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold text-black mb-2",children:"Site URL (https://example.com)"}),e.jsx("input",{value:i.baseUrl,onChange:v=>x({...i,baseUrl:v.target.value}),className:"w-full bg-white border border-black/20 rounded-lg px-3 py-2 text-black"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold text-black mb-2",children:"Consumer Key"}),e.jsx("input",{value:i.consumerKey,onChange:v=>x({...i,consumerKey:v.target.value}),className:"w-full bg-white border border-black/20 rounded-lg px-3 py-2 text-black"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold text-black mb-2",children:"Consumer Secret"}),e.jsx("input",{value:i.consumerSecret,onChange:v=>x({...i,consumerSecret:v.target.value}),className:"w-full bg-white border border-black/20 rounded-lg px-3 py-2 text-black"})]})]}),t==="magento"&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold text-black mb-2",children:"Base URL (https://example.com)"}),e.jsx("input",{value:f.baseUrl,onChange:v=>h({...f,baseUrl:v.target.value}),className:"w-full bg-white border border-black/20 rounded-lg px-3 py-2 text-black"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold text-black mb-2",children:"Integration Token (Bearer)"}),e.jsx("input",{value:f.token,onChange:v=>h({...f,token:v.target.value}),className:"w-full bg-white border border-black/20 rounded-lg px-3 py-2 text-black"})]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:R,disabled:!t||!T||S,className:"px-4 py-2 rounded-lg bg-blue-600 text-white disabled:opacity-50",children:S?"Testing...":"Test Connection"}),e.jsx("button",{onClick:C,disabled:!t||!T||S,className:"px-4 py-2 rounded-lg bg-gray-800 text-white disabled:opacity-50",children:"Save"})]}),P&&e.jsx("div",{className:"text-sm text-black mt-2",children:P})]})}function ks({storeId:t}){const[o,p]=l.useState(null),[n,i]=l.useState(!1),[x,f]=l.useState(null),[h,P]=l.useState("24h"),[E,S]=l.useState(!0),[q,T]=l.useState(null),R=async()=>{if(!t){f("No store connected. Please connect a store in Settings.");return}i(!0),f(null);try{const N=await ne.getShopperBehaviorData(t,h);p(N.data),T(new Date)}catch(N){f(N.message||"Failed to fetch shopper behavior data")}finally{i(!1)}};l.useEffect(()=>{if(E){const N=setInterval(R,3e4);return()=>clearInterval(N)}},[E,t,h]),l.useEffect(()=>{R()},[t,h]);const C=N=>`${N.toFixed(1)}%`,v=N=>N.toLocaleString(),D=N=>N>70?"text-red-600 bg-red-50":N>50?"text-yellow-600 bg-yellow-50":"text-green-600 bg-green-50",w=N=>N>3?"text-green-600 bg-green-50":N>1?"text-yellow-600 bg-yellow-50":"text-red-600 bg-red-50";return x?e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6 text-center",children:[e.jsx(we,{className:"w-12 h-12 text-red-600 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-red-900 mb-2",children:"Connection Error"}),e.jsx("p",{className:"text-red-700 mb-4",children:x}),e.jsx("button",{onClick:()=>window.location.href="/configuration",className:"bg-red-600 text-white px-4 py-2 rounded-lg hover:bg-red-700 transition-colors",children:"Go to Settings"})]})}):e.jsxs("div",{className:"p-6 max-w-7xl mx-auto",children:[e.jsxs("div",{className:"mb-8",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-black mb-2",children:"E-commerce AI Visibility"}),e.jsx("p",{className:"text-gray-600",children:"Real-time shopper behavior insights and conversion optimization"})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ce,{className:`w-5 h-5 ${n?"animate-spin":""} ${E?"text-green-600":"text-gray-400"}`}),e.jsx("span",{className:"text-sm text-gray-600",children:E?"Auto-refresh ON":"Auto-refresh OFF"})]}),e.jsx("button",{onClick:()=>S(!E),className:`px-3 py-1 rounded-lg text-sm font-medium transition-colors ${E?"bg-green-100 text-green-700 hover:bg-green-200":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:E?"Pause":"Resume"}),e.jsxs("button",{onClick:R,disabled:n,className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors flex items-center gap-2 disabled:opacity-50",children:[e.jsx(Ce,{className:`w-4 h-4 ${n?"animate-spin":""}`}),"Refresh"]})]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Time Range:"}),e.jsx("div",{className:"flex gap-2",children:[{value:"1h",label:"1 Hour"},{value:"24h",label:"24 Hours"},{value:"7d",label:"7 Days"},{value:"30d",label:"30 Days"}].map(N=>e.jsx("button",{onClick:()=>P(N.value),className:`px-3 py-1 rounded-lg text-sm font-medium transition-colors ${h===N.value?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:N.label},N.value))}),q&&e.jsxs("span",{className:"text-sm text-gray-500",children:["Last updated: ",q.toLocaleTimeString()]})]})]}),n&&!o?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsxs("div",{className:"text-center",children:[e.jsx(Ce,{className:"w-8 h-8 text-blue-600 animate-spin mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Loading shopper behavior data..."})]})}):o?e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"font-semibold text-gray-700",children:"Active Users"}),e.jsx(St,{className:"w-5 h-5 text-blue-600"})]}),e.jsx("div",{className:"text-3xl font-bold text-black mb-2",children:v(o.realTimeMetrics.activeUsers)}),e.jsx("p",{className:"text-sm text-green-600",children:"Live now"})]}),e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"font-semibold text-gray-700",children:"Current Carts"}),e.jsx(je,{className:"w-5 h-5 text-orange-600"})]}),e.jsx("div",{className:"text-3xl font-bold text-black mb-2",children:v(o.realTimeMetrics.currentCarts)}),e.jsx("p",{className:"text-sm text-orange-600",children:"In progress"})]}),e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"font-semibold text-gray-700",children:"Live Conversions"}),e.jsx(ht,{className:"w-5 h-5 text-green-600"})]}),e.jsx("div",{className:"text-3xl font-bold text-black mb-2",children:v(o.realTimeMetrics.liveConversions)}),e.jsx("p",{className:"text-sm text-green-600",children:"This hour"})]}),e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"font-semibold text-gray-700",children:"Avg. Session"}),e.jsx(es,{className:"w-5 h-5 text-purple-600"})]}),e.jsxs("div",{className:"text-3xl font-bold text-black mb-2",children:[Math.round(o.realTimeMetrics.averageSessionTime),"m"]}),e.jsx("p",{className:"text-sm text-purple-600",children:"Time on site"})]})]}),e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-xl font-bold text-black",children:"Cart Abandonment Analysis"}),e.jsxs("div",{className:`px-3 py-1 rounded-full text-sm font-medium ${D(o.cartAbandonment.rate)}`,children:[C(o.cartAbandonment.rate)," Abandonment Rate"]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-700 mb-4",children:"Abandonment Metrics"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Total Carts Created"}),e.jsx("span",{className:"font-semibold",children:v(o.cartAbandonment.totalCarts)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Abandoned Carts"}),e.jsx("span",{className:"font-semibold text-red-600",children:v(o.cartAbandonment.totalAbandoned)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Avg. Time to Abandon"}),e.jsxs("span",{className:"font-semibold",children:[Math.round(o.cartAbandonment.timeToAbandonment),"m"]})]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-700 mb-4",children:"Common Reasons"}),e.jsx("div",{className:"space-y-2",children:o.cartAbandonment.commonReasons.map((N,U)=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 bg-red-500 rounded-full"}),e.jsx("span",{className:"text-sm text-gray-700",children:N})]},U))})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-700 mb-4",children:"AI Recommendations"}),e.jsx("div",{className:"space-y-2",children:o.cartAbandonment.recoverySuggestions.map((N,U)=>e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(me,{className:"w-4 h-4 text-green-600 mt-0.5 flex-shrink-0"}),e.jsx("span",{className:"text-sm text-gray-700",children:N})]},U))})]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[e.jsx("h2",{className:"text-xl font-bold text-black mb-6",children:"Search Query Intent Analysis"}),e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:Object.entries(o.queryIntent).map(([N,U])=>e.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h3",{className:"font-semibold text-black capitalize",children:[N," Intent"]}),e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:C(U.percentage)})]}),e.jsxs("div",{className:"text-sm text-gray-600 mb-3",children:[v(U.count)," queries"]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"text-xs font-medium text-gray-700 mb-2",children:"Top Queries:"}),U.queries.slice(0,3).map((J,ee)=>e.jsxs("div",{className:"text-xs text-gray-600 bg-gray-50 px-2 py-1 rounded",children:['"',J,'"']},ee))]})]},N))})]}),e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[e.jsx("h2",{className:"text-xl font-bold text-black mb-6",children:"Engagement Funnel"}),e.jsx("div",{className:"space-y-4",children:Object.entries(o.engagementFunnel).map(([N,U],J)=>e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-8 h-8 bg-blue-600 text-white rounded-full flex items-center justify-center text-sm font-bold",children:J+1}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h3",{className:"font-semibold text-black capitalize",children:N.replace(/([A-Z])/g," $1").trim()}),e.jsxs("div",{className:`px-2 py-1 rounded text-sm font-medium ${w(U.conversionRate)}`,children:[C(U.conversionRate)," conversion"]})]}),e.jsxs("div",{className:"text-sm text-gray-600 mb-2",children:[v(U.visitors)," visitors"]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-500",style:{width:`${Math.min(U.visitors/o.engagementFunnel.landing.visitors*100,100)}%`}})})]})]},N))})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[e.jsx("h2",{className:"text-xl font-bold text-black mb-4",children:"AI Recommendations"}),e.jsx("div",{className:"space-y-3",children:o.aiInsights.topRecommendations.map((N,U)=>e.jsxs("div",{className:"flex items-start gap-3 p-3 bg-blue-50 rounded-lg",children:[e.jsx(be,{className:"w-5 h-5 text-blue-600 mt-0.5 flex-shrink-0"}),e.jsx("span",{className:"text-sm text-gray-700",children:N})]},U))})]}),e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[e.jsx("h2",{className:"text-xl font-bold text-black mb-4",children:"Urgent Actions"}),e.jsx("div",{className:"space-y-3",children:o.aiInsights.urgentActions.map((N,U)=>e.jsxs("div",{className:"flex items-start gap-3 p-3 bg-red-50 rounded-lg",children:[e.jsx(we,{className:"w-5 h-5 text-red-600 mt-0.5 flex-shrink-0"}),e.jsx("span",{className:"text-sm text-gray-700",children:N})]},U))})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[e.jsx("h2",{className:"text-xl font-bold text-black mb-4",children:"Growth Opportunities"}),e.jsx("div",{className:"space-y-3",children:o.aiInsights.opportunities.map((N,U)=>e.jsxs("div",{className:"flex items-start gap-3 p-3 bg-green-50 rounded-lg",children:[e.jsx(ht,{className:"w-5 h-5 text-green-600 mt-0.5 flex-shrink-0"}),e.jsx("span",{className:"text-sm text-gray-700",children:N})]},U))})]}),e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[e.jsx("h2",{className:"text-xl font-bold text-black mb-4",children:"Risk Factors"}),e.jsx("div",{className:"space-y-3",children:o.aiInsights.riskFactors.map((N,U)=>e.jsxs("div",{className:"flex items-start gap-3 p-3 bg-yellow-50 rounded-lg",children:[e.jsx(we,{className:"w-5 h-5 text-yellow-600 mt-0.5 flex-shrink-0"}),e.jsx("span",{className:"text-sm text-gray-700",children:N})]},U))})]})]})]}):null]})}function Cs(t,o){const n=new DOMParser().parseFromString(t,"text/html"),i=(n.querySelector("title")?.textContent||"").trim()||n.querySelector('meta[property="og:title"]')?.content||void 0,x=n.querySelector('meta[name="description"]')?.content||n.querySelector('meta[property="og:description"]')?.content||void 0,f=Array.from(n.querySelectorAll("h1")).map(k=>k.textContent?.trim()||"").filter(Boolean),h=Array.from(n.querySelectorAll("h2")).map(k=>k.textContent?.trim()||"").filter(Boolean),P=Array.from(n.querySelectorAll("h3")).map(k=>k.textContent?.trim()||"").filter(Boolean),E=(n.body?.textContent||"").replace(/\s+/g," ").trim(),S=[],q=(()=>{try{return o?new URL(o).host:""}catch{return""}})();Array.from(n.querySelectorAll("a[href]")).forEach(k=>{const $=(k.getAttribute("href")||"").trim();if($)try{const Y=o?new URL($,o):new URL($,window.location.origin);(q?Y.host===q:$.startsWith("/")||$.startsWith("#"))&&S.push({text:(k.textContent||"").trim(),href:Y.href})}catch{}});const T=Array.from(n.querySelectorAll('script[type="application/ld+json"]'));let R=!1,C=!1,v=!1,D=!1;T.forEach(k=>{try{const $=JSON.parse(k.textContent||"null");(Array.isArray($)?$:[$]).forEach(Z=>{const O=y=>{if(!y||typeof y!="object")return;const u=y["@type"],g=Array.isArray(u)?u:[u];g.includes("Product")&&(R=!0),g.includes("FAQPage")&&(C=!0),g.includes("BreadcrumbList")&&(v=!0),(g.includes("Review")||y.aggregateRating)&&(D=!0),Object.values(y).forEach(O)};O(Z)})}catch{}});const w=Array.from(n.querySelectorAll("img")),U={withAlt:w.filter(k=>(k.getAttribute("alt")||"").trim().length>0).length,total:w.length},ee=/(reviews?|ratings?|testimonials?|\b"?stars?"?\b)/i.test(E);return{url:o,html:t,title:i,metaDescription:x,h1:f,h2:h,h3:P,bodyText:E,productSchemaFound:R,faqSchemaFound:C,breadcrumbSchemaFound:v,reviewsSchemaFound:D,imageAltCoverage:U,internalLinks:S,reviewsOrTestimonialsMentioned:ee}}function As(t){const o=[],p=t.bodyText.split(/\s+/).filter(Boolean).length,n=/\bfaq(s)?\b|frequently asked questions/i.test(t.bodyText)||t.faqSchemaFound,x=/(size|dimensions?|material|care|price|stock|sku|model)/i.test(t.bodyText),f=/(benefit|use case|why|features?|specifications?|ideal for|best for)/i.test(t.bodyText),h=t.reviewsSchemaFound||t.reviewsOrTestimonialsMentioned,P=t.imageAltCoverage.total===0?!0:t.imageAltCoverage.withAlt/t.imageAltCoverage.total>=.7,E={name:"Product Page Quality",score:0,checks:[{id:"specs",label:"Product specs present",passed:x,weight:3},{id:"rich",label:"Rich description (benefits/use cases)",passed:f,weight:3},{id:"faqs",label:"FAQs included",passed:n,weight:2},{id:"reviews",label:"Customer reviews present",passed:h,weight:3},{id:"alt",label:"Image alt tags coverage",passed:P,weight:2}]},S=/(buying guide|how to choose|what to look for)/i.test(t.bodyText),q=/(compare|vs\.?|comparison)/i.test(t.bodyText)||Array.from(t.html.matchAll(/<table[\s\S]*?<\/table>/gi)).length>0,T=/(summer|winter|spring|fall|seasonal|202[3-9]|202\d)/i.test(t.bodyText),R=t.internalLinks.length,C={name:"Category & Guides",score:0,checks:[{id:"guide",label:"Buying guides present",passed:S,weight:2},{id:"comparison",label:"Comparison charts/tables",passed:q,weight:2},{id:"seasonal",label:"Trend/seasonal keywords",passed:T,weight:1},{id:"links",label:"Adequate internal links (>=10)",passed:R>=10,weight:2}]},v=p>=500,D=/(features?|benefits?|pros|cons|alternatives?|questions?|best|top|guide|review)/i.test(t.bodyText),w={name:"Content Depth & Authority",score:0,checks:[{id:"length",label:"Sufficient word count (>=500)",passed:v,weight:3},{id:"topics",label:"Topical coverage breadth",passed:D,weight:3},{id:"questions",label:"Questions answered present",passed:n,weight:2}]},N=/<meta[^>]+name=["']viewport["'][^>]*>/i.test(t.html),U=(t.url||"").startsWith("https://"),J={name:"Technical & Schema",score:0,checks:[{id:"productSchema",label:"Product schema implemented",passed:t.productSchemaFound,weight:3},{id:"faqSchema",label:"FAQ schema implemented",passed:t.faqSchemaFound,weight:2},{id:"breadcrumb",label:"Breadcrumb schema",passed:t.breadcrumbSchemaFound,weight:1},{id:"mobile",label:"Mobile-friendly (viewport tag)",passed:N,weight:2},{id:"https",label:"HTTPS secure",passed:U||!t.url,weight:1}]},k={name:"Off-Site & Trust Signals",score:0,checks:[{id:"externalReviews",label:"External reviews/mentions referenced",passed:/(trustpilot|google reviews?|as seen on|featured in|award|certified|warranty)/i.test(t.bodyText),weight:2}]},$=[E,C,w,J,k];$.forEach(O=>{const y=O.checks.reduce((g,j)=>g+j.weight,0),u=O.checks.reduce((g,j)=>g+(j.passed?j.weight:0),0);O.score=Math.round(u/Math.max(1,y)*100),O.checks.forEach(g=>{if(!g.passed){const j={specs:"Add structured product specs like size, material, care, price, and stock.",rich:"Expand product description with benefits, use cases, and differentiators.",faqs:"Add an FAQ section or implement FAQ schema to answer common questions.",reviews:"Show customer reviews or ratings; implement Review/AggregateRating schema.",alt:"Ensure at least 70% of product images have descriptive alt text.",guide:"Publish a buying guide explaining how to choose the right product.",comparison:"Add a comparison table between models or alternatives.",seasonal:"Incorporate seasonal/trend keywords where relevant.",links:"Add internal links to related categories, guides, and products.",length:"Increase page content to at least 500 words with useful details.",topics:"Cover more topics: features, benefits, pros/cons, alternatives, FAQs.",productSchema:"Add Product JSON-LD schema with offers, brand, and ratings.",faqSchema:"Add FAQPage JSON-LD schema for your FAQ section.",breadcrumb:"Implement BreadcrumbList schema for better navigation.",mobile:"Add meta viewport and ensure mobile-friendly layout.",https:"Serve the page over HTTPS with a valid certificate.",externalReviews:"Build trust with external reviews (Trustpilot/Google) and cite them."};o.push(j[g.id]||g.label)}})});const Y=[30,20,25,20,5];return{overall:Math.round($.reduce((O,y,u)=>O+y.score*(Y[u]/100),0)),pillars:$,suggestions:Array.from(new Set(o))}}function Es(){const[t,o]=l.useState("url"),[p,n]=l.useState(""),[i,x]=l.useState(""),[f,h]=l.useState(!1),[P,E]=l.useState(null),[S,q]=l.useState(null),[T,R]=l.useState(null),[C,v]=l.useState([]),[D,w]=l.useState([]),N=l.useRef(null),U=async k=>{const $=k.target.files?.[0];if(!$)return;const Y=await $.text();x(Y),o("content")},J=async()=>{h(!0),E(null),q(null);try{let k="",$;if(t==="url"){const O=p.trim();if(!O)throw new Error("Please enter a URL");$=O;try{const y=await ne.extractFullPageHtml(O);y?.success&&y.html&&(k=y.html)}catch{}if(k||(k=(await ne.extractContentFromUrl(O))?.content||""),!k)throw new Error("Failed to extract content from the URL")}else k=i,/</.test(k)||(k=`<html><head><title>Document</title></head><body><article>${i.replace(/&/g,"&amp;").replace(/</g,"&lt;")}</article></body></html>`);const Y=Cs(k,$);q(Y);const Z=Y.title||($?new URL($).hostname.replace(/^www\./,""):"");if(Z)try{const[O,y]=await Promise.all([ne.getOffsiteSignals({brandOrProduct:Z,domain:$?new URL($).hostname:void 0}).catch(()=>null),ne.getCompetitors({brandOrProduct:Z,currentUrl:$}).catch(()=>({competitors:[]}))]);if(O&&(O.success===void 0||O.success)&&R({totals:O.totals,counts:O.counts,topResults:O.topResults||[]}),y&&y.success!==!1){v(y.competitors||[]);const u=(y.competitors||[]).slice(0,5).map(g=>g.link);if(u.length>0){const g=await ne.fetchBatchHtml(u).catch(()=>null);g&&g.success!==!1&&w(g.results||[])}}}catch{}}catch(k){E(k?.message||"Analysis failed")}finally{h(!1)}},ee=l.useMemo(()=>S?As(S):null,[S]);return e.jsxs("div",{className:"max-w-6xl mx-auto",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-6",children:[e.jsx(Ps,{}),e.jsx("h2",{className:"text-3xl font-extrabold text-black",children:"E-commerce Content Analysis"})]}),e.jsxs("div",{className:"bg-white border rounded-lg p-4 mb-6",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[e.jsxs("button",{className:`px-4 py-2 rounded-lg text-sm font-medium ${t==="url"?"bg-blue-600 text-white":"bg-gray-100 text-gray-800"}`,onClick:()=>o("url"),children:[e.jsx(Nt,{className:"w-4 h-4 inline mr-1"})," URL"]}),e.jsxs("button",{className:`px-4 py-2 rounded-lg text-sm font-medium ${t==="content"?"bg-blue-600 text-white":"bg-gray-100 text-gray-800"}`,onClick:()=>o("content"),children:[e.jsx(Le,{className:"w-4 h-4 inline mr-1"})," HTML/Text"]})]}),t==="url"?e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{value:p,onChange:k=>n(k.target.value),placeholder:"https://example.com/product",className:"flex-1 border rounded-lg px-3 py-2"}),e.jsx("button",{onClick:J,disabled:f,className:"px-4 py-2 rounded-lg bg-blue-600 text-white hover:bg-blue-700 disabled:opacity-50",children:f?e.jsx(le,{className:"w-4 h-4 animate-spin"}):"Analyze"})]}):e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("input",{type:"file",accept:".html,.htm,.txt,.md",ref:N,onChange:U,className:"hidden"}),e.jsxs("button",{onClick:()=>N.current?.click(),className:"px-3 py-2 bg-white border rounded-lg text-gray-700 hover:bg-gray-50",children:[e.jsx(ts,{className:"w-4 h-4 inline mr-1"})," Upload"]})]}),e.jsx("textarea",{value:i,onChange:k=>x(k.target.value),rows:8,placeholder:"Paste HTML or raw text here...",className:"w-full border rounded-lg px-3 py-2"}),e.jsx("div",{className:"mt-2",children:e.jsx("button",{onClick:J,disabled:f,className:"px-4 py-2 rounded-lg bg-blue-600 text-white hover:bg-blue-700 disabled:opacity-50",children:f?e.jsx(le,{className:"w-4 h-4 animate-spin"}):"Analyze"})})]}),P&&e.jsxs("div",{className:"mt-3 p-3 bg-red-50 border border-red-200 rounded-lg text-red-700 flex items-center gap-2",children:[e.jsx(ss,{className:"w-4 h-4"})," ",P]})]}),S&&ee&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:[e.jsx("div",{className:"text-sm text-green-800 mb-1",children:"AI Readiness Score"}),e.jsxs("div",{className:"text-4xl font-extrabold text-green-900",children:[ee.overall,"%"]})]}),e.jsxs("div",{className:"bg-white border rounded-lg p-4",children:[e.jsx("div",{className:"text-sm text-gray-600",children:"Title"}),e.jsx("div",{className:"font-medium text-black truncate",title:S.title||"",children:S.title||"—"})]}),e.jsxs("div",{className:"bg-white border rounded-lg p-4",children:[e.jsx("div",{className:"text-sm text-gray-600",children:"Description"}),e.jsx("div",{className:"text-black line-clamp-2",title:S.metaDescription||"",children:S.metaDescription||"—"})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:ee.pillars.map(k=>e.jsxs("div",{className:"bg-white border rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("div",{className:"font-semibold text-black",children:k.name}),e.jsxs("span",{className:"px-2 py-0.5 text-xs rounded-full bg-gray-100 text-gray-700 font-semibold",children:[k.score,"%"]})]}),e.jsx("div",{className:"divide-y",children:k.checks.map($=>e.jsxs("div",{className:"flex items-center justify-between py-2 text-sm",children:[e.jsx("span",{className:"text-black",children:$.label}),$.passed?e.jsx(xt,{className:"w-4 h-4 text-green-600"}):e.jsx(Ye,{className:"w-4 h-4 text-red-600"})]},$.id))})]},k.name))}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-white border rounded-lg p-4",children:[e.jsx("div",{className:"font-semibold text-black mb-2",children:"Structure"}),e.jsxs("div",{className:"text-sm text-black",children:[e.jsx("strong",{children:"H1"}),": ",S.h1.join(" | ")||"—"]}),e.jsxs("div",{className:"text-sm text-black mt-1",children:[e.jsx("strong",{children:"H2"}),": ",S.h2.slice(0,6).join(" | ")||"—"]}),e.jsxs("div",{className:"text-sm text-black mt-1",children:[e.jsx("strong",{children:"H3"}),": ",S.h3.slice(0,6).join(" | ")||"—"]})]}),e.jsxs("div",{className:"bg-white border rounded-lg p-4",children:[e.jsx("div",{className:"font-semibold text-black mb-2",children:"Schema & Media"}),e.jsxs("div",{className:"text-sm text-black",children:["Product schema: ",S.productSchemaFound?"Yes":"No"]}),e.jsxs("div",{className:"text-sm text-black",children:["FAQ schema: ",S.faqSchemaFound?"Yes":"No"]}),e.jsxs("div",{className:"text-sm text-black",children:["Breadcrumb: ",S.breadcrumbSchemaFound?"Yes":"No"]}),e.jsxs("div",{className:"text-sm text-black",children:["Reviews schema: ",S.reviewsSchemaFound?"Yes":"No"]}),e.jsxs("div",{className:"text-sm text-black",children:["Image alt coverage: ",S.imageAltCoverage.withAlt,"/",S.imageAltCoverage.total]})]})]}),e.jsxs("div",{className:"bg-white border rounded-lg p-4",children:[e.jsx("div",{className:"font-semibold text-black mb-2",children:"Actionable Suggestions"}),ee.suggestions.length===0?e.jsx("div",{className:"text-sm text-green-700",children:"No critical issues found. Great job!"}):e.jsx("ul",{className:"list-disc pl-5 text-sm text-black space-y-1",children:ee.suggestions.map((k,$)=>e.jsx("li",{children:k},$))})]}),T&&e.jsxs("div",{className:"bg-white border rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("div",{className:"font-semibold text-black",children:"Off‑Site & Trust Signals"}),e.jsxs("span",{className:"px-2 py-0.5 text-xs rounded-full bg-gray-100 text-gray-700 font-semibold",children:[Math.min(100,((T.counts?.trustpilot>0?1:0)+(T.counts?.google>0?1:0)+(T.counts?.reddit>0?1:0)+(T.counts?.quora>0?1:0)+(T.counts?.youtube>0?1:0))*20),"%"]})]}),e.jsx("div",{className:"divide-y text-sm",children:[{id:"reviews",label:"Third‑party reviews",pass:(T.counts?.trustpilot||0)+(T.counts?.google||0)>0},{id:"blogs",label:"Blog mentions",pass:(T.counts?.google||0)>0},{id:"social",label:"Social discussions",pass:(T.counts?.reddit||0)>0},{id:"authority",label:"Brand authority",pass:(T.totals?.totalMentions||0)>=5||(T.counts?.youtube||0)>0}].map(k=>e.jsxs("div",{className:"flex items-center justify-between py-2",children:[e.jsx("span",{className:"text-black",children:k.label}),k.pass?e.jsx(xt,{className:"w-4 h-4 text-green-600"}):e.jsx(Ye,{className:"w-4 h-4 text-red-600"})]},k.id))}),Array.isArray(T.topResults)&&T.topResults.length>0&&e.jsx("div",{className:"mt-3 space-y-2",children:T.topResults.slice(0,8).map((k,$)=>e.jsxs("a",{href:k.link,target:"_blank",rel:"noreferrer",className:"block text-sm text-blue-700 hover:underline",children:[e.jsx(pt,{className:"w-3.5 h-3.5 inline mr-1"})," ",k.name]},$))})]}),C&&C.length>0&&e.jsxs("div",{className:"bg-white border rounded-lg p-4",children:[e.jsx("div",{className:"font-semibold text-black mb-2",children:"Top Competitors (Google)"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:C.map((k,$)=>e.jsxs("a",{href:k.link,target:"_blank",rel:"noreferrer",className:"p-3 border rounded-lg hover:bg-gray-50",children:[e.jsxs("div",{className:"font-medium text-black flex items-center gap-2",children:[e.jsx(pt,{className:"w-3.5 h-3.5"})," ",k.name]}),e.jsx("div",{className:"text-xs text-gray-600 mt-1 line-clamp-2",children:k.snippet})]},$))}),D&&D.length>0&&e.jsxs("div",{className:"mt-4",children:[e.jsx("div",{className:"font-semibold text-black mb-2",children:"Competitor Coverage (real crawled)"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:D.map((k,$)=>e.jsxs("div",{className:"p-3 border rounded-lg",children:[e.jsx("div",{className:"text-sm text-black font-medium truncate",title:k.url,children:k.url}),k.success?e.jsxs("div",{className:"text-xs text-gray-700 mt-1 space-y-1",children:[e.jsxs("div",{children:["Words: ",k.wordCount]}),e.jsxs("div",{children:["H1: ",(k.h1||[]).slice(0,2).join(" | ")||"—"]}),e.jsxs("div",{children:["H2: ",(k.h2||[]).slice(0,3).join(" | ")||"—"]}),e.jsxs("div",{children:["Tables present: ",k.hasTable?"Yes":"No"]})]}):e.jsxs("div",{className:"text-xs text-red-600 mt-1",children:["Failed: ",k.error]})]},$))})]})]})]})]})}function Ps(){return e.jsx("div",{className:"w-8 h-8 rounded-lg bg-gradient-to-r from-blue-600 to-indigo-500 flex items-center justify-center",children:e.jsx(Fs,{})})}function Fs(){return e.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[e.jsx("path",{d:"M3 3h2l.4 2M7 13h10l3-8H6.4",stroke:"white",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("circle",{cx:"9",cy:"20",r:"1",fill:"white"}),e.jsx("circle",{cx:"18",cy:"20",r:"1",fill:"white"})]})}const Ts=()=>{const[t,o]=l.useState(null),[p,n]=l.useState(null),i=()=>{o("Invalid email or password. Please check your credentials and try again.")},x=()=>{n("Login successful! Welcome back.")},f=()=>{o("Your session will expire soon. Please save your work.")};return e.jsxs("div",{className:"p-8 space-y-4",children:[e.jsx("h2",{className:"text-2xl font-bold",children:"Notification Test"}),e.jsxs("div",{className:"space-x-4",children:[e.jsx("button",{onClick:i,className:"px-4 py-2 bg-red-500 text-white rounded hover:bg-red-600",children:"Show Error"}),e.jsx("button",{onClick:x,className:"px-4 py-2 bg-green-500 text-white rounded hover:bg-green-600",children:"Show Success"}),e.jsx("button",{onClick:f,className:"px-4 py-2 bg-yellow-500 text-white rounded hover:bg-yellow-600",children:"Show Warning"})]}),e.jsx($e,{error:t,onClose:()=>o(null),autoClose:!0,autoCloseDelay:5e3,type:"error"}),e.jsx(vt,{message:p,onClose:()=>n(null),autoClose:!0,autoCloseDelay:3e3})]})},ft="llm_qa_sessions",Ze="llm_qa_current_session";function Ds(){const{user:t}=ze();fe();const[o,p]=l.useState("ecommerce"),[n,i]=l.useState("product"),[x,f]=l.useState([]),[h,P]=l.useState([]),[E,S]=l.useState(new Set),[q,T]=l.useState(!1),[R,C]=l.useState(!1),[v,D]=l.useState(!1),[w,N]=l.useState(null),[U,J]=l.useState(!1),[ee,k]=l.useState([]),[$,Y]=l.useState(new Set),[Z,O]=l.useState(!1),[y,u]=l.useState(!1),[g,j]=l.useState(!1),[Q,_]=l.useState(!1),a="kabini_ecommerce_content",r="kabini_ecommerce_content_type";l.useEffect(()=>{try{const s=localStorage.getItem(a);if(s){const c=JSON.parse(s),L=Qe(c);L&&N(L)}const m=localStorage.getItem(r);(m==="product"||m==="category"||m==="faq")&&i(m)}catch{}},[]),l.useEffect(()=>{try{w?localStorage.setItem(a,JSON.stringify(w)):localStorage.removeItem(a)}catch{}},[w]),l.useEffect(()=>{try{localStorage.setItem(r,n)}catch{}},[n]),l.useEffect(()=>{o!=="ecommerce"&&N(null)},[o]);const[b,d]=l.useState({name:"",features:"",targetAudience:"",category:"",tone:"professional"}),[V,G]=l.useState({categoryName:"",productTypes:"",audience:""}),[B,X]=l.useState("gemini"),[M,F]=l.useState("gemini-1.5-flash"),[H,at]=l.useState([]),[rt,xe]=l.useState(!1),[nt,ye]=l.useState(!1),[Bs,Se]=l.useState(null),[ie,pe]=l.useState(""),[Hs,Vs]=l.useState([]),[zs,Gs]=l.useState(""),[_s,Ks]=l.useState(!1),[Ws,Js]=l.useState(!1),[te,Ie]=l.useState(""),[Pe,Fe]=l.useState([]),[z,ke]=l.useState(null),[qe,Ge]=l.useState(new Set),[Pt,W]=l.useState(null),[Ft,re]=l.useState("success"),ce=l.useRef(null),ue=l.useRef(null),oe=(s,m)=>`${s}_${m}`,_e=()=>oe("faq_last_persisted",t?.id||"anonymous"),Ke=s=>{try{return new URL(s.trim()),!0}catch{return!1}},Re=s=>{const m=s.trim();if(Ke(m))return m;const c=/https?:\/\/[^\s]+/g,L=m.match(c);return L?L[0]:null};l.useEffect(()=>{if(ce.current&&ie){ce.current.style.height="auto";const s=Math.max(36,Math.min(ce.current.scrollHeight,150));ce.current.style.height=s+"px"}},[ie]),l.useEffect(()=>{if(ue.current&&te){ue.current.style.height="auto";const s=Math.max(36,Math.min(ue.current.scrollHeight,150));ue.current.style.height=s+"px"}},[te]),l.useEffect(()=>{switch(B){case"gemini":F("gemini-1.5-flash");break;case"openai":F("gpt-3.5-turbo");break;case"perplexity":F("sonar");break;case"claude":F("claude-3-sonnet-20240229");break;default:F("gemini-1.5-flash")}},[B]),l.useEffect(()=>{if(t?.id){const s=oe(ft,t.id),m=oe(Ze,t.id);console.log("[FAQ Session] Loading sessions from localStorage:",{userSessionsKey:s,userCurrentSessionKey:m,userId:t.id});try{const c=localStorage.getItem(s);if(c){const A=JSON.parse(c);console.log("[FAQ Session] Loaded sessions:",A.length),Fe(A)}const L=localStorage.getItem(m);if(L){const A=JSON.parse(L);console.log("[FAQ Session] Loaded current session:",{id:A.id,type:A.type,qaDataLength:A.qaData?.length||0,questionsLength:A.generatedQuestions?.length||0,showQuestionsSection:A.showQuestionsSection,showFAQSection:A.showFAQSection}),ke(A)}else console.log("[FAQ Session] No current session found in localStorage")}catch(c){console.error("[Session Loading] Error loading sessions:",c)}}},[t?.id]),l.useEffect(()=>{try{if(z)return;const s=_e(),m=localStorage.getItem(s);if(!m)return;const c=JSON.parse(m);if(c?.savedAt&&Date.now()-c.savedAt>24*60*60*1e3)return;if(console.log("[FAQ Persist] Restoring last persisted FAQ state"),(c.selectedIndustry==="general"||c.selectedIndustry==="ecommerce")&&p(c.selectedIndustry),(c.contentType==="product"||c.contentType==="category"||c.contentType==="faq")&&i(c.contentType),typeof c.content=="string"&&pe(c.content),typeof c.ecomFaqContent=="string"&&Ie(c.ecomFaqContent),Array.isArray(c.generatedQuestions)&&P(c.generatedQuestions),Array.isArray(c.ecomGeneratedQuestions)&&k(c.ecomGeneratedQuestions),Array.isArray(c.faqs)&&f(c.faqs),typeof c.showEcomQuestionsSection=="boolean"&&j(c.showEcomQuestionsSection),typeof c.showEcomFAQSection=="boolean"&&_(c.showEcomFAQSection),typeof c.faqProvider=="string"&&X(c.faqProvider),typeof c.faqModel=="string"&&F(c.faqModel),typeof c.showQuestionsSection=="boolean"&&ye(c.showQuestionsSection),typeof c.showFAQSection=="boolean"&&xe(c.showFAQSection),c.ecommerceContent){const L=Qe(c.ecommerceContent);L&&N(L)}}catch(s){console.warn("[FAQ Persist] Failed to restore persisted FAQ state:",s)}},[z,t?.id]),l.useEffect(()=>{try{const s={selectedIndustry:o,contentType:n,content:ie,ecomFaqContent:te,generatedQuestions:h,ecomGeneratedQuestions:ee,faqs:x,faqProvider:B,faqModel:M,showQuestionsSection:nt,showFAQSection:rt,showEcomQuestionsSection:g,showEcomFAQSection:Q,ecommerceContent:w,savedAt:Date.now()};localStorage.setItem(_e(),JSON.stringify(s))}catch{}},[o,n,ie,te,h,ee,x,B,M,nt,rt,g,Q,w,t?.id]),l.useEffect(()=>{if(t?.id&&Pe.length>0){const s=oe(ft,t.id);try{localStorage.setItem(s,JSON.stringify(Pe))}catch(m){console.error("[Session Saving] Error saving sessions:",m)}}},[Pe,t?.id]),l.useEffect(()=>{if(t?.id&&z){const s=oe(Ze,t.id);try{console.log("[FAQ Session] Saving current session to localStorage:",{key:s,sessionId:z.id,sessionType:z.type,qaDataLength:z.qaData?.length||0,questionsLength:z.generatedQuestions?.length||0,showQuestionsSection:z.showQuestionsSection,showFAQSection:z.showFAQSection}),localStorage.setItem(s,JSON.stringify(z))}catch(m){console.error("[Session Saving] Error saving current session:",m)}}},[z,t?.id]),l.useEffect(()=>{t||(Fe([]),ke(null),Ge(new Set),f([]),P([]),xe(!1),ye(!1),pe(""),T(!1),C(!1),Se(null))},[t]),l.useEffect(()=>{z&&z.type==="faq"?(console.log("[FAQ Session] Restoring FAQ session:",{id:z.id,qaDataLength:z.qaData?.length||0,questionsLength:z.generatedQuestions?.length||0,blogContentLength:z.blogContent?.length||0,showQuestionsSection:z.showQuestionsSection,showFAQSection:z.showFAQSection}),f(z.qaData||[]),pe(z.blogContent||""),X(z.questionProvider||"gemini"),F(z.questionModel||(z.questionProvider==="perplexity"?"sonar":z.questionProvider==="claude"?"claude-3-sonnet-20240229":"gemini-1.5-flash")),P(z.generatedQuestions||[]),ye(z.showQuestionsSection||!1),xe(z.showFAQSection||!1),ce.current&&z.blogContent&&setTimeout(()=>{if(ce.current){ce.current.style.height="auto";const s=Math.max(36,Math.min(ce.current.scrollHeight,150));ce.current.style.height=s+"px"}},100)):z&&z.type!=="faq"?(console.log("[FAQ Session] Clearing FAQ state - current session is not FAQ type:",z.type),f([]),P([]),xe(!1),ye(!1)):z||(console.log("[FAQ Session] Clearing FAQ state - no current session"),f([]),P([]),xe(!1),ye(!1))},[z]),l.useEffect(()=>{if(t?.id){const s=oe("pending_faq_generation",t.id),m=oe("generated_faqs",t.id);try{const c=localStorage.getItem(s);if(c){const A=JSON.parse(c);Date.now()-A.timestamp<5*60*1e3?(Se(A),T(!0),pe(A.content),X(A.provider),F(A.model),at(A.targetKeywords),Tt(A)):localStorage.removeItem(s)}const L=localStorage.getItem(m);if(L){const A=JSON.parse(L);Date.now()-A.timestamp<10*60*1e3&&(console.log("[Background FAQ] Restoring generated FAQs:",A.faqs.length),setTimeout(()=>{f(A.faqs),xe(!0),pe(A.content),X(A.provider),F(A.model),D(!1);const Te=A.faqs.length===1?"FAQ":"FAQs";W(`Restored ${A.faqs.length} previously generated ${Te}!`)},100)),localStorage.removeItem(m)}}catch(c){console.error("[Background FAQ] Error loading background data:",c),localStorage.removeItem(s),localStorage.removeItem(m)}}},[t?.id]);const Tt=async s=>{try{console.log("[Pending FAQ] Continuing FAQ generation for content length:",s.content.length);const m=await ne.generateAIFAQs({content:s.content.trim(),provider:s.provider,model:s.model,targetKeywords:s.targetKeywords});if(m.faqs&&Array.isArray(m.faqs)&&m.faqs.length>0){if(console.log("[Pending FAQ] Successfully generated FAQs:",m.faqs.length),t?.id){const L=oe("generated_faqs",t.id),A={faqs:m.faqs,content:s.content,provider:s.provider,model:s.model,timestamp:Date.now()};localStorage.setItem(L,JSON.stringify(A))}if(f(m.faqs),xe(!0),D(!1),Se(null),t?.id){const L=oe("pending_faq_generation",t.id);localStorage.removeItem(L)}if(t?.id){const L=Re(s.content),A={id:`faq-session-${Date.now()}`,name:`FAQ Session - ${new Date().toLocaleDateString()}`,type:"faq",timestamp:new Date().toISOString(),model:s.model,questionProvider:s.provider,answerProvider:s.provider,questionModel:s.model,answerModel:s.model,blogContent:s.content,blogUrl:L||void 0,sourceUrls:L?[L]:void 0,qaData:m.faqs.map(I=>({question:I.question,answer:I.answer})),totalInputTokens:s.content.length/4,totalOutputTokens:m.faqs.reduce((I,K)=>I+K.question.length+K.answer.length,0)/4,statistics:{totalQuestions:m.faqs.length,avgAccuracy:"85",avgCitationLikelihood:"75",totalCost:"0.01"},userId:t.id};Fe(I=>[A,...I]),ke(A)}const c=m.faqs.length===1?"FAQ":"FAQs";W(`Successfully generated ${m.faqs.length} ${c}!`)}else if(console.error("[Pending FAQ] Invalid response format:",m),W("Failed to generate FAQs. Please try again."),D(!1),Se(null),t?.id){const c=oe("pending_faq_generation",t.id);localStorage.removeItem(c)}}catch(m){if(console.error("[Pending FAQ] Error generating FAQs:",m),W("Error generating FAQs. Please try again."),D(!1),Se(null),t?.id){const c=oe("pending_faq_generation",t.id);localStorage.removeItem(c)}}},ot=async()=>{if(!ie.trim()){W("Please enter some content first");return}const s=ie.trim();if(!(c=>{try{return new URL(c),!0}catch{return!1}})(s)){if(/^\d+$/.test(s)){re("error"),W("Enter valid content");return}if(/^[\p{Emoji}\p{Symbol}\p{Punctuation}\s]+$/u.test(s)){re("error"),W("Enter valid content");return}if(s.length<10||/^[a-zA-Z\s]{1,10}$/.test(s)){re("error"),W("Enter valid content");return}if(s.split(/\s+/).filter(L=>L.length>0).length<3){re("error"),W("Enter valid content");return}}T(!0),P([]),S(new Set);try{const c=await ne.generateAIFAQs({content:ie.trim(),provider:B,model:M,targetKeywords:H,generateQuestionsOnly:!0});if(c.success&&c.questions){const L=c.questions||[];P(L),ye(!0);const A=L.length===1?"question":"questions";re("success"),W(`Generated ${L.length} ${A} successfully!`),$t(L)}else re("error"),W("Failed to generate questions. Please try again.")}catch(c){console.error("[Questions Generation] Error:",c),re("error"),W("Error generating questions. Please try again.")}finally{T(!1)}},Dt=async()=>{const s=b.name.trim()||V.categoryName.trim(),m=te.trim();if(!s&&!m){W("Please fill in product/category name or provide additional content");return}if(m){const c=te.trim();if(!(A=>{try{return new URL(A),!0}catch{return!1}})(c)){if(/^\d+$/.test(c)){re("error"),W("Enter valid content");return}if(/^[\p{Emoji}\p{Symbol}\p{Punctuation}\s]+$/u.test(c)){re("error"),W("Enter valid content");return}if(c.length<10||/^[a-zA-Z\s]{1,10}$/.test(c)){re("error"),W("Enter valid content");return}if(c.split(/\s+/).filter(I=>I.length>0).length<3){re("error"),W("Enter valid content");return}}}O(!0),k([]),Y(new Set),f([]),_(!1);try{let c="";if(s){const A=b.name||V.categoryName,I=b.targetAudience||"";c=`Product/Category: ${A}
Target Audience: ${I}`}if(m){const A=te.trim();if(Ke(A)){console.log("[E-commerce FAQ] Detected URL, crawling content:",A);try{const I=await ne.extractContentFromUrl(A);if(I.success&&I.content){const K=I.content;c?c+=`

Additional Content from URL (${A}):
${K}`:c=`Content from URL (${A}):
${K}`,console.log("[E-commerce FAQ] Successfully crawled URL content, length:",K.length)}else console.warn("[E-commerce FAQ] Failed to crawl URL, using URL as text"),c?c+=`

Additional Content:
${te}`:c=te}catch(I){console.error("[E-commerce FAQ] Error crawling URL:",I),c?c+=`

Additional Content:
${te}`:c=te}}else c?c+=`

Additional Content:
${te}`:c=te}const L=await ne.generateAIFAQs({content:c.trim(),provider:B,model:M,targetKeywords:H,generateQuestionsOnly:!0});if(L.success&&L.questions){const A=L.questions||[];k(A),j(!0);const I=A.length===1?"question":"questions";re("success"),W(`Generated ${A.length} ${I} successfully!`)}else re("error"),W("Failed to generate questions. Please try again.")}catch(c){console.error("[E-commerce Questions Generation] Error:",c),re("error"),c instanceof Error&&(c.message.includes("403")||c.message.includes("Forbidden")||c.message.includes("Invalid or expired token")||c.message.includes("Session expired"))?(W("Your session has expired. Please log in again."),setTimeout(()=>{window.location.href="/login"},2e3)):W("Error generating questions. Please try again.")}finally{O(!1)}},Lt=async()=>{if($.size===0){W("Please select at least one question to generate answers for");return}u(!0);try{let s="";const m=b.name.trim()||V.categoryName.trim(),c=te.trim();if(m){const I=b.name||V.categoryName,K=b.targetAudience||"";s=`Product/Category: ${I}
Target Audience: ${K}`}if(c){const I=te.trim();if(Ke(I)){console.log("[E-commerce FAQ] Detected URL for answers, crawling content:",I);try{const K=await ne.extractContentFromUrl(I);if(K.success&&K.content){const Te=K.content;s?s+=`

Additional Content from URL (${I}):
${Te}`:s=`Content from URL (${I}):
${Te}`,console.log("[E-commerce FAQ] Successfully crawled URL content for answers, length:",Te.length)}else console.warn("[E-commerce FAQ] Failed to crawl URL for answers, using URL as text"),s?s+=`

Additional Content:
${te}`:s=te}catch(K){console.error("[E-commerce FAQ] Error crawling URL for answers:",K),s?s+=`

Additional Content:
${te}`:s=te}}else s?s+=`

Additional Content:
${te}`:s=te}const L=Array.from($).map(I=>ee[I]),A=await ne.generateAIFAQs({content:s.trim(),provider:B,model:M,targetKeywords:H,selectedQuestions:L,generateAnswersOnly:!0});if(A.success&&A.faqs){const I=A.faqs.map(K=>({question:K.question,answer:K.answer}));f(K=>[...K,...I]),re("success"),W(`Generated answers for ${I.length} questions successfully!`)}else re("error"),W("Failed to generate answers. Please try again.")}catch(s){console.error("[E-commerce Answers Generation] Error:",s),re("error"),s instanceof Error&&(s.message.includes("403")||s.message.includes("Forbidden")||s.message.includes("Invalid or expired token")||s.message.includes("Session expired"))?(W("Your session has expired. Please log in again."),setTimeout(()=>{window.location.href="/login"},2e3)):W("Error generating answers. Please try again.")}finally{u(!1)}},$t=s=>{if(!t?.id){console.warn("[FAQ Session] Cannot save questions session - no user ID");return}const m={id:`faq-${Date.now()}`,name:`FAQ Session - ${new Date().toLocaleDateString()}`,type:"faq",timestamp:new Date().toISOString(),model:M,questionProvider:B||null,answerProvider:B||null,questionModel:M||null,answerModel:M||null,blogContent:ie,blogUrl:Re(ie)||void 0,sourceUrls:Re(ie)?[Re(ie)]:[],qaData:[],totalInputTokens:0,totalOutputTokens:0,statistics:{totalQuestions:s.length,avgAccuracy:"N/A",avgCitationLikelihood:"N/A",totalCost:"N/A"},userId:t.id,generatedQuestions:s,showQuestionsSection:!0,showFAQSection:!1};console.log("[FAQ Session] Saving questions session:",{id:m.id,questionsLength:m.generatedQuestions?.length||0,blogContentLength:m.blogContent.length,userId:m.userId}),Fe(c=>[m,...c]),ke(m)},lt=s=>{t?.id&&(Fe(m=>m.filter(L=>L.id!==s)),z?.id===s&&ke(null),Ge(m=>{const c=new Set(m);return c.delete(s),c}))},Qe=s=>{if(!s)return null;if(typeof s=="object"&&("productContent"in s||"categoryContent"in s||"faqs"in s))return s;if(typeof s=="object"&&"shortDescription"in s&&"longDescription"in s)return{productContent:s,categoryContent:void 0,faqs:[],seoRecommendations:{schemaSuggestions:[],contentDepthScore:0,aiOptimizationTips:[],technicalSeoReminders:[]}};if(typeof s=="object"&&"faqs"in s){const m=s.faqs;let c=[];if(Array.isArray(m))c=m;else if(Array.isArray(m?.faqs))c=m.faqs;else if(m&&typeof m=="object")try{c=Object.values(m)}catch{c=[]}const L=s.seoRecommendations||m?.seoRecommendations||{schemaSuggestions:[],contentDepthScore:0,aiOptimizationTips:[],technicalSeoReminders:[]};return{productContent:void 0,categoryContent:void 0,faqs:c,seoRecommendations:L}}return null},It=async()=>{if(!b.name.trim()||!b.features.trim()){alert("Please fill in product name and features");return}J(!0);try{const s=await ne.generateEcommerceContent({type:"product",inputs:b,provider:B,model:M});if(s.success){console.log("[Product Content] Received data:",s.data);const m=Qe(s.data);N(m),W("Product content generated successfully!")}else console.error("[Product Content] API error:",s.error),alert("Failed to generate product content: "+(s.error||"Unknown error"))}catch(s){console.error("Error generating product content:",s),alert("Failed to generate product content")}finally{J(!1)}},qt=async()=>{if(!V.categoryName.trim()){alert("Please fill in category name");return}J(!0);try{const s=await ne.generateEcommerceContent({type:"category",inputs:V,provider:B,model:M});if(s.success){console.log("[Category Content] Received data:",s.data);const m=Qe(s.data);N(m),W("Category content generated successfully!")}else console.error("[Category Content] API error:",s.error),alert("Failed to generate category content: "+(s.error||"Unknown error"))}catch(s){console.error("Error generating category content:",s),alert("Failed to generate category content")}finally{J(!1)}};return e.jsxs("div",{className:"flex gap-8 w-full",children:[e.jsx("div",{className:"flex-1 space-y-8",children:e.jsxs("div",{className:"card bg-white border border-primary/10 shadow-xl",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-6",children:[e.jsx(Le,{className:"w-8 h-8 text-black drop-shadow"}),e.jsx("h2",{className:"text-3xl font-extrabold text-black tracking-tight",children:"Content Enhancement"})]}),e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-base font-semibold text-black mb-3 flex items-center gap-2",children:[e.jsx(Je,{className:"w-5 h-5 text-black"}),"Content Type"]}),e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("button",{onClick:()=>i("product"),className:`px-4 py-2 rounded-lg font-medium transition-all duration-200 flex items-center gap-2 ${n==="product"?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:[e.jsx(Je,{className:"w-4 h-4"}),"Product Description"]}),e.jsxs("button",{onClick:()=>i("category"),className:`px-4 py-2 rounded-lg font-medium transition-all duration-200 flex items-center gap-2 ${n==="category"?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:[e.jsx(Oe,{className:"w-4 h-4"}),"Category Page"]}),e.jsxs("button",{onClick:()=>i("faq"),className:`px-4 py-2 rounded-lg font-medium transition-all duration-200 flex items-center gap-2 ${n==="faq"?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:[e.jsx(Xe,{className:"w-4 h-4"}),"FAQ Generator"]})]})]}),n==="product"&&e.jsxs("div",{className:"space-y-4 p-4 bg-blue-50 rounded-lg",children:[e.jsx("h3",{className:"text-lg font-semibold text-black",children:"Product Description Generator"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Product Name"}),e.jsx("input",{type:"text",value:b.name,onChange:s=>d(m=>({...m,name:s.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"e.g., iPhone 15 Pro"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Category"}),e.jsx("input",{type:"text",value:b.category,onChange:s=>d(m=>({...m,category:s.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"e.g., Smartphones"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Target Audience"}),e.jsx("input",{type:"text",value:b.targetAudience,onChange:s=>d(m=>({...m,targetAudience:s.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"e.g., Tech enthusiasts, professionals"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tone"}),e.jsxs("select",{value:b.tone,onChange:s=>d(m=>({...m,tone:s.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[e.jsx("option",{value:"casual",children:"Casual"}),e.jsx("option",{value:"professional",children:"Professional"}),e.jsx("option",{value:"persuasive",children:"Persuasive"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Features/Specs"}),e.jsx("textarea",{value:b.features,onChange:s=>d(m=>({...m,features:s.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",rows:3,placeholder:"List key features, specifications, and technical details..."})]}),e.jsxs("button",{onClick:It,disabled:U,className:"bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 transition-colors flex items-center gap-2 disabled:opacity-50",children:[U?e.jsx(le,{className:"w-4 h-4 animate-spin"}):e.jsx(be,{className:"w-4 h-4"}),"Generate Product Content"]})]}),n==="category"&&e.jsxs("div",{className:"space-y-4 p-4 bg-blue-50 rounded-lg",children:[e.jsx("h3",{className:"text-lg font-semibold text-black",children:"Category Page Content Generator"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Category Name"}),e.jsx("input",{type:"text",value:V.categoryName,onChange:s=>G(m=>({...m,categoryName:s.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"e.g., Men's T-Shirts"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Product Types"}),e.jsx("input",{type:"text",value:V.productTypes,onChange:s=>G(m=>({...m,productTypes:s.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"e.g., Cotton, Polyester, Blends"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Target Audience"}),e.jsx("input",{type:"text",value:V.audience,onChange:s=>G(m=>({...m,audience:s.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"e.g., Fashion-conscious men, 25-45 years old"})]}),e.jsxs("button",{onClick:qt,disabled:U,className:"bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 transition-colors flex items-center gap-2 disabled:opacity-50",children:[U?e.jsx(le,{className:"w-4 h-4 animate-spin"}):e.jsx(be,{className:"w-4 h-4"}),"Generate Category Content"]})]}),n==="faq"&&e.jsxs("div",{className:"space-y-4 p-4 bg-blue-50 rounded-lg",children:[e.jsx("h3",{className:"text-lg font-semibold text-black",children:"E-commerce FAQ Generator"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Product/Category Name"}),e.jsx("input",{type:"text",value:b.name||V.categoryName,onChange:s=>{d(m=>({...m,name:s.target.value})),G(m=>({...m,categoryName:s.target.value}))},className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"e.g., iPhone 15 Pro or Men's T-Shirts"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Customer Intent"}),e.jsx("input",{type:"text",value:b.targetAudience,onChange:s=>d(m=>({...m,targetAudience:s.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"e.g., Buying first smartphone, Finding perfect fit"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Paste URL or content (optional) - works like general section"}),e.jsxs("div",{className:"relative",children:[e.jsx("textarea",{ref:ue,value:te,onChange:s=>{const m=s.target.value;Ie(m);const c=s.target;c.style.height="auto";const L=Math.max(36,Math.min(c.scrollHeight,150));c.style.height=`${L}px`},placeholder:"Paste URL or content here (same as general section)...",rows:1,className:"w-full bg-white border border-gray-300 rounded-lg px-3 py-2 pr-12 text-black text-sm placeholder-black focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200 resize-none scrollbar-hide",style:{minHeight:"36px",maxHeight:"150px",height:"auto",overflow:"auto",scrollbarWidth:"none",msOverflowStyle:"none"}}),e.jsxs("div",{className:"absolute right-2 bottom-2",children:[e.jsx("input",{type:"file",id:"ecom-file-upload",accept:".txt,.md,.doc,.docx",onChange:s=>{const m=s.target.files?.[0];if(m){const c=new FileReader;c.onload=L=>{const A=L.target?.result||"";Ie(A),setTimeout(()=>{if(ue.current){ue.current.style.height="auto";const I=Math.max(36,Math.min(ue.current.scrollHeight,150));ue.current.style.height=`${I}px`}},100)},c.readAsText(m)}},className:"hidden"}),e.jsx("label",{htmlFor:"ecom-file-upload",className:"cursor-pointer p-1.5 rounded-full transition-all duration-200 flex items-center justify-center bg-gray-100 hover:bg-gray-200 text-gray-600 hover:text-gray-800",title:"Upload file (.txt, .md, .doc, .docx)",children:e.jsx(Ct,{className:"w-4 h-4"})})]})]})]}),e.jsxs("button",{onClick:Dt,disabled:Z,className:"bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 transition-colors flex items-center gap-2 disabled:opacity-50",children:[Z?e.jsx(le,{className:"w-4 h-4 animate-spin"}):e.jsx(be,{className:"w-4 h-4"}),"Generate Questions"]})]})]}),n==="faq"&&g&&ee.length>0&&e.jsxs("div",{className:"space-y-4 p-4 bg-blue-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h3",{className:"text-lg font-semibold text-black flex items-center gap-2",children:[e.jsx(Be,{className:"w-5 h-5"}),"Generated Questions"]}),e.jsx("span",{className:"text-sm text-gray-600",children:"Select questions to generate answers"})]}),e.jsx("div",{className:"space-y-4",children:ee.map((s,m)=>{const c=x.find(L=>L.question===s);return e.jsx("div",{className:"bg-white rounded border p-4",children:e.jsxs("label",{className:"flex items-start gap-3 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:$.has(m),onChange:L=>{const A=new Set($);L.target.checked?A.add(m):A.delete(m),Y(A)},className:"mt-1 h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"text-gray-800 font-medium mb-2",children:["Q",m+1,": ",s]}),c&&e.jsxs("div",{className:"mt-3 p-3 bg-gray-50 rounded border border-gray-200",children:[e.jsx("div",{className:"text-sm text-gray-600 mb-2 font-medium",children:"Answer:"}),e.jsx("div",{className:"text-gray-700 text-sm leading-relaxed",children:c.answer})]})]})]})},m)})}),e.jsx("div",{className:"flex justify-start",children:e.jsxs("button",{onClick:Lt,disabled:y||$.size===0,className:"bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 transition-colors flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:[y?e.jsx(le,{className:"w-4 h-4 animate-spin"}):e.jsx(me,{className:"w-4 h-4"}),"Generate Answers"]})})]})]}),(!(n==="product"&&w&&w?.productContent||n==="category"&&w&&w?.categoryContent||n==="faq"&&w&&w?.faqs&&w?.faqs.length>0)?!1:(console.log("[E-commerce Display] Rendering content:",w),!0))&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(je,{className:"w-6 h-6 text-blue-600"}),e.jsx("h3",{className:"text-2xl font-bold text-black",children:"Generated E-commerce Content"})]}),n==="product"&&w?.productContent&&e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"bg-blue-50 p-6 rounded-lg",children:[e.jsxs("h4",{className:"text-lg font-semibold text-black mb-4 flex items-center gap-2",children:[e.jsx(Je,{className:"w-5 h-5"}),"Product Description"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h5",{className:"font-medium text-black mb-2",children:"Short Description"}),e.jsx("p",{className:"text-gray-700 bg-white p-3 rounded border",children:w?.productContent?.shortDescription})]}),e.jsxs("div",{children:[e.jsx("h5",{className:"font-medium text-black mb-2",children:"Long Description"}),e.jsx("div",{className:"text-gray-700 bg-white p-3 rounded border whitespace-pre-wrap",children:w?.productContent.longDescription})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("h5",{className:"font-medium text-black mb-2",children:"Key Features"}),e.jsx("ul",{className:"text-gray-700 bg-white p-3 rounded border",children:w?.productContent.features.map((s,m)=>e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx(me,{className:"w-4 h-4 text-green-500 mt-0.5 flex-shrink-0"}),s]},m))})]}),e.jsxs("div",{children:[e.jsx("h5",{className:"font-medium text-black mb-2",children:"Benefits"}),e.jsx("ul",{className:"text-gray-700 bg-white p-3 rounded border",children:w?.productContent.benefits.map((s,m)=>e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx(me,{className:"w-4 h-4 text-green-500 mt-0.5 flex-shrink-0"}),s]},m))})]})]}),e.jsxs("div",{children:[e.jsx("h5",{className:"font-medium text-black mb-2",children:"Comparison"}),e.jsx("div",{className:"text-gray-700 bg-white p-3 rounded border whitespace-pre-wrap",children:w?.productContent.comparison})]}),e.jsxs("div",{children:[e.jsx("h5",{className:"font-medium text-black mb-2",children:"Technical Specifications"}),e.jsx("div",{className:"bg-white p-3 rounded border",children:e.jsx("table",{className:"w-full text-sm",children:e.jsx("tbody",{children:Object.entries(w?.productContent.specs).map(([s,m])=>e.jsxs("tr",{className:"border-b border-gray-100",children:[e.jsx("td",{className:"font-medium text-gray-700 py-2 pr-4",children:s}),e.jsx("td",{className:"text-gray-600 py-2",children:m})]},s))})})})]}),e.jsxs("div",{children:[e.jsx("h5",{className:"font-medium text-black mb-2",children:"Use Cases"}),e.jsx("ul",{className:"text-gray-700 bg-white p-3 rounded border",children:w?.productContent.useCases.map((s,m)=>e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx(Be,{className:"w-4 h-4 text-blue-500 mt-0.5 flex-shrink-0"}),s]},m))})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("h5",{className:"font-medium text-black mb-2",children:"Keywords"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:w?.productContent.keywords.map((s,m)=>e.jsx("span",{className:"bg-blue-100 text-blue-800 px-2 py-1 rounded text-sm",children:s},m))})]}),e.jsxs("div",{children:[e.jsx("h5",{className:"font-medium text-black mb-2",children:"Image Alt Text"}),e.jsx("div",{className:"space-y-1",children:w?.productContent.altText.map((s,m)=>e.jsx("div",{className:"text-sm text-gray-600 bg-gray-50 p-2 rounded",children:s},m))})]})]}),e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[e.jsx("h5",{className:"font-medium text-black mb-2",children:"Meta Tags"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-700",children:"Title:"}),e.jsx("div",{className:"text-gray-600 bg-white p-2 rounded border mt-1",children:w?.productContent.metaTags.title})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-700",children:"Description:"}),e.jsx("div",{className:"text-gray-600 bg-white p-2 rounded border mt-1",children:w?.productContent.metaTags.description})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-700",children:"Keywords:"}),e.jsx("div",{className:"text-gray-600 bg-white p-2 rounded border mt-1",children:w?.productContent.metaTags.keywords})]})]})]})]})]})}),n==="category"&&w?.categoryContent&&e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"bg-blue-50 p-6 rounded-lg",children:[e.jsxs("h4",{className:"text-lg font-semibold text-black mb-4 flex items-center gap-2",children:[e.jsx(Oe,{className:"w-5 h-5"}),"Category Page Content"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h5",{className:"font-medium text-black mb-2",children:"Introduction"}),e.jsx("div",{className:"text-gray-700 bg-white p-3 rounded border whitespace-pre-wrap",children:w?.categoryContent.intro})]}),e.jsxs("div",{children:[e.jsx("h5",{className:"font-medium text-black mb-2",children:"Buying Guide"}),e.jsx("div",{className:"text-gray-700 bg-white p-3 rounded border whitespace-pre-wrap",children:w?.categoryContent.buyingGuide})]}),e.jsxs("div",{children:[e.jsx("h5",{className:"font-medium text-black mb-2",children:"Comparison Chart"}),e.jsx("div",{className:"text-gray-700 bg-white p-3 rounded border whitespace-pre-wrap",children:w?.categoryContent.comparisonChart})]}),e.jsxs("div",{children:[e.jsx("h5",{className:"font-medium text-black mb-2",children:"Internal Links"}),e.jsx("ul",{className:"text-gray-700 bg-white p-3 rounded border",children:w?.categoryContent.internalLinks.map((s,m)=>e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx(kt,{className:"w-4 h-4 text-blue-500 mt-0.5 flex-shrink-0"}),s]},m))})]})]})]})}),n==="faq"&&w?.faqs&&w?.faqs.length>0&&e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"bg-blue-50 p-6 rounded-lg",children:[e.jsxs("h4",{className:"text-lg font-semibold text-black mb-4 flex items-center gap-2",children:[e.jsx(Xe,{className:"w-5 h-5"}),"Generated FAQs"]}),e.jsx("div",{className:"space-y-4",children:w?.faqs.map((s,m)=>e.jsxs("div",{className:"bg-white p-4 rounded border",children:[e.jsxs("div",{className:"font-medium text-black mb-2",children:["Q: ",s.question]}),e.jsxs("div",{className:"text-gray-700",children:["A: ",s.answer]})]},m))})]})}),w?.seoRecommendations&&(n==="product"&&!!w?.productContent||n==="category"&&!!w?.categoryContent||n==="faq"&&!!(w?.faqs&&w?.faqs.length>0))&&e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"bg-yellow-50 p-6 rounded-lg",children:[e.jsxs("h4",{className:"text-lg font-semibold text-black mb-4 flex items-center gap-2",children:[e.jsx(be,{className:"w-5 h-5"}),"AI SEO Recommendations"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h5",{className:"font-medium text-black mb-2",children:"Schema Suggestions"}),e.jsx("ul",{className:"text-gray-700 bg-white p-3 rounded border",children:w?.seoRecommendations.schemaSuggestions.map((s,m)=>e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx(me,{className:"w-4 h-4 text-blue-600 mt-0.5 flex-shrink-0"}),e.jsx(me,{className:"w-4 h-4 text-blue-600 mt-0.5 flex-shrink-0"}),e.jsx(me,{className:"w-4 h-4 text-blue-600 mt-0.5 flex-shrink-0"}),s]},m))})]}),e.jsxs("div",{children:[e.jsxs("h5",{className:"font-medium text-black mb-2",children:["Content Depth Score: ",w?.seoRecommendations.contentDepthScore,"/100"]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-blue-600 h-2 rounded-full",style:{width:`${w?.seoRecommendations.contentDepthScore}%`}})})]}),e.jsxs("div",{children:[e.jsx("h5",{className:"font-medium text-black mb-2",children:"AI Optimization Tips"}),e.jsx("ul",{className:"text-gray-700 bg-white p-3 rounded border",children:w?.seoRecommendations.aiOptimizationTips.map((s,m)=>e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx(we,{className:"w-4 h-4 text-blue-500 mt-0.5 flex-shrink-0"}),s]},m))})]}),e.jsxs("div",{children:[e.jsx("h5",{className:"font-medium text-black mb-2",children:"Technical SEO Reminders"}),e.jsx("ul",{className:"text-gray-700 bg-white p-3 rounded border",children:w?.seoRecommendations.technicalSeoReminders.map((s,m)=>e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx(we,{className:"w-4 h-4 text-orange-500 mt-0.5 flex-shrink-0"}),s]},m))})]})]})]})})]})]})}),e.jsxs("div",{className:"w-80 space-y-6",children:[e.jsx("div",{className:"bg-white border border-gray-200 rounded-lg p-4 shadow-sm",children:e.jsxs("button",{onClick:()=>{if(pe(""),Ie(""),f([]),P([]),S(new Set),k([]),Y(new Set),xe(!1),ye(!1),_(!1),j(!1),ke(null),T(!1),C(!1),Se(null),t?.id){const s=oe(Ze,t.id),m=oe("pending_faq_generation",t.id),c=oe("generated_faqs",t.id);localStorage.removeItem(s),localStorage.removeItem(m),localStorage.removeItem(c);try{localStorage.removeItem(_e())}catch{}}ce.current&&(ce.current.style.height="36px")},className:"w-full bg-white text-black font-bold px-3 py-2 rounded-lg hover:bg-gray-50 transition-all duration-200 flex items-center gap-2 justify-start border border-blue-600 text-sm",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),"New Analysis"]})}),e.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4 shadow-sm",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx("svg",{className:"w-5 h-5 text-black",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),e.jsx("h3",{className:"text-lg font-semibold text-black",children:"History"})]}),e.jsxs("div",{className:"space-y-3 max-h-96 overflow-y-auto scrollbar-hide",style:{scrollbarWidth:"none",msOverflowStyle:"none"},children:[Pe.slice(0,50).map((s,m)=>e.jsxs("div",{className:"p-3 bg-gray-50 rounded-lg border border-gray-200 hover:border-gray-300 transition-all duration-200",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[s.type==="faq"?e.jsx("svg",{className:"w-4 h-4 text-black flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}):e.jsx("svg",{className:"w-4 h-4 text-gray-500 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1"})}),e.jsx("div",{className:"text-sm font-medium text-black truncate",children:s.name})]}),e.jsx("div",{className:"text-xs text-gray-500",children:new Date(s.timestamp).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]}),e.jsx("button",{onClick:()=>{const c=new Set(qe);c.has(s.id)?c.delete(s.id):c.add(s.id),Ge(c)},className:"p-2 bg-white border border-gray-300 rounded-lg text-gray-600 hover:text-gray-800 hover:bg-gray-50 transition-all duration-200",title:qe.has(s.id)?"Collapse":"Expand",children:qe.has(s.id)?e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 15l7-7 7 7"})}):e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})})]}),qe.has(s.id)&&e.jsx("div",{className:"mt-3 pt-3 border-t border-gray-200",children:s.type==="faq"?e.jsxs("div",{className:"space-y-3",children:[s.blogUrl&&e.jsxs("div",{className:"text-xs text-black bg-gray-50 p-2 rounded border border-gray-200",children:[e.jsx("strong",{children:"Source URL:"})," ",s.blogUrl]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"text-xs text-gray-600 font-medium",children:"Generated FAQs:"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>{pe(s.blogContent||""),X(s.questionProvider||"gemini"),F(s.questionModel||(s.questionProvider==="perplexity"?"sonar":s.questionProvider==="claude"?"claude-3-sonnet-20240229":"gemini-1.5-flash")),ot()},className:"p-2 bg-white border border-gray-300 rounded-lg text-black hover:text-gray-800 hover:bg-gray-50 transition-all duration-200",title:"Regenerate FAQs",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})}),e.jsx("button",{onClick:()=>{const c=s.qaData?.map(K=>({question:K.question,answer:K.answer}))||[],L=new Blob([JSON.stringify(c,null,2)],{type:"application/json"}),A=URL.createObjectURL(L),I=document.createElement("a");I.href=A,I.download=`faqs-${s.name.replace(/\s+/g,"-")}.json`,document.body.appendChild(I),I.click(),document.body.removeChild(I),URL.revokeObjectURL(A),W("FAQs downloaded successfully!")},className:"p-2 bg-white border border-gray-300 rounded-lg text-gray-600 hover:text-gray-800 hover:bg-gray-50 transition-all duration-200",title:"Download FAQs as JSON",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})}),e.jsx("button",{onClick:()=>lt(s.id),className:"p-2 bg-white border border-gray-300 rounded-lg text-red-600 hover:text-red-800 hover:bg-red-50 transition-all duration-200",title:"Delete session",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1 1v3M4 7h16"})})})]})]}),s.generatedQuestions&&s.generatedQuestions.length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"text-xs text-gray-600 font-medium",children:["Questions (",s.generatedQuestions.length,"):"]}),s.generatedQuestions.slice(0,5).map((c,L)=>{const A=s.qaData?.some(K=>K.question===c),I=s.qaData?.find(K=>K.question===c);return e.jsxs("div",{className:"p-1.5 bg-white rounded border border-gray-200",children:[e.jsxs("div",{className:"font-medium text-xs text-black leading-tight",children:["Q: ",c]}),A&&I?e.jsxs("div",{className:"text-xs text-gray-600 leading-tight mt-0.5",children:["A: ",I.answer]}):e.jsx("div",{className:"text-xs text-gray-500 mt-0.5",children:"(Answer not generated yet)"})]},L)}),s.generatedQuestions.length>5&&e.jsxs("div",{className:"text-xs text-gray-500",children:["+",s.generatedQuestions.length-5," more questions"]})]}),e.jsxs("div",{className:"text-xs text-gray-500",children:["Provider: ",s.questionProvider," | Model: ",s.questionModel]})]}):e.jsxs("div",{className:"space-y-3",children:[s.blogUrl&&e.jsxs("div",{className:"text-xs text-black bg-gray-50 p-2 rounded border border-gray-200",children:[e.jsx("strong",{children:"Source URL:"})," ",s.blogUrl]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"text-xs text-gray-600 font-medium",children:"Generated Q&A:"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>{pe(s.blogContent||""),X(s.questionProvider||"gemini"),F(s.questionModel||(s.questionProvider==="perplexity"?"sonar":s.questionProvider==="claude"?"claude-3-sonnet-20240229":"gemini-1.5-flash")),ot()},className:"p-2 bg-white border border-gray-300 rounded-lg text-black hover:text-gray-800 hover:bg-gray-50 transition-all duration-200",title:"Regenerate Q&A",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})}),e.jsx("button",{onClick:()=>{const c=s.qaData?.map(K=>({question:K.question,answer:K.answer}))||[],L=new Blob([JSON.stringify(c,null,2)],{type:"application/json"}),A=URL.createObjectURL(L),I=document.createElement("a");I.href=A,I.download=`qa-${s.name.replace(/\s+/g,"-")}.json`,document.body.appendChild(I),I.click(),document.body.removeChild(I),URL.revokeObjectURL(A),W("Q&A data downloaded successfully!")},className:"p-2 bg-white border border-gray-300 rounded-lg text-gray-600 hover:text-gray-800 hover:bg-gray-50 transition-all duration-200",title:"Download Q&A as JSON",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})}),e.jsx("button",{onClick:()=>lt(s.id),className:"p-2 bg-white border border-gray-300 rounded-lg text-red-600 hover:text-red-800 hover:bg-red-50 transition-all duration-200",title:"Delete session",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1 1v3M4 7h16"})})})]})]}),s.qaData?.slice(0,3).map((c,L)=>e.jsxs("div",{className:"p-2 bg-white rounded border border-gray-200",children:[e.jsxs("div",{className:"font-medium text-sm text-black mb-1",children:["Q: ",c.question]}),e.jsxs("div",{className:"text-xs text-gray-600",children:["A: ",c.answer]})]},L)),s.qaData&&s.qaData.length>3&&e.jsxs("div",{className:"text-xs text-gray-500",children:["+",s.qaData.length-3," more questions"]}),e.jsxs("div",{className:"text-xs text-gray-500",children:["Provider: ",s.questionProvider," | Model: ",s.questionModel]})]})})]},s.id)),Pe.length===0&&e.jsx("div",{className:"text-center text-gray-500 text-sm py-4",children:"No analysis history yet"})]})]})]}),e.jsx(vt,{message:Pt,onClose:()=>W(null),autoClose:!0,autoCloseDelay:3e3,type:Ft})]})}const Ls="llm_qa_sessions",$s="llm_qa_current_session",Is="llm_competitor_urls",qs=[{label:"Dashboard",icon:e.jsx(be,{}),path:"/overview"},{label:"Competitor Insight",icon:e.jsx(Ne,{}),path:"/ai-visibility-analysis"},{label:"Content Enhancement",icon:e.jsx(Le,{}),path:"/enhance-content"},{label:"Structure Analysis",icon:e.jsx(Be,{}),path:"/content-structure-analysis"},{label:"Ecom Content Analysis",icon:e.jsx(Ve,{}),path:"/ecommerce-content-analysis"},{label:"E-commerce AI",icon:e.jsx(je,{}),path:"/ecommerce-ai-visibility"},{label:"Settings",icon:e.jsx(as,{}),path:"/configuration"},{label:"History",icon:e.jsx(wt,{}),path:"/history"},{label:"Statistics",icon:e.jsx(Ve,{}),path:"/statistics"}];function Rs({isOpen:t,setIsOpen:o,onLogout:p,user:n,currentPath:i}){const x=fe(),f=h=>{x(h),o(!1)};return e.jsxs(e.Fragment,{children:[t&&e.jsx("div",{className:"fixed inset-0 bg-black/50 z-40 md:hidden",onClick:()=>o(!1)}),e.jsxs("aside",{className:`fixed md:static inset-y-0 left-0 z-50 bg-white w-64 min-h-screen flex flex-col border-r border-gray-200 shadow-lg transform transition-transform duration-300 md:transform-none sidebar-responsive ${t?"translate-x-0":"-translate-x-full"}`,children:[e.jsxs("div",{className:"flex items-center justify-between p-3 border-b border-primary/10 header-responsive",children:[e.jsxs("div",{className:"flex items-center gap-3 flex-1 min-w-0 logo-container",children:[e.jsx("div",{className:"w-8 h-8 bg-gradient-to-r from-primary to-accent rounded-lg flex items-center justify-center flex-shrink-0 logo-icon",children:e.jsx(be,{className:"w-5 h-5 text-white"})}),e.jsx("span",{className:"text-lg font-bold text-primary tracking-wide truncate logo-text",children:"kabini.ai"})]}),e.jsx("button",{className:"md:hidden text-gray-500 hover:text-gray-700 hover:bg-gray-100 transition-colors p-1.5 rounded-md flex items-center justify-center flex-shrink-0 ml-2",onClick:()=>o(!1),"aria-label":"Close menu",children:e.jsxs("div",{className:"relative w-5 h-5 flex items-center justify-center",children:[e.jsx("div",{className:"absolute w-4 h-0.5 bg-gray-600 rounded-full transform rotate-45"}),e.jsx("div",{className:"absolute w-4 h-0.5 bg-gray-600 rounded-full transform -rotate-45"})]})})]}),e.jsx("nav",{className:"flex-1 flex flex-col gap-1 mt-4 px-2 nav-responsive",children:qs.map(h=>{const P=i===h.path;return e.jsxs("button",{className:`nav-item-responsive ${P?"active":""}`,onClick:()=>f(h.path),children:[h.icon,h.label]},h.path)})}),e.jsxs("div",{className:"mt-auto user-profile-section",children:[e.jsxs("div",{className:"user-profile-info",children:[e.jsx("div",{className:"user-avatar",children:e.jsx(Ae,{})}),e.jsxs("div",{className:"user-details",children:[e.jsx("div",{className:"user-name",children:n?.displayName||n?.name||"User"}),e.jsx("div",{className:"user-email",children:n?.email||""})]})]}),e.jsxs("button",{className:"logout-button",onClick:p,children:[e.jsx(At,{}),"Logout"]})]})]})]})}function Qs({setIsOpen:t,onLogout:o}){return e.jsxs("header",{className:"w-full bg-white border-b border-primary/10 flex items-center justify-between px-3 sm:px-6 py-3 relative z-30 header-responsive",children:[e.jsxs("div",{className:"logo-container",children:[e.jsx("div",{className:"logo-icon bg-gradient-to-r from-primary to-accent rounded-lg",children:e.jsx(be,{className:"w-5 h-5 text-white"})}),e.jsx("span",{className:"logo-text text-xl font-extrabold tracking-wide",children:"kabini.ai"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{className:"md:hidden bg-black border border-black text-white px-2 py-1.5 rounded-lg text-sm font-medium hover:bg-gray-800 hover:border-gray-800 transition-all flex items-center gap-2",onClick:o,"aria-label":"Logout",children:[e.jsx(At,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Logout"})]}),e.jsx("button",{className:"block md:hidden text-primary hover:text-accent transition-colors p-2 rounded-lg hover:bg-gray-100 flex items-center justify-center border border-gray-200 bg-white",onClick:()=>t(!0),"aria-label":"Open menu",style:{minWidth:"44px",minHeight:"44px"},children:e.jsxs("div",{className:"relative w-6 h-6",children:[e.jsx("div",{className:"absolute w-5 h-1 bg-black rounded-full top-1 left-0.5"}),e.jsx("div",{className:"absolute w-5 h-1 bg-black rounded-full top-3 left-0.5"}),e.jsx("div",{className:"absolute w-5 h-1 bg-black rounded-full top-5 left-0.5"})]})})]})]})}function Us(){return e.jsxs("footer",{className:"w-full bg-white border-t border-primary/10 text-center text-primary py-3 text-sm",children:["© ",new Date().getFullYear()," kabini.ai. All rights reserved."]})}function yt(){return e.jsx(Ds,{})}function Ms(){const{isAuthenticated:t,isLoading:o,logout:p,user:n,refreshUser:i}=ze();console.log("[App] Authentication state:",{isAuthenticated:t,isLoading:o,hasUser:!!n,userEmail:n?.email}),l.useEffect(()=>{t&&!n&&!o&&(console.log("[App] Authenticated but no user data, forcing refresh..."),i())},[t,n,o,i]),l.useEffect(()=>{t&&n&&(console.log("[App] Clearing stale localStorage data..."),["llm_qa_current_session","structure_last_saved","overview_market_analysis"].forEach(R=>{try{localStorage.getItem(R)&&(console.log(`[App] Clearing stale localStorage key: ${R}`),localStorage.removeItem(R))}catch(C){console.warn(`[App] Could not clear ${R}:`,C)}}))},[t,n]);const[x,f]=l.useState(!1),h=tt(),[P]=ct(Ls,[]),[E]=ct($s,null);let S=[];try{const T=JSON.parse(localStorage.getItem(Is)||"[]");S=Array.from(new Set(T.map(R=>{try{return new URL(R).hostname.replace(/^www\./,"")}catch{return R}}))).filter(Boolean)}catch{}if(o)return e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-black via-gray-900 to-black",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto mb-4"}),e.jsx("p",{className:"text-primary font-medium",children:"Loading kabini.ai..."}),e.jsx("p",{className:"text-gray-400 text-sm mt-2",children:"Please wait while we verify your authentication..."})]})});if(t&&!n)return e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-black via-gray-900 to-black",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto mb-4"}),e.jsx("p",{className:"text-primary font-medium",children:"Loading user data..."}),e.jsx("p",{className:"text-gray-400 text-sm mt-2",children:"Please wait while we load your profile..."})]})});if(!t)return console.log("[App] User not authenticated, showing login page"),e.jsxs(dt,{children:[e.jsx(ae,{path:"/signup",element:e.jsx(bs,{})}),e.jsx(ae,{path:"/forgot-password",element:e.jsx(fs,{})}),e.jsx(ae,{path:"/reset-password",element:e.jsx(ys,{})}),e.jsx(ae,{path:"/verify-email",element:e.jsx(gs,{})}),e.jsx(ae,{path:"/test-notifications",element:e.jsx(Ts,{})}),e.jsx(ae,{path:"*",element:e.jsx(cs,{})})]});console.log("[App] User is authenticated, showing main app");const q=async()=>{try{await p()}catch(T){console.error("Logout error:",T)}};return e.jsxs("div",{className:"flex min-h-screen bg-white overflow-hidden",children:[e.jsx(Rs,{isOpen:x,setIsOpen:f,onLogout:q,user:n,currentPath:h.pathname}),e.jsxs("div",{className:"flex-1 flex flex-col min-h-screen overflow-hidden content-responsive",children:[e.jsx(Qs,{setIsOpen:f,onLogout:q}),e.jsx("main",{className:"flex-1 p-responsive-md overflow-x-hidden overflow-y-auto text-black bg-white main-content-responsive",children:e.jsx("div",{className:"main-content-container",children:e.jsxs(dt,{children:[e.jsx(ae,{path:"/overview",element:e.jsx(Ot,{})}),e.jsx(ae,{path:"/ai-visibility-analysis",element:e.jsx(us,{competitorDomains:S})}),e.jsx(ae,{path:"/qa-generation",element:e.jsx(yt,{})}),e.jsx(ae,{path:"/enhance-content",element:e.jsx(yt,{})}),e.jsx(ae,{path:"/content-structure-analysis",element:e.jsx(xs,{})}),e.jsx(ae,{path:"/ecommerce-content-analysis",element:e.jsx(Es,{})}),e.jsx(ae,{path:"/ecommerce-ai-visibility",element:e.jsx(ks,{storeId:"default"})}),e.jsx(ae,{path:"/configuration",element:e.jsx(vs,{questionProvider:"gemini",questionModel:"gemini-1.5-flash",onQuestionProviderChange:()=>{},onQuestionModelChange:()=>{},answerProvider:"gemini",answerModel:"gemini-1.5-flash",onAnswerProviderChange:()=>{},onAnswerModelChange:()=>{},questionCount:5,onQuestionCountChange:()=>{}})}),e.jsx(ae,{path:"/history",element:e.jsx(ms,{qaItems:P.flatMap(T=>T.qaData),onExport:ds})}),e.jsx(ae,{path:"/statistics",element:e.jsx(Bt,{sessions:P,currentSession:E})}),e.jsx(ae,{path:"/CloudFuzeLLMQA",element:e.jsx(mt,{to:"/overview",replace:!0})}),e.jsx(ae,{path:"/",element:e.jsx(mt,{to:"/overview",replace:!0})})]})})}),e.jsx(Us,{})]})]})}function Os(){return e.jsx(zt,{children:e.jsx(Ms,{})})}ns.createRoot(document.getElementById("root")).render(e.jsx(l.StrictMode,{children:e.jsx(Ht,{children:e.jsx(Os,{})})}));
