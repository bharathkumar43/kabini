import{j as e,f as St,u as tt,h as Ue,a as Ze,b as Xe,c as et,d as bt,s as rt,A as ms,e as ye,C as us,g as Tt,S as Kt,O as hs,i as gs,k as xs}from"./components-CaC6sSyR.js";import{r as n,u as qe,a as Ft,b as Wt,R as Yt,B as ps,c as $t,d as ke,N as Dt}from"./router-cMghrlxF.js";import{a as fs}from"./vendor-DavUf6mE.js";import{X as Et,l as wt,p as nt,q as ut,E as Ke,L as Pe,D as Oe,R as Pt,r as ys,s as Rt,t as qt,b as ht,u as Jt,v as vt,A as Zt,w as bs,x as ws,j as pt,a as Nt,F as Ge,P as Mt,y as Xt,N as es,e as Fe,z as It,M as vs,d as Qe,J as jt,K as ts,G as ss,O as js,Q as mt,V as Ns,W as as,U as Ss,f as Ot,Y as Ut,_ as Cs,$ as ks,a0 as As,k as Qt,a1 as Es,a2 as rs,h as Ps,m as Is,g as yt,Z as Je,a3 as ns}from"./ui-BrKuu7lB.js";(function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))s(l);new MutationObserver(l=>{for(const c of l)if(c.type==="childList")for(const h of c.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&s(h)}).observe(document,{childList:!0,subtree:!0});function y(l){const c={};return l.integrity&&(c.integrity=l.integrity),l.referrerPolicy&&(c.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?c.credentials="include":l.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function s(l){if(l.ep)return;l.ep=!0;const c=y(l);fetch(l.href,c)}})();var ft={},Bt;function Fs(){if(Bt)return ft;Bt=1;var t=fs();return ft.createRoot=t.createRoot,ft.hydrateRoot=t.hydrateRoot,ft}var Ls=Fs();const gt=({error:t,onClose:o,autoClose:y=!0,autoCloseDelay:s=5e3,type:l="error"})=>{const[c,h]=n.useState(!1);if(n.useEffect(()=>{if(t){if(console.log("ðŸ”” [ErrorNotification] Error received:",t),h(!0),y){const b=setTimeout(()=>{console.log("ðŸ”” [ErrorNotification] Auto-closing notification"),h(!1),setTimeout(o,300)},s);return()=>clearTimeout(b)}}else console.log("ðŸ”” [ErrorNotification] No error, hiding notification"),h(!1)},[t,y,s,o]),!t)return null;const T={error:{container:"bg-red-50 border-red-200",icon:"text-red-500",title:"text-red-800",text:"text-red-700",closeButton:"text-red-400 hover:text-red-600",progressBg:"bg-red-200",progressBar:"bg-red-500",titleText:"Authentication Error"},warning:{container:"bg-yellow-50 border-yellow-200",icon:"text-yellow-500",title:"text-yellow-800",text:"text-yellow-700",closeButton:"text-yellow-400 hover:text-yellow-600",progressBg:"bg-yellow-200",progressBar:"bg-yellow-500",titleText:"Warning"},info:{container:"bg-blue-50 border-blue-200",icon:"text-blue-500",title:"text-blue-800",text:"text-blue-700",closeButton:"text-blue-400 hover:text-blue-600",progressBg:"bg-blue-200",progressBar:"bg-blue-500",titleText:"Information"}}[l];return e.jsx("div",{className:"fixed top-4 right-4 z-50 max-w-sm w-full",children:e.jsx("div",{className:`transform transition-all duration-300 ease-in-out ${c?"translate-x-0 opacity-100 scale-100":"translate-x-full opacity-0 scale-95"}`,children:e.jsxs("div",{className:`border rounded-lg shadow-lg p-4 relative ${T.container}`,children:[e.jsx("button",{onClick:()=>{h(!1),setTimeout(o,300)},className:`absolute top-2 right-2 transition-colors focus:outline-none focus:ring-2 focus:ring-offset-2 rounded-full p-1 ${T.closeButton}`,"aria-label":"Close notification",children:e.jsx(Et,{className:"w-4 h-4"})}),e.jsxs("div",{className:"flex items-start gap-3 pr-6",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(wt,{className:`w-5 h-5 ${T.icon}`})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:`text-sm font-semibold mb-1 ${T.title}`,children:T.titleText}),e.jsx("p",{className:`text-sm leading-relaxed ${T.text}`,children:t})]})]}),y&&e.jsx("div",{className:`mt-3 h-1 rounded-full overflow-hidden ${T.progressBg}`,children:e.jsx("div",{className:`h-full rounded-full transition-all duration-300 ease-linear ${T.progressBar}`,style:{width:c?"0%":"100%",transitionDuration:`${s}ms`}})})]})})})},Lt=()=>{const t=n.useCallback((u,T)=>{const b=u.target,C=b.value,$=St(C);return $!==C?(b.value=$,T($),b.dispatchEvent(new Event("input",{bubbles:!0})),b.dispatchEvent(new Event("change",{bubbles:!0})),$):(T(C),C)},[]),o=n.useCallback((u,T)=>{u.preventDefault();const b=u.clipboardData.getData("text"),C=St(b),$=u.target;return $.value=C,T(C),$.dispatchEvent(new Event("input",{bubbles:!0})),C},[]),y=n.useCallback(u=>u.key==="Backspace"||u.key==="Delete"||u.key==="ArrowLeft"||u.key==="ArrowRight"||u.key==="ArrowUp"||u.key==="ArrowDown"||u.key==="Tab"||u.key==="Enter"||u.key==="Escape"||u.key==="Home"||u.key==="End"||u.key==="PageUp"||u.key==="PageDown"||u.key==="Shift"||u.key==="Control"||u.key==="Alt"||u.key==="Meta"?!0:(u.ctrlKey||u.metaKey||u.altKey)&&(u.key==="."||u.key===";"||u.key==="=")||u.key.length>1&&(u.key.includes("Emoji")||u.key.includes("emoji"))?(u.preventDefault(),!1):!0,[]),s=n.useCallback(u=>(u.preventDefault(),!1),[]),l=n.useCallback(u=>(u.preventDefault(),!1),[]),c=n.useCallback(u=>(u.preventDefault(),!1),[]),h=n.useCallback((u,T)=>{const b=u.target,C=b.value,$=St(C);return T($),$!==C&&(b.value=$,b.dispatchEvent(new Event("input",{bubbles:!0})),b.dispatchEvent(new Event("change",{bubbles:!0}))),$},[]);return{handleInputChange:t,handleInputChangeAggressive:h,handlePaste:o,handleKeyDown:y,handleCompositionStart:s,handleCompositionUpdate:l,handleCompositionEnd:c}},Ne={localPart:{minLength:1,maxLength:64,allowedChars:/^[a-zA-Z0-9._%+-]+$/,startEndRules:/^[a-zA-Z0-9].*[a-zA-Z0-9]$/,consecutiveDots:/\.{2,}/,consecutiveSpecial:/[._%+-]{2,}/},domain:{minLength:2,maxLength:63,allowedChars:/^[a-zA-Z0-9.-]+$/,startEndRules:/^[a-zA-Z0-9].*[a-zA-Z0-9]$/,consecutiveDots:/\.{2,}/,consecutiveHyphens:/-{2,}/,tldMinLength:2,tldMaxLength:10},overall:{maxLength:254}},os=t=>{const o=[],y=[];if(!t||typeof t!="string")return{isValid:!1,errors:["Email address is required"]};t.length>Ne.overall.maxLength&&o.push(`Email address is too long (maximum ${Ne.overall.maxLength} characters)`);const s=(t.match(/@/g)||[]).length;if(s===0?o.push("Email address must contain an @ symbol"):s>1&&o.push("Email address can only contain one @ symbol"),s!==1)return{isValid:!1,errors:o,suggestions:y};const[l,c]=t.split("@");return!l||l.length===0?o.push("Email address must have a local part (before @)"):$s(l,o,y),!c||c.length===0?o.push("Email address must have a domain part (after @)"):Ds(c,o,y),{isValid:o.length===0,errors:o,suggestions:y.length>0?y:void 0}},Ve=t=>t.toLowerCase().endsWith("@gmail.com")?Ts(t):os(t),Ts=t=>{const o=[],y=[];if(!t||typeof t!="string")return{isValid:!1,errors:["Email address is required"]};const s=t.split("@")[0];s.length<6&&o.push("Gmail local part must be at least 6 characters long"),s.length>30&&o.push("Gmail local part cannot exceed 30 characters"),(s.startsWith(".")||s.endsWith("."))&&o.push("Gmail local part must start and end with a letter or number"),/\.{2,}/.test(s)&&o.push("Gmail local part cannot contain consecutive dots");const l=os(t);return o.push(...l.errors),{isValid:o.length===0,errors:o,suggestions:y.length>0?y:void 0}},$s=(t,o,y)=>{t.length<Ne.localPart.minLength&&o.push(`Local part must be at least ${Ne.localPart.minLength} characters long`),t.length>Ne.localPart.maxLength&&o.push(`Local part cannot exceed ${Ne.localPart.maxLength} characters`),Ne.localPart.allowedChars.test(t)||(o.push("Local part can only contain letters, numbers, and the following characters: . _ % + -"),y.push("Remove any special characters that are not allowed")),Ne.localPart.startEndRules.test(t)||(o.push("Local part must start and end with a letter or number"),y.push("Ensure the local part starts and ends with a letter or number")),Ne.localPart.consecutiveDots.test(t)&&(o.push("Local part cannot contain consecutive dots"),y.push("Remove consecutive dots from the local part")),Ne.localPart.consecutiveSpecial.test(t)&&(o.push("Local part cannot contain consecutive special characters"),y.push("Remove consecutive special characters from the local part")),(t.toLowerCase()==="gmail"||t.toLowerCase()==="google")&&(o.push("This local part is not allowed by Gmail"),y.push("Choose a different local part for your email address")),["admin","administrator","postmaster","abuse","webmaster","support","info"].includes(t.toLowerCase())&&y.push("This local part might be reserved. Consider using a different one.")},Ds=(t,o,y)=>{t.length<Ne.domain.minLength&&o.push(`Domain must be at least ${Ne.domain.minLength} characters long`),t.length>Ne.domain.maxLength&&o.push(`Domain cannot exceed ${Ne.domain.maxLength} characters`),Ne.domain.allowedChars.test(t)||(o.push("Domain can only contain letters, numbers, dots, and hyphens"),y.push("Remove any special characters that are not allowed in the domain")),Ne.domain.startEndRules.test(t)||(o.push("Domain must start and end with a letter or number"),y.push("Ensure the domain starts and ends with a letter or number")),Ne.domain.consecutiveDots.test(t)&&(o.push("Domain cannot contain consecutive dots"),y.push("Remove consecutive dots from the domain")),Ne.domain.consecutiveHyphens.test(t)&&(o.push("Domain cannot contain consecutive hyphens"),y.push("Remove consecutive hyphens from the domain"));const s=t.split(".");if(s.length<2)o.push("Domain must have at least one dot (e.g., .com, .org)");else{const l=s[s.length-1];l.length<Ne.domain.tldMinLength&&o.push(`Top-level domain must be at least ${Ne.domain.tldMinLength} characters long`),l.length>Ne.domain.tldMaxLength&&o.push(`Top-level domain cannot exceed ${Ne.domain.tldMaxLength} characters`),/^[a-zA-Z]+$/.test(l)||(o.push("Top-level domain can only contain letters"),y.push("Ensure the top-level domain contains only letters (e.g., .com, .org)"))}(t.toLowerCase()==="localhost"||t.toLowerCase()==="test")&&(o.push("This domain is not valid for email addresses"),y.push("Use a real domain name for your email address"))},_e=(t,o)=>{if(o.isValid)return"";const y=o.errors[0];return{"Email address is required":"Please enter your email address","Email address must contain an @ symbol":"Please enter a valid email address","Email address can only contain one @ symbol":"Please enter a valid email address","Email address must have a local part (before @)":"Please enter a valid email address","Email address must have a domain part (after @)":"Please enter a valid email address","Local part must be at least 1 characters long":"Please enter a valid email address","Local part cannot exceed 64 characters":"Please enter a valid email address","Local part can only contain letters, numbers, and the following characters: . _ % + -":"Please enter a valid email address","Local part must start and end with a letter or number":"Please enter a valid email address","Local part cannot contain consecutive dots":"Please enter a valid email address","Local part cannot contain consecutive special characters":"Please enter a valid email address","Domain must be at least 2 characters long":"Please enter a valid email address","Domain cannot exceed 63 characters":"Please enter a valid email address","Domain can only contain letters, numbers, dots, and hyphens":"Please enter a valid email address","Domain must start and end with a letter or number":"Please enter a valid email address","Domain cannot contain consecutive dots":"Please enter a valid email address","Domain cannot contain consecutive hyphens":"Please enter a valid email address","Domain must have at least one dot (e.g., .com, .org)":"Please enter a valid email address","Top-level domain must be at least 2 characters long":"Please enter a valid email address","Top-level domain cannot exceed 10 characters":"Please enter a valid email address","Top-level domain can only contain letters":"Please enter a valid email address","Email address is too long (maximum 254 characters)":"Please enter a valid email address","Gmail local part must be at least 6 characters long":"Gmail addresses must be at least 6 characters before @","Gmail local part cannot exceed 30 characters":"Gmail addresses cannot exceed 30 characters before @","Gmail local part must start and end with a letter or number":"Gmail addresses must start and end with a letter or number"}[y]||"Please enter a valid email address"},ot=t=>{if(!t)return"";let o=t.trim().toLowerCase();return o=o.replace(/\s+/g,""),o},Rs=()=>{const[t,o]=n.useState({email:"",password:""}),[y,s]=n.useState(!1),[l,c]=n.useState(!1),[h,u]=n.useState({}),[T,b]=n.useState(null),[C,$]=n.useState(!0),R=qe(),q=Ft(),{login:L,error:O,clearError:D,isAuthenticated:P,user:_}=tt(),{handleInputChangeAggressive:ue,handlePaste:ee,handleKeyDown:le}=Lt();n.useEffect(()=>{o({email:"",password:""}),u({}),b(null),$(!0),q.state?.message&&(b(q.state.message),q.state.email&&o(m=>({...m,email:q.state.email})));const x=setTimeout(()=>{$(!1)},200);return()=>clearTimeout(x)},[q.state]),n.useEffect(()=>{O&&console.log("ðŸ” [Login] Error state changed:",O)},[O]),n.useEffect(()=>{P&&_&&(console.log("[Login] User is authenticated via AuthContext, redirecting to overview..."),R("/overview",{replace:!0}))},[R,P,_]),n.useEffect(()=>{const x=new URLSearchParams(window.location.search),m=x.has("code")||x.has("state")||x.has("error");m&&window.history.replaceState({},"","/login");const w=M=>{m&&(window.location.pathname==="/login"||window.location.pathname==="/")&&window.history.replaceState({},"","/login")};return window.addEventListener("popstate",w),()=>{window.removeEventListener("popstate",w)}},[]);const be=(x,m)=>{if(x==="email"){if(!m.trim())return"Please enter your email address";const w=Ve(m);return w.isValid?void 0:_e(m,w)}if(x==="password")return m.trim()?void 0:"Please enter your password"},ge=()=>{const x={},m=be("email",t.email),w=be("password",t.password);return m&&(x.email=m),w&&(x.password=w),u(x),Object.keys(x).length===0},fe=x=>{const{name:m,value:w}=x.target,M=be(m,w);u(Y=>({...Y,[m]:M}))},z=async x=>{if(x.preventDefault(),!l)try{if(u({}),b(null),!ge())return;c(!0),D();try{console.log("[Login] Attempting local login with:",{email:t.email,passwordLength:t.password?t.password.length:0}),await L("local",{email:t.email,password:t.password}),console.log("[Login] Local login successful")}catch(m){console.error("[Login] Local login error:",m);let w="Invalid credentials. Please check your email and password.";m&&typeof m=="object"&&(m.message&&typeof m.message=="string"?m.message.includes("Network")||m.message.includes("fetch")||m.message.includes("Failed to fetch")?w="Network error. Please check your connection and try again.":m.message.includes("timeout")||m.message.includes("Timeout")?w="Request timed out. Please try again.":m.message.includes("401")||m.message.includes("Unauthorized")?w="Invalid credentials. Please check your email and password.":m.message.includes("404")||m.message.includes("Not Found")?w="Account not found. Please check your email or sign up.":m.message.includes("500")||m.message.includes("Internal Server Error")?w="Server error. Please try again later.":m.message.includes("verify your email")&&(w=m.message):m.error&&typeof m.error=="string"&&(m.error.includes("Network")||m.error.includes("connection")?w="Network error. Please check your connection and try again.":m.error.includes("Invalid")||m.error.includes("credentials")?w="Invalid credentials. Please check your email and password.":m.error.includes("verify your email")&&(w=m.error))),b(w)}finally{c(!1)}}catch(m){console.error("[Login] Unexpected error during form submission:",m),b("An unexpected error occurred. Please try again."),c(!1)}},F=async()=>{if(!l){D(),b(null),c(!0);try{await L("google"),console.log("[Login] Google sign-in successful")}catch(x){console.error("[Login] Google sign-in error:",x);let m="Google sign-in failed. Please try again.";if(x&&typeof x=="object"&&x.message&&typeof x.message=="string")if(x.message.includes("cancelled")||x.message.includes("Cancelled")||x.message.includes("popup_closed_by_user")){c(!1);return}else x.message.includes("timed out")||x.message.includes("Timed out")?m="Google sign-in timed out. Please try again.":x.message.includes("Network")||x.message.includes("fetch")?m="Network error. Please check your connection and try again.":x.message.includes("access_denied")&&(m="Google sign-in was denied. Please try again.");b(m)}finally{c(!1)}}},k=async()=>{if(!l){D(),b(null),c(!0);try{console.log("[Login] Starting Microsoft sign-in..."),await L("microsoft"),console.log("[Login] Microsoft sign-in successful")}catch(x){console.error("[Login] Microsoft sign-in error:",x);let m="Microsoft sign-in failed. Please try again.";if(x&&typeof x=="object"&&x.message&&typeof x.message=="string")if(x.message.includes("cancelled")||x.message.includes("Cancelled")||x.message.includes("user_cancelled")){c(!1);return}else x.message.includes("timed out")||x.message.includes("Timed out")?m="Microsoft sign-in timed out. Please try again.":x.message.includes("Network")||x.message.includes("fetch")?m="Network error. Please check your connection and try again.":x.message.includes("access_denied")?m="Microsoft sign-in was denied. Please try again.":x.message.includes("invalid_client")&&(m="Microsoft sign-in configuration error. Please contact support.");b(m)}finally{c(!1)}}};return e.jsxs("div",{className:"min-h-screen flex items-center justify-center bg-gray-100 px-4 relative overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 bg-gray-200/30"}),e.jsx("div",{className:"absolute inset-0 bg-gray-300/20"}),e.jsx("div",{className:"absolute top-0 left-0 w-96 h-96 bg-gray-400/40 rounded-full blur-3xl -translate-x-1/2 -translate-y-1/2 animate-pulse"}),e.jsx("div",{className:"absolute bottom-0 right-0 w-[500px] h-[500px] bg-gray-500/40 rounded-full blur-3xl translate-x-1/2 translate-y-1/2 animate-pulse",style:{animationDelay:"1s"}}),e.jsx("div",{className:"absolute top-1/2 left-1/2 w-80 h-80 bg-gray-600/35 rounded-full blur-3xl -translate-x-1/2 -translate-y-1/2 animate-pulse",style:{animationDelay:"2s"}}),e.jsx("div",{className:"absolute top-1/4 right-1/4 w-32 h-32 bg-gradient-to-br from-cyan-300/30 to-blue-300/30 rounded-full blur-2xl animate-bounce",style:{animationDelay:"0.5s"}}),e.jsx("div",{className:"absolute bottom-1/4 left-1/4 w-24 h-24 bg-gradient-to-br from-purple-300/30 to-pink-300/30 rounded-full blur-2xl animate-bounce",style:{animationDelay:"1.5s"}}),e.jsx("div",{className:"absolute top-3/4 left-1/3 w-20 h-20 bg-gradient-to-br from-indigo-300/30 to-purple-300/30 rounded-full blur-2xl animate-bounce",style:{animationDelay:"2.5s"}}),e.jsx("div",{className:"absolute top-1/3 left-1/6 w-16 h-16 bg-gradient-to-br from-indigo-400/25 to-purple-400/25 rotate-45 blur-xl animate-spin",style:{animationDuration:"8s"}}),e.jsx("div",{className:"absolute bottom-1/3 right-1/6 w-20 h-20 bg-gradient-to-br from-blue-400/25 to-cyan-400/25 rotate-12 blur-xl animate-spin",style:{animationDuration:"12s",animationDirection:"reverse"}}),e.jsx("div",{className:"absolute top-1/6 right-1/3 w-12 h-12 bg-gradient-to-br from-pink-400/25 to-purple-400/25 rotate-30 blur-lg animate-spin",style:{animationDuration:"6s"}}),e.jsx("div",{className:"absolute top-1/5 left-1/5 w-8 h-8 bg-gradient-to-br from-cyan-400/20 to-blue-400/20 rounded-full blur-md animate-ping",style:{animationDelay:"0s"}}),e.jsx("div",{className:"absolute top-2/5 right-1/5 w-6 h-6 bg-gradient-to-br from-purple-400/20 to-pink-400/20 rounded-full blur-md animate-ping",style:{animationDelay:"1s"}}),e.jsx("div",{className:"absolute bottom-1/5 left-2/5 w-10 h-10 bg-gradient-to-br from-indigo-400/20 to-blue-400/20 rounded-full blur-md animate-ping",style:{animationDelay:"2s"}}),e.jsx("div",{className:"absolute bottom-2/5 right-2/5 w-7 h-7 bg-gradient-to-br from-cyan-400/20 to-indigo-400/20 rounded-full blur-md animate-ping",style:{animationDelay:"3s"}}),e.jsx("div",{className:"absolute top-0 left-1/2 w-64 h-64 bg-gradient-to-br from-blue-300/15 to-indigo-300/15 rounded-full blur-2xl animate-pulse",style:{animationDuration:"4s"}}),e.jsx("div",{className:"absolute bottom-0 left-1/4 w-48 h-48 bg-gradient-to-br from-purple-300/15 to-pink-300/15 rounded-full blur-2xl animate-pulse",style:{animationDuration:"6s",animationDelay:"1s"}}),e.jsxs("div",{className:"w-full max-w-lg mx-auto p-8 bg-white/90 backdrop-blur-md rounded-2xl shadow-2xl border border-white/30 relative z-10 bg-gradient-to-br from-white/95 via-white/90 to-white/95 auth-container",style:{backgroundColor:"white !important"},children:[e.jsxs("div",{className:"text-center mb-10",children:[e.jsx("div",{className:"w-24 h-24 bg-blue-600 rounded-2xl flex items-center justify-center mx-auto mb-6 shadow-lg",children:e.jsx(nt,{className:"w-12 h-12 text-white"})}),e.jsx("h1",{className:"text-4xl font-bold text-black mb-3",children:"Welcome to kabini.ai"}),e.jsx("p",{className:"text-gray-600 text-lg",children:"Sign in to your account to continue"})]}),e.jsxs("form",{onSubmit:z,className:"space-y-8",children:[e.jsxs("div",{style:{display:"none"},children:[e.jsx("input",{type:"text",name:"fake-email",autoComplete:"username"}),e.jsx("input",{type:"password",name:"fake-password",autoComplete:"current-password"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-bold text-gray-900 mb-3",children:["Email ",e.jsx("span",{className:"text-red-600",children:"*"})]}),e.jsx("input",{type:"email",name:"email",value:t.email,onChange:x=>ue(x,m=>{const w=ot(m);o(Y=>({...Y,email:w}));const M=Ve(w);M.isValid?u(Y=>({...Y,email:void 0})):u(Y=>({...Y,email:_e(w,M)}))}),onPaste:x=>ee(x,m=>{const w=ot(m);o(Y=>({...Y,email:w}));const M=Ve(w);M.isValid?u(Y=>({...Y,email:void 0})):u(Y=>({...Y,email:_e(w,M)}))}),onKeyDown:le,onCompositionStart:x=>x.preventDefault(),onCompositionUpdate:x=>x.preventDefault(),onCompositionEnd:x=>x.preventDefault(),onBlur:fe,required:!0,inputMode:"email",autoComplete:"off","data-form-type":"other","data-lpignore":"true",readOnly:C,"aria-invalid":!!h.email,"aria-describedby":h.email?"email-error":void 0,className:`w-full px-4 py-4 border-2 rounded-xl text-gray-900 placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-black focus:border-black transition-all ${h.email?"border-red-500 focus:ring-red-500 focus:border-red-500":"border-gray-300"}`,placeholder:"Enter your email address *"}),h.email&&e.jsxs("p",{id:"email-error",className:"mt-2 text-sm text-red-600 flex items-center gap-1",role:"alert","aria-live":"polite",children:[e.jsx("svg",{className:"w-4 h-4 flex-shrink-0",fill:"currentColor",viewBox:"0 0 20 20","aria-hidden":"true",children:e.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),h.email]})]}),e.jsxs("div",{className:"relative",children:[e.jsxs("label",{className:"block text-sm font-bold text-gray-900 mb-3",children:["Password ",e.jsx("span",{className:"text-red-600",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:y?"text":"password",name:"password",value:t.password,onChange:x=>ue(x,m=>{o(w=>({...w,password:m})),m.trim()?u(w=>({...w,password:void 0})):u(w=>({...w,password:"Please enter your password"}))}),onPaste:x=>ee(x,m=>{o(w=>({...w,password:m})),m.trim()?u(w=>({...w,password:void 0})):u(w=>({...w,password:"Please enter your password"}))}),onKeyDown:le,onCompositionStart:x=>x.preventDefault(),onCompositionUpdate:x=>x.preventDefault(),onCompositionEnd:x=>x.preventDefault(),required:!0,autoComplete:"new-password","data-form-type":"other","data-lpignore":"true",readOnly:C,"aria-invalid":!!h.password,"aria-describedby":h.password?"password-error":void 0,placeholder:"Enter your password *",className:`w-full px-4 py-4 border-2 rounded-xl text-gray-900 placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-black focus:border-black transition-all ${h.password?"border-red-500 focus:ring-red-500 focus:border-red-500":"border-gray-300"}`}),e.jsx("button",{type:"button",onClick:()=>s(!y),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600 transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 rounded","aria-label":y?"Hide password":"Show password",title:y?"Hide password":"Show password",children:y?e.jsx(ut,{className:"w-5 h-5"}):e.jsx(Ke,{className:"w-5 h-5"})})]}),h.password&&e.jsxs("p",{id:"password-error",className:"mt-2 text-sm text-red-600 flex items-center gap-1",role:"alert","aria-live":"polite",children:[e.jsx("svg",{className:"w-4 h-4 flex-shrink-0",fill:"currentColor",viewBox:"0 0 20 20","aria-hidden":"true",children:e.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),h.password]})]}),e.jsx("button",{type:"submit",className:"w-full bg-blue-600 text-white font-bold py-4 px-6 rounded-xl hover:bg-blue-700 transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2 shadow-lg transform hover:scale-[1.02]",disabled:l,children:l?e.jsx(Pe,{className:"w-5 h-5 animate-spin"}):"Sign In"})]}),e.jsxs("div",{className:"mt-6 text-center space-y-2",children:[e.jsx("div",{children:e.jsx("span",{onClick:()=>R("/forgot-password"),className:"text-sm text-black hover:text-gray-700 underline hover:no-underline transition-colors cursor-pointer",children:"Forgot your password?"})}),e.jsx("div",{children:e.jsx("span",{onClick:()=>R("/signup"),className:"text-sm text-black hover:text-gray-700 underline hover:no-underline transition-colors cursor-pointer",children:"Don't have an account? Sign up"})})]}),e.jsxs("div",{className:"mt-10 space-y-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-0 flex items-center",children:e.jsx("div",{className:"w-full border-t border-gray-300"})}),e.jsx("div",{className:"relative flex justify-center text-sm",children:e.jsx("span",{className:"px-2 bg-white text-gray-500",children:"Or continue with"})})]}),e.jsx("button",{onClick:F,disabled:l,className:"w-full bg-white border-2 border-grey-300 text-black font-semibold py-4 px-6 rounded-xl hover:bg-grey-50 hover:border-grey-400 hover:text-gray-700 transition-all flex items-center justify-center gap-4 disabled:opacity-50 disabled:cursor-not-allowed auth-popup",style:{backgroundColor:"white !important"},children:l?e.jsxs(e.Fragment,{children:[e.jsx(Pe,{className:"w-6 h-6 animate-spin"}),e.jsx("span",{children:"Signing in with Google..."})]}):e.jsxs(e.Fragment,{children:[e.jsx("img",{src:"/google.svg",alt:"Google",className:"w-6 h-6"}),"Sign in with Google"]})}),e.jsxs("button",{onClick:k,disabled:l,className:"w-full bg-white border-2 border-grey-300 text-black font-semibold py-4 px-6 rounded-xl hover:bg-grey-50 hover:border-grey-400 hover:text-gray-700 transition-all flex items-center justify-center gap-4 disabled:opacity-50 disabled:cursor-not-allowed auth-popup",style:{backgroundColor:"white !important"},children:[e.jsx("img",{src:"/microsoft.svg",alt:"Microsoft",className:"w-6 h-6"}),"Sign in with Microsoft"]})]})]}),e.jsx(gt,{error:T||(O&&typeof O=="string"?O:null),onClose:()=>{b(null),D()},autoClose:!0,autoCloseDelay:5e3})]})};function qs(t,o,y){const s=new Blob([t],{type:y}),l=URL.createObjectURL(s),c=document.createElement("a");c.href=l,c.download=o,document.body.appendChild(c),c.click(),document.body.removeChild(c),URL.revokeObjectURL(l)}function Ms({qaItems:t,onExport:o}){const[y,s]=n.useState([]),[l,c]=n.useState([]),[h,u]=n.useState([]),[T,b]=n.useState(new Set),[C,$]=n.useState(new Set),[R,q]=n.useState(0),[L,O]=n.useState({searchTerm:"",dateFilter:"all",specificDate:"",typeFilter:"all",statusFilter:"all",showFilters:!1,groupBy:"date",sortBy:"date",sortOrder:"desc"});n.useEffect(()=>{(async()=>{try{const i=await Ue.getHistoryItems();console.log("[History] Loaded items:",i.length,i);const S=i.filter(g=>g&&typeof g=="object"&&g.id&&g.type&&g.name&&g.timestamp);console.log("[History] Valid items:",S.length,S),s(S)}catch(i){console.error("[History] Error loading history items:",i),s([])}})()},[R]),n.useEffect(()=>{(async()=>{console.log("[History] Component mounted, loading initial history items");try{const i=await Ue.getHistoryItems();s(i)}catch(i){console.error("[History] Error loading initial history items:",i),s([])}})()},[]),n.useEffect(()=>{t&&t.length>0&&(console.log("[History] qaItems prop changed, syncing with history service"),q(a=>a+1))},[t]),n.useEffect(()=>{const a=g=>{g.key&&g.key.includes("comprehensive_history")&&(console.log("[History] Storage changed, refreshing history"),q(ae=>ae+1))},i=()=>{console.log("[History] New analysis event received, refreshing history"),q(g=>g+1)};window.addEventListener("new-analysis-created",i),window.addEventListener("storage",a);const S=async()=>{try{const g=await Ue.getHistoryItems();g.length!==y.length&&(console.log("[History] Item count changed on focus, refreshing history"),s(g))}catch(g){console.error("[History] Error checking history on focus:",g)}};return window.addEventListener("focus",S),()=>{window.removeEventListener("new-analysis-created",i),window.removeEventListener("storage",a),window.removeEventListener("focus",S)}},[y.length]);const D=n.useMemo(()=>{const a=new Set,i=new Set;return y.forEach(S=>{S.type&&a.add(S.type),S.status&&i.add(S.status)}),{types:Array.from(a).filter(Boolean).sort(),statuses:Array.from(i).filter(Boolean).sort()}},[y,R]);n.useEffect(()=>{console.log("[History] History items updated:",y.length,"items"),console.log("[History] History data:",y);let a=[...y];if(L.searchTerm&&(a=a.filter(i=>i.name.toLowerCase().includes(L.searchTerm.toLowerCase())||i.description?.toLowerCase().includes(L.searchTerm.toLowerCase())||i.type==="qa"&&i.sessionData.qaData.some(S=>S.question.toLowerCase().includes(L.searchTerm.toLowerCase())||S.answer.toLowerCase().includes(L.searchTerm.toLowerCase()))||i.type==="ai-visibility"&&i.company.toLowerCase().includes(L.searchTerm.toLowerCase()))),L.dateFilter!=="all"){const i=new Date,S=new Date;switch(L.dateFilter){case"today":S.setHours(0,0,0,0);break;case"week":S.setDate(i.getDate()-7);break;case"month":S.setMonth(i.getMonth()-1);break;case"year":S.setFullYear(i.getFullYear()-1);break;case"specific":if(L.specificDate){const g=new Date(L.specificDate);g.setHours(0,0,0,0);const ae=new Date(L.specificDate);ae.setHours(23,59,59,999),a=a.filter(re=>{const X=new Date(re.timestamp);return X>=g&&X<=ae})}break}L.dateFilter!=="specific"&&(a=a.filter(g=>new Date(g.timestamp)>=S))}L.typeFilter!=="all"&&(a=a.filter(i=>i.type===L.typeFilter)),L.statusFilter!=="all"&&(a=a.filter(i=>i.status===L.statusFilter)),a.sort((i,S)=>{let g,ae;switch(L.sortBy){case"date":g=new Date(i.timestamp).getTime(),ae=new Date(S.timestamp).getTime();break;case"name":g=i.name.toLowerCase(),ae=S.name.toLowerCase();break;case"type":g=i.type,ae=S.type;break;case"status":g=i.status,ae=S.status;break;default:g=new Date(i.timestamp).getTime(),ae=new Date(S.timestamp).getTime()}return L.sortOrder==="asc"?g>ae?1:-1:g<ae?1:-1}),console.log("[History] Filtered items:",a.length,"items"),c(a)},[y,L,R]),n.useEffect(()=>{const a=[],i=new Map;l.forEach(S=>{let g="";switch(L.groupBy){case"date":const ae=new Date(S.timestamp);g=ae.toDateString(),ae.toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"});break;case"type":g=S.type,ue(S.type);break;case"status":g=S.status,S.status.charAt(0).toUpperCase()+S.status.slice(1);break}i.has(g)||i.set(g,[]),i.get(g).push(S)}),i.forEach((S,g)=>{let ae=g;L.groupBy==="date"?ae=new Date(g).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"}):L.groupBy==="type"?ae=ue(g):L.groupBy==="status"&&(ae=g.charAt(0).toUpperCase()+g.slice(1)),a.push({groupKey:g,groupTitle:ae,groupType:L.groupBy,items:S,totalItems:S.length,dateRange:L.groupBy==="date"?g:void 0})}),a.sort((S,g)=>L.groupBy==="date"?new Date(g.groupKey).getTime()-new Date(S.groupKey).getTime():S.groupTitle.localeCompare(g.groupTitle)),u(a)},[l,L.groupBy,R]);const P=a=>{const i=new Set(T);i.has(a)?i.delete(a):i.add(a),b(i)},_=a=>{const i=new Set(C);i.has(a)?i.delete(a):i.add(a),$(i)},ue=a=>{if(!a)return"Unknown";switch(a){case"qa":return"Q&A Sessions";case"ai-visibility":return"AI Visibility Analysis";case"content-analysis":return"Content Analysis";case"structure-analysis":return"Structure Analysis";default:return a}},ee=a=>{switch(a){case"completed":return"text-green-600 bg-green-100";case"in-progress":return"text-yellow-600 bg-yellow-100";case"failed":return"text-red-600 bg-red-100";default:return"text-gray-600 bg-gray-100"}},le=a=>{try{if(!a||!a.type)return console.error("[History] Invalid item:",a),e.jsx("div",{className:"text-red-500",children:"Invalid item data"});switch(a.type){case"qa":return be(a);case"ai-visibility":return ge(a);case"content-analysis":return fe(a);case"structure-analysis":return z(a);default:return e.jsxs("div",{className:"text-orange-500",children:["Unknown item type: ",a.type]})}}catch(i){return console.error("[History] Error rendering item:",i,a),e.jsxs("div",{className:"text-red-500",children:["Error rendering item: ",i.message]})}},be=a=>e.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 bg-gray-50",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-blue-500 rounded-full flex items-center justify-center",children:e.jsx(Ge,{className:"h-4 w-4 text-white"})}),e.jsxs("div",{children:[e.jsx("div",{className:"font-bold text-black",children:a.name}),e.jsx("div",{className:"text-xs text-grey-600",children:M(a.timestamp)}),e.jsxs("div",{className:"text-xs text-black",children:[a.sessionData.qaData.length," Q&A pairs"]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${ee(a.status)}`,children:a.status}),e.jsx("input",{type:"checkbox",checked:C.has(a.id),onChange:()=>_(a.id),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"})]})]}),e.jsxs("div",{className:"space-y-3",children:[a.sessionData.qaData.slice(0,3).map((i,S)=>e.jsxs("div",{className:"bg-white rounded-lg p-3 border border-gray-200",children:[e.jsxs("div",{className:"font-semibold text-gray-900 mb-2",children:["Q",S+1,": ",i.question]}),i.answer&&e.jsxs("div",{className:"text-sm text-gray-700 mb-2",children:[i.answer.substring(0,100),"..."]}),e.jsxs("div",{className:"flex gap-2 text-xs text-gray-500",children:[e.jsxs("span",{children:["Accuracy: ",i.accuracy||"N/A"]}),e.jsxs("span",{children:["Sentiment: ",i.sentiment||"N/A"]}),e.jsxs("span",{children:["Cost: $",(i.cost||0).toFixed(4)]})]})]},S)),a.sessionData.qaData.length>3&&e.jsxs("div",{className:"text-center text-sm text-gray-500",children:["+",a.sessionData.qaData.length-3," more Q&A pairs"]})]}),e.jsxs("div",{className:"flex gap-2 mt-4",children:[e.jsxs("button",{onClick:()=>k(a.id),className:"bg-blue-600 text-white px-3 py-1 rounded text-sm hover:bg-blue-700 transition flex items-center gap-1",children:[e.jsx(Oe,{className:"h-3 w-3"}),"JSON"]}),e.jsxs("button",{onClick:()=>x(a.id),className:"bg-green-600 text-white px-3 py-1 rounded text-sm hover:bg-green-700 transition flex items-center gap-1",children:[e.jsx(Oe,{className:"h-3 w-3"}),"CSV"]}),e.jsxs("button",{onClick:()=>m(a.id),className:"bg-red-600 text-white px-3 py-1 rounded text-sm hover:bg-red-700 transition flex items-center gap-1",children:[e.jsx(pt,{className:"h-3 w-3"}),"Delete"]})]})]}),ge=a=>!a.analysis||!a.analysis.competitors?e.jsxs("div",{className:"border border-red-200 rounded-lg p-4 bg-red-50",children:[e.jsx("div",{className:"text-red-600",children:"Invalid AI Visibility data structure"}),e.jsx("div",{className:"text-xs text-red-500 mt-2",children:"Missing analysis or competitors data"})]}):e.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 bg-gray-50",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-purple-500 rounded-full flex items-center justify-center",children:e.jsx(Ke,{className:"h-4 w-4 text-white"})}),e.jsxs("div",{children:[e.jsx("div",{className:"font-bold text-black",children:a.name}),e.jsx("div",{className:"text-xs text-grey-600",children:M(a.timestamp)}),e.jsxs("div",{className:"text-xs text-purple-600",children:[a.analysis.competitors?.length||0," competitors analyzed"]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${ee(a.status)}`,children:a.status}),e.jsx("input",{type:"checkbox",checked:C.has(a.id),onChange:()=>_(a.id),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"bg-white rounded-lg p-3 border border-gray-200",children:[e.jsxs("div",{className:"font-semibold text-gray-900 mb-2",children:["Company: ",a.company]}),a.industry&&e.jsxs("div",{className:"text-sm text-gray-600 mb-2",children:["Industry: ",a.industry]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs",children:[e.jsxs("div",{children:["Top Competitor: ",a.analysis.summary?.topCompetitor||"N/A"]}),e.jsxs("div",{children:["Avg Score: ",a.analysis.summary?.averageVisibilityScore?.toFixed(1)||"N/A"]})]})]}),e.jsxs("div",{className:"space-y-2",children:[a.analysis.competitors.slice(0,3).map((i,S)=>e.jsxs("div",{className:"bg-white rounded-lg p-2 border border-gray-200",children:[e.jsx("div",{className:"font-medium text-sm",children:i.name}),e.jsxs("div",{className:"text-xs text-gray-600",children:["Avg Score: ",i.visibilityScores?.average?.toFixed(1)||"N/A"]})]},S)),a.analysis.competitors.length>3&&e.jsxs("div",{className:"text-center text-sm text-gray-500",children:["+",a.analysis.competitors.length-3," more competitors"]})]})]}),e.jsxs("div",{className:"flex gap-2 mt-4",children:[e.jsxs("button",{onClick:()=>k(a.id),className:"bg-blue-600 text-white px-3 py-1 rounded text-sm hover:bg-blue-700 transition flex items-center gap-1",children:[e.jsx(Oe,{className:"h-3 w-3"}),"JSON"]}),e.jsxs("button",{onClick:()=>x(a.id),className:"bg-green-600 text-white px-3 py-1 rounded text-sm hover:bg-green-700 transition flex items-center gap-1",children:[e.jsx(Oe,{className:"h-3 w-3"}),"CSV"]}),e.jsxs("button",{onClick:()=>m(a.id),className:"bg-red-600 text-white px-3 py-1 rounded text-sm hover:bg-red-700 transition flex items-center gap-1",children:[e.jsx(pt,{className:"h-3 w-3"}),"Delete"]})]})]}),fe=a=>a.analysis?e.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 bg-gray-50",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-green-500 rounded-full flex items-center justify-center",children:e.jsx(Nt,{className:"h-4 w-4 text-white"})}),e.jsxs("div",{children:[e.jsx("div",{className:"font-bold text-black",children:a.name}),e.jsx("div",{className:"text-xs text-grey-600",children:M(a.timestamp)}),e.jsxs("div",{className:"text-xs text-green-600",children:["SEO Score: ",a.analysis?.seoScore||"N/A","/100"]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${ee(a.status)}`,children:a.status}),e.jsx("input",{type:"checkbox",checked:C.has(a.id),onChange:()=>_(a.id),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"})]})]}),e.jsxs("div",{className:"bg-white rounded-lg p-3 border border-gray-200",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold text-gray-900",children:"SEO Score"}),e.jsx("div",{className:"text-2xl font-bold text-green-600",children:a.analysis?.seoScore||"N/A"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold text-gray-900",children:"Readability"}),e.jsx("div",{className:"text-2xl font-bold text-black",children:a.analysis?.readabilityScore||"N/A"})]})]}),a.analysis?.suggestions?.length>0&&e.jsxs("div",{className:"mt-3",children:[e.jsx("div",{className:"font-semibold text-gray-900 mb-2",children:"Suggestions"}),e.jsxs("div",{className:"space-y-1",children:[a.analysis.suggestions.slice(0,3).map((i,S)=>e.jsxs("div",{className:"text-xs text-gray-600",children:["â€¢ ",i.description]},S)),a.analysis.suggestions.length>3&&e.jsxs("div",{className:"text-xs text-gray-500",children:["+",a.analysis.suggestions.length-3," more suggestions"]})]})]})]}),e.jsxs("div",{className:"flex gap-2 mt-4",children:[e.jsxs("button",{onClick:()=>k(a.id),className:"bg-blue-600 text-white px-3 py-1 rounded text-sm hover:bg-blue-700 transition flex items-center gap-1",children:[e.jsx(Oe,{className:"h-3 w-3"}),"JSON"]}),e.jsxs("button",{onClick:()=>x(a.id),className:"bg-green-600 text-white px-3 py-1 rounded text-sm hover:bg-green-700 transition flex items-center gap-1",children:[e.jsx(Oe,{className:"h-3 w-3"}),"CSV"]}),e.jsxs("button",{onClick:()=>m(a.id),className:"bg-red-600 text-white px-3 py-1 rounded text-sm hover:bg-red-700 transition flex items-center gap-1",children:[e.jsx(pt,{className:"h-3 w-3"}),"Delete"]})]})]}):e.jsxs("div",{className:"border border-red-200 rounded-lg p-4 bg-red-50",children:[e.jsx("div",{className:"text-red-600",children:"Invalid Content Analysis data structure"}),e.jsx("div",{className:"text-xs text-red-500 mt-2",children:"Missing analysis data"})]}),z=a=>e.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 bg-gray-50",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-orange-500 rounded-full flex items-center justify-center",children:e.jsx(ws,{className:"h-4 w-4 text-white"})}),e.jsxs("div",{children:[e.jsx("div",{className:"font-bold text-black",children:a.name}),e.jsx("div",{className:"text-xs text-grey-600",children:M(a.timestamp)}),e.jsxs("div",{className:"text-xs text-orange-600",children:[a.analysis.suggestions?.length||0," suggestions"]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${ee(a.status)}`,children:a.status}),e.jsx("input",{type:"checkbox",checked:C.has(a.id),onChange:()=>_(a.id),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"})]})]}),e.jsxs("div",{className:"bg-white rounded-lg p-3 border border-gray-200",children:[a.analysis.geoScoreTotal!==void 0||a.analysis.contentQualityScoreTotal!==void 0?e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm mb-4",children:[a.analysis.geoScoreTotal!==void 0&&e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold text-gray-900",children:"GEO Score"}),e.jsxs("div",{className:"text-xl font-bold text-red-600",children:[a.analysis.geoScoreTotal,"/100"]}),e.jsx("div",{className:"text-xs text-gray-600",children:"AI visibility & search optimization"})]}),a.analysis.contentQualityScoreTotal!==void 0&&e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold text-gray-900",children:"Content Quality"}),e.jsxs("div",{className:"text-xl font-bold text-orange-600",children:[a.analysis.contentQualityScoreTotal,"/100"]}),e.jsx("div",{className:"text-xs text-gray-600",children:"Human/editorial score"})]})]}):null,e.jsxs("div",{className:"grid grid-cols-4 gap-2 text-xs text-gray-600 mb-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:a.analysis.wordCount||a.analysis.metadata?.wordCount||0}),e.jsx("div",{children:"Words"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:a.analysis.readingTime||a.analysis.metadata?.readingTime||1}),e.jsx("div",{children:"Min Read"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:a.analysis.suggestionsCount||a.analysis.suggestions?.length||0}),e.jsx("div",{children:"Suggestions"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:(a.analysis.language||a.analysis.metadata?.language||"en").toUpperCase()}),e.jsx("div",{children:"Language"})]})]}),a.analysis.suggestions&&a.analysis.suggestions.length>0&&e.jsxs("div",{className:"mt-3",children:[e.jsxs("div",{className:"font-semibold text-gray-900 mb-2",children:["Top Suggestions (",a.analysis.suggestions.length," total)"]}),e.jsxs("div",{className:"space-y-2",children:[a.analysis.suggestions.slice(0,5).map((i,S)=>e.jsxs("div",{className:"bg-gray-50 rounded p-2 border-l-4 border-blue-500",children:[e.jsxs("div",{className:"text-xs text-gray-600 font-medium mb-1",children:[i.type.charAt(0).toUpperCase()+i.type.slice(1)," â€¢ ",i.priority]}),e.jsx("div",{className:"text-xs text-gray-800",children:i.description}),i.impact&&e.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Impact: ",i.impact]})]},S)),a.analysis.suggestions.length>5&&e.jsxs("div",{className:"text-center text-xs text-gray-500 bg-gray-100 rounded p-2",children:["+",a.analysis.suggestions.length-5," more suggestions available"]})]})]})]}),e.jsxs("div",{className:"flex gap-2 mt-4",children:[e.jsxs("button",{onClick:()=>k(a.id),className:"bg-blue-600 text-white px-3 py-1 rounded text-sm hover:bg-blue-700 transition flex items-center gap-1",children:[e.jsx(Oe,{className:"h-3 w-3"}),"JSON"]}),e.jsxs("button",{onClick:()=>x(a.id),className:"bg-green-600 text-white px-3 py-1 rounded text-sm hover:bg-green-700 transition flex items-center gap-1",children:[e.jsx(Oe,{className:"h-3 w-3"}),"CSV"]}),e.jsxs("button",{onClick:()=>m(a.id),className:"bg-red-600 text-white px-3 py-1 rounded text-sm hover:bg-red-700 transition flex items-center gap-1",children:[e.jsx(pt,{className:"h-3 w-3"}),"Delete"]})]})]}),F=()=>{const a=C.size>0?l.filter(re=>C.has(re.id)):l;let i="";a.forEach(re=>{switch(re.type){case"qa":const X=re;i+=`
=== Q&A SESSION: ${X.name} ===
`,i+=`Session ID,${X.id}
`,i+=`Timestamp,${new Date(X.timestamp).toISOString()}
`,i+=`Model,${X.sessionData.model}
`,i+=`Total Questions,${X.sessionData.qaData.length}
`,i+=`Total Cost,${X.sessionData.statistics.totalCost}
`,i+=`Average Accuracy,${X.sessionData.statistics.avgAccuracy}%
`,i+=`Blog Content,"${X.sessionData.blogContent.replace(/"/g,'""')}"
`,i+=`
Question,Answer,Accuracy,Sentiment,Geo Score,Citation Likelihood,Input Tokens,Output Tokens,Total Tokens,Cost
`,X.sessionData.qaData.forEach((ie,De)=>{i+=`"${ie.question.replace(/"/g,'""')}","${ie.answer.replace(/"/g,'""')}",${ie.accuracy}%,${ie.sentiment},${ie.geoScore},${ie.citationLikelihood},${ie.inputTokens},${ie.outputTokens},${ie.totalTokens},$${ie.cost}
`});break;case"ai-visibility":const he=re;i+=`
=== AI VISIBILITY ANALYSIS: ${he.name} ===
`,i+=`Company,${he.company}
`,i+=`Industry,${he.industry||"N/A"}
`,i+=`Timestamp,${new Date(he.timestamp).toISOString()}
`,i+=`Overall Score,${he.analysis.overallScore}
`,i+=`Content Quality,${he.analysis.contentQuality}
`,i+=`Technical SEO,${he.analysis.technicalSEO}
`,i+=`User Experience,${he.analysis.userExperience}
`,i+=`Competitive Position,${he.analysis.competitivePosition}
`,i+=`
Competitors Found:
`,i+=`Competitor Name,Website,Relevance Score,Strengths,Weaknesses
`,he.analysis.competitors.forEach(ie=>{i+=`"${ie.name}","${ie.website}",${ie.relevanceScore},"${ie.strengths.join("; ").replace(/"/g,'""')}","${ie.weaknesses.join("; ").replace(/"/g,'""')}"
`}),i+=`
Recommendations:
`,i+=`Priority,Recommendation,Impact,Effort
`,he.analysis.recommendations.forEach(ie=>{i+=`${ie.priority},"${ie.recommendation.replace(/"/g,'""')}",${ie.impact},${ie.effort}
`});break;case"content-analysis":const te=re;i+=`
=== CONTENT ANALYSIS: ${te.name} ===
`,i+=`URL,${te.url||"N/A"}
`,i+=`Timestamp,${new Date(te.timestamp).toISOString()}
`,i+=`SEO Score,${te.analysis.seoScore}
`,i+=`Readability Score,${te.analysis.readabilityScore}
`,i+=`Content Length,${te.analysis.contentLength} words
`,i+=`Keyword Density,${te.analysis.keywordDensity}%
`,i+=`
Analyzed Content:
`,i+=`"${te.content.replace(/"/g,'""')}"
`,i+=`
Suggestions:
`,i+=`Category,Suggestion,Priority
`,te.analysis.suggestions.forEach(ie=>{i+=`${ie.category},"${ie.suggestion.replace(/"/g,'""')}",${ie.priority}
`});break;case"structure-analysis":const U=re;i+=`
=== STRUCTURE ANALYSIS: ${U.name} ===
`,i+=`Timestamp,${new Date(U.timestamp).toISOString()}
`,i+=`Original Content Length,${U.originalContent.length} characters
`,i+=`Structured Content Length,${U.structuredContent.length} characters
`,i+=`
Analysis Scores:
`,U.analysis.geoScoreTotal!==void 0&&(i+=`GEO Score,${U.analysis.geoScoreTotal}/100
`),U.analysis.contentQualityScoreTotal!==void 0&&(i+=`Content Quality Score,${U.analysis.contentQualityScoreTotal}/100
`),i+=`
Content Metadata:
`,i+=`Title,${U.analysis.metadata.title}
`,i+=`Description,${U.analysis.metadata.description}
`,i+=`Keywords,"${U.analysis.metadata.keywords.join(", ")}"
`,i+=`Author,${U.analysis.metadata.author}
`,i+=`Publish Date,${U.analysis.metadata.publishDate}
`,i+=`Last Modified,${U.analysis.metadata.lastModified}
`,i+=`Reading Time,${U.analysis.metadata.readingTime} minutes
`,i+=`Word Count,${U.analysis.metadata.wordCount}
`,i+=`Language,${U.analysis.metadata.language}
`,i+=`
Original Content:
`,i+=`"${U.originalContent.replace(/"/g,'""')}"
`,i+=`
Structured Content:
`,i+=`"${U.structuredContent.replace(/"/g,'""')}"
`,i+=`
Structure Suggestions:
`,i+=`Type,Priority,Description,Implementation,Impact
`,U.analysis.suggestions.forEach(ie=>{i+=`${ie.type},${ie.priority},"${ie.description.replace(/"/g,'""')}","${ie.implementation.replace(/"/g,'""')}","${ie.impact.replace(/"/g,'""')}"
`});break;default:i+=`
=== UNKNOWN TYPE: ${re.name} ===
`,i+=`ID,${re.id}
`,i+=`Type,${re.type}
`,i+=`Status,${re.status}
`,i+=`Timestamp,${new Date(re.timestamp).toISOString()}
`,i+=`Description,${re.description||"N/A"}
`}i+=`
`+"=".repeat(80)+`
`});const S=`COMPREHENSIVE HISTORY EXPORT
`,g=`Export Date: ${new Date().toISOString()}
`,ae=`Total Items: ${a.length}
`;o(S+g+ae+i,"comprehensive-history-detailed.csv","text/csv")},k=a=>{console.log("[History] Downloading item:",a);try{const i=Ue.exportHistoryItem(a);i&&i.content?(console.log("[History] Export data:",i),o(i.content,i.filename,i.mimeType)):(console.error("[History] No export data found for item:",a),alert("No data found for this item. It might be sample data or corrupted."))}catch(i){console.error("[History] Error downloading item:",i),alert("Error downloading item. Please try again.")}},x=a=>{console.log("[History] Downloading item as CSV:",a);const S=Ue.getHistoryItems().find(re=>re.id===a);if(!S){alert("Item not found!");return}let g="";switch(S.type){case"qa":const re=S;g+=`Q&A Session Export
`,g+=`Session Name,${re.name}
`,g+=`Session ID,${re.id}
`,g+=`Timestamp,${new Date(re.timestamp).toISOString()}
`,g+=`Model,${re.sessionData.model}
`,g+=`Total Questions,${re.sessionData.qaData.length}
`,g+=`Total Cost,${re.sessionData.statistics.totalCost}
`,g+=`Average Accuracy,${re.sessionData.statistics.avgAccuracy}%
`,g+=`Blog Content,"${re.sessionData.blogContent.replace(/"/g,'""')}"

`,g+=`Question,Answer,Accuracy,Sentiment,Geo Score,Citation Likelihood,Input Tokens,Output Tokens,Total Tokens,Cost
`,re.sessionData.qaData.forEach((U,ie)=>{g+=`"${U.question.replace(/"/g,'""')}","${U.answer.replace(/"/g,'""')}",${U.accuracy}%,${U.sentiment},${U.geoScore},${U.citationLikelihood},${U.inputTokens},${U.outputTokens},${U.totalTokens},$${U.cost}
`});break;case"ai-visibility":const X=S;g+=`AI Visibility Analysis Export
`,g+=`Analysis Name,${X.name}
`,g+=`Company,${X.company}
`,g+=`Industry,${X.industry||"N/A"}
`,g+=`Timestamp,${new Date(X.timestamp).toISOString()}
`,g+=`Overall Score,${X.analysis.overallScore}
`,g+=`Content Quality,${X.analysis.contentQuality}
`,g+=`Technical SEO,${X.analysis.technicalSEO}
`,g+=`User Experience,${X.analysis.userExperience}
`,g+=`Competitive Position,${X.analysis.competitivePosition}

`,g+=`Competitors:
`,g+=`Name,Website,Relevance Score,Strengths,Weaknesses
`,X.analysis.competitors.forEach(U=>{g+=`"${U.name}","${U.website}",${U.relevanceScore},"${U.strengths.join("; ").replace(/"/g,'""')}","${U.weaknesses.join("; ").replace(/"/g,'""')}"
`}),g+=`
Recommendations:
`,g+=`Priority,Recommendation,Impact,Effort
`,X.analysis.recommendations.forEach(U=>{g+=`${U.priority},"${U.recommendation.replace(/"/g,'""')}",${U.impact},${U.effort}
`});break;case"content-analysis":const he=S;g+=`Content Analysis Export
`,g+=`Analysis Name,${he.name}
`,g+=`URL,${he.url||"N/A"}
`,g+=`Timestamp,${new Date(he.timestamp).toISOString()}
`,g+=`SEO Score,${he.analysis.seoScore}
`,g+=`Readability Score,${he.analysis.readabilityScore}
`,g+=`Content Length,${he.analysis.contentLength} words
`,g+=`Keyword Density,${he.analysis.keywordDensity}%

`,g+=`Analyzed Content:
`,g+=`"${he.content.replace(/"/g,'""')}"

`,g+=`Suggestions:
`,g+=`Category,Suggestion,Priority
`,he.analysis.suggestions.forEach(U=>{g+=`${U.category},"${U.suggestion.replace(/"/g,'""')}",${U.priority}
`});break;case"structure-analysis":const te=S;g+=`Structure Analysis Export
`,g+=`Analysis Name,${te.name}
`,g+=`Timestamp,${new Date(te.timestamp).toISOString()}
`,g+=`Original Content Length,${te.originalContent.length} characters
`,g+=`Structured Content Length,${te.structuredContent.length} characters

`,g+=`Analysis Scores:
`,te.analysis.geoScoreTotal!==void 0&&(g+=`GEO Score,${te.analysis.geoScoreTotal}/100
`),te.analysis.contentQualityScoreTotal!==void 0&&(g+=`Content Quality Score,${te.analysis.contentQualityScoreTotal}/100
`),g+=`
`,g+=`Content Metadata:
`,g+=`Title,${te.analysis.metadata.title}
`,g+=`Description,${te.analysis.metadata.description}
`,g+=`Keywords,"${te.analysis.metadata.keywords.join(", ")}"
`,g+=`Author,${te.analysis.metadata.author}
`,g+=`Publish Date,${te.analysis.metadata.publishDate}
`,g+=`Last Modified,${te.analysis.metadata.lastModified}
`,g+=`Reading Time,${te.analysis.metadata.readingTime} minutes
`,g+=`Word Count,${te.analysis.metadata.wordCount}
`,g+=`Language,${te.analysis.metadata.language}

`,g+=`Original Content:
`,g+=`"${te.originalContent.replace(/"/g,'""')}"

`,g+=`Structured Content:
`,g+=`"${te.structuredContent.replace(/"/g,'""')}"

`,g+=`Structure Suggestions:
`,g+=`Type,Priority,Description,Implementation,Impact
`,te.analysis.suggestions.forEach(U=>{g+=`${U.type},${U.priority},"${U.description.replace(/"/g,'""')}","${U.implementation.replace(/"/g,'""')}","${U.impact.replace(/"/g,'""')}"
`});break;default:g+=`Unknown Type Export
`,g+=`Name,${S.name}
`,g+=`Type,${S.type}
`,g+=`Status,${S.status}
`,g+=`Timestamp,${new Date(S.timestamp).toISOString()}
`,g+=`Description,${S.description||"N/A"}
`}const ae=`${S.type}-${S.name.replace(/[^a-zA-Z0-9]/g,"-")}-${new Date(S.timestamp).toISOString().split("T")[0]}.csv`;o(g,ae,"text/csv")},m=a=>{confirm("Are you sure you want to delete this history item? This action cannot be undone.")&&(Ue.deleteHistoryItem(a),q(i=>i+1))},w=()=>{const a=C.size>0?l.filter(S=>C.has(S.id)):l,i={exportedAt:new Date().toISOString(),total:a.length,filtersApplied:{...L},items:a};o(JSON.stringify(i,null,2),"history-export.json","application/json")},M=a=>new Date(a).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),Y=a=>{switch(a){case"date":return e.jsx(bs,{className:"h-4 w-4"});case"type":return e.jsx(vt,{className:"h-4 w-4"});case"status":return e.jsx(Zt,{className:"h-4 w-4"});default:return e.jsx(vt,{className:"h-4 w-4"})}};return e.jsxs("div",{className:"max-w-7xl mx-auto py-6 px-4",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h1",{className:"text-2xl lg:text-3xl font-bold text-gray-900 mb-3",children:"Comprehensive History"}),e.jsx("p",{className:"text-gray-600 text-base lg:text-lg",children:"View and manage all your analysis history including Q&A, AI visibility, content analysis, and structure analysis"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[e.jsxs("div",{className:"bg-white rounded-lg p-4 border border-gray-200 text-center shadow-sm",children:[e.jsx("div",{className:"text-sm font-semibold text-gray-700 mb-1",children:"Total Items"}),e.jsx("div",{className:"text-2xl font-bold text-gray-900",children:l.length})]}),e.jsxs("div",{className:"bg-white rounded-lg p-4 border border-gray-200 text-center shadow-sm",children:[e.jsx("div",{className:"text-sm font-semibold text-gray-700 mb-1",children:"Q&A Sessions"}),e.jsx("div",{className:"text-2xl font-bold text-gray-900",children:l.filter(a=>a.type==="qa").length})]}),e.jsxs("div",{className:"bg-white rounded-lg p-4 border border-gray-200 text-center shadow-sm",children:[e.jsx("div",{className:"text-sm font-semibold text-gray-700 mb-1",children:"AI Visibility"}),e.jsx("div",{className:"text-2xl font-bold text-gray-900",children:l.filter(a=>a.type==="ai-visibility").length})]}),e.jsxs("div",{className:"bg-white rounded-lg p-4 border border-gray-200 text-center shadow-sm",children:[e.jsx("div",{className:"text-sm font-semibold text-gray-700 mb-1",children:"Selected Items"}),e.jsx("div",{className:"text-2xl font-bold text-gray-900",children:C.size})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 mb-6",children:[e.jsxs("button",{onClick:F,className:"bg-blue-600 text-white px-4 py-2 rounded-lg font-semibold shadow hover:bg-blue-700 transition flex items-center gap-2 justify-center",children:[e.jsx(Oe,{className:"h-4 w-4"}),"Export CSV"]}),e.jsxs("button",{onClick:w,className:"bg-blue-600 text-white px-4 py-2 rounded-lg font-semibold shadow hover:bg-blue-700 transition flex items-center gap-2 justify-center",children:[e.jsx(Oe,{className:"h-4 w-4"}),"Export JSON"]}),e.jsxs("button",{onClick:()=>{localStorage.removeItem("comprehensive_history"),s([]),c([]),u([]),alert("History cleared. Please refresh the page.")},className:"bg-blue-600 text-white px-4 py-2 rounded-lg font-semibold shadow hover:bg-blue-700 transition flex items-center gap-2 justify-center",children:[e.jsx(Pt,{className:"h-4 w-4"}),"Reset History"]})]}),e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-4 mb-6 overflow-visible relative",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h2",{className:"text-lg font-semibold text-gray-900 flex items-center gap-2",children:[e.jsx(ys,{className:"h-5 w-5"}),"Filters & Organization"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{onClick:()=>O(a=>({...a,showFilters:!a.showFilters})),className:"bg-gray-100 hover:bg-gray-200 text-gray-700 px-3 py-2 rounded-lg flex items-center gap-2 transition text-sm",children:[L.showFilters?e.jsx(Rt,{className:"h-4 w-4"}):e.jsx(qt,{className:"h-4 w-4"}),L.showFilters?"Hide":"Show"," Filters"]}),e.jsxs("button",{onClick:()=>{console.log("[History] Manual refresh triggered");const a=Ue.getHistoryItems();s(a),q(i=>i+1)},className:"bg-green-100 hover:bg-green-200 text-green-700 px-3 py-2 rounded-lg flex items-center gap-2 transition text-sm",children:[e.jsx(Pt,{className:"h-4 w-4"}),"Refresh"]}),e.jsxs("div",{className:"flex items-center gap-1 bg-blue-50 px-3 py-2 rounded-lg",children:[e.jsx("span",{className:"text-sm font-medium text-black",children:"Group by:"}),e.jsxs("select",{value:L.groupBy,onChange:a=>O(i=>({...i,groupBy:a.target.value})),className:"text-sm border-0 bg-transparent text-blue-700 font-medium focus:ring-0 focus:outline-none",children:[e.jsx("option",{value:"date",children:"Date"}),e.jsx("option",{value:"type",children:"Type"}),e.jsx("option",{value:"status",children:"Status"})]})]})]})]}),L.showFilters&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Search"}),e.jsxs("div",{className:"relative",children:[e.jsx(ht,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search all analysis...",value:L.searchTerm,onChange:a=>Xe(a,i=>O(S=>({...S,searchTerm:i}))),onPaste:a=>Ze(a,i=>O(S=>({...S,searchTerm:i}))),onKeyDown:a=>{et(a)||a.preventDefault()},className:"w-full pl-10 pr-4 py-2 border border-grey-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-white text-blue-600 placeholder-grey-400 relative z-10"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date Range"}),e.jsxs("select",{value:L.dateFilter,onChange:a=>O(i=>({...i,dateFilter:a.target.value})),className:"w-full px-3 py-2 border border-grey-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-white text-blue-600 relative z-10",children:[e.jsx("option",{value:"all",children:"All Time"}),e.jsx("option",{value:"today",children:"Today"}),e.jsx("option",{value:"week",children:"Last 7 Days"}),e.jsx("option",{value:"month",children:"Last 30 Days"}),e.jsx("option",{value:"year",children:"Last Year"}),e.jsx("option",{value:"specific",children:"Specific dateâ€¦"})]}),L.dateFilter==="specific"&&e.jsx("div",{className:"mt-2",children:e.jsx("input",{type:"date",value:L.specificDate,onChange:a=>O(i=>({...i,specificDate:a.target.value})),className:"w-full px-3 py-2 border border-grey-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-white text-blue-600"})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Analysis Type"}),e.jsxs("select",{value:L.typeFilter,onChange:a=>O(i=>({...i,typeFilter:a.target.value})),className:"w-full px-3 py-2 border border-grey-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-white text-blue-600 relative z-10",children:[e.jsx("option",{value:"all",children:"All Types"}),D.types.map(a=>e.jsx("option",{value:a,children:a?ue(a):"Unknown"},a))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Status"}),e.jsxs("select",{value:L.statusFilter,onChange:a=>O(i=>({...i,statusFilter:a.target.value})),className:"w-full px-3 py-2 border border-grey-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-white text-blue-600 relative z-10",children:[e.jsx("option",{value:"all",children:"All Status"}),D.statuses.map(a=>e.jsx("option",{value:a,children:a?a.charAt(0).toUpperCase()+a.slice(1):"Unknown"},a))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Sort By"}),e.jsxs("select",{value:L.sortBy,onChange:a=>O(i=>({...i,sortBy:a.target.value})),className:"w-full px-3 py-2 border border-grey-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-white text-blue-600 relative z-10",children:[e.jsx("option",{value:"date",children:"Date"}),e.jsx("option",{value:"name",children:"Name"}),e.jsx("option",{value:"type",children:"Type"}),e.jsx("option",{value:"status",children:"Status"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Sort Order"}),e.jsxs("select",{value:L.sortOrder,onChange:a=>O(i=>({...i,sortOrder:a.target.value})),className:"w-full px-3 py-2 border border-grey-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-white text-blue-600 relative z-10",children:[e.jsx("option",{value:"desc",children:"Newest First"}),e.jsx("option",{value:"asc",children:"Oldest First"})]})]})]})]}),e.jsx("div",{className:"space-y-4",children:h.length===0?e.jsxs("div",{className:"py-12 bg-white rounded-lg border border-gray-200 shadow-sm",children:[e.jsx(Jt,{className:"h-12 w-12 text-gray-400 mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No history found"}),e.jsx("p",{className:"text-gray-500",children:"Try adjusting your filters or create some analysis first."})]}):h.map(a=>e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden shadow-sm",children:[e.jsx("div",{className:"p-4 cursor-pointer hover:bg-gray-50 transition-colors border-b border-gray-200",onClick:()=>P(a.groupKey),children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[Y(a.groupType),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:a.groupTitle}),e.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-600",children:[e.jsxs("span",{children:[a.items.length," items"]}),e.jsxs("span",{children:[a.totalItems," total"]})]})]})]}),e.jsx("div",{className:"flex items-center gap-2",children:T.has(a.groupKey)?e.jsx(Rt,{className:"h-5 w-5 text-gray-500"}):e.jsx(qt,{className:"h-5 w-5 text-gray-500"})})]})}),T.has(a.groupKey)&&e.jsx("div",{className:"p-4 space-y-3",children:a.items.map(i=>{try{return e.jsx("div",{className:"border border-gray-200 rounded-lg p-3",children:le(i)},i.id)}catch(S){return console.error("[History] Error rendering item in group:",S,i),e.jsxs("div",{className:"border border-red-200 rounded-lg p-3 bg-red-50",children:[e.jsxs("div",{className:"text-red-600",children:["Error rendering item: ",S.message]}),e.jsxs("div",{className:"text-xs text-red-500 mt-2",children:["Item ID: ",i.id]})]},i.id)}})})]},a.groupKey))})]})}const Os="llm_qa_sessions",Us="llm_qa_current_session";function Qs(){const{user:t}=tt(),o=t?.id||t?.email||t?.name||"anonymous",[y]=bt(Os,[]);bt(Us,null),qe();const[s,l]=n.useState(""),[c,h]=n.useState("root-domain"),[u,T]=n.useState(!1),[b,C]=n.useState("company"),[$,R]=n.useState(null),[q,L]=n.useState(null),[O,D]=n.useState(!1),[P,_]=n.useState(null),[ue,ee]=n.useState("auto"),[le,be]=n.useState(!1),[ge,fe]=n.useState(""),[z,F]=n.useState(""),[k,x]=n.useState(""),[m,w]=n.useState(""),[M,Y]=n.useState(""),[a,i]=n.useState([]);n.useEffect(()=>{(async()=>{try{const E=JSON.parse(localStorage.getItem("shopify_connections")||"[]");if(E.length===0)return;const d=[];for(const v of E)if(v.token)try{const I=await fetch(`https://${v.shop}/api/2023-10/graphql.json`,{method:"POST",headers:{"Content-Type":"application/json","X-Shopify-Storefront-Access-Token":v.token},body:JSON.stringify({query:`
              query {
                products(first: 50) {
                  edges {
                    node {
                      id
                      title
                      handle
                    }
                  }
                }
              }
            `})});if(I.ok){const J=(await I.json()).data?.products?.edges?.map(Z=>Z.node)||[];d.push(...J)}}catch(j){console.warn(`Failed to fetch products from ${v.shop}:`,j)}i(d)}catch(E){console.error("Error fetching Shopify products:",E)}})()},[]);const S=N=>{const E=String(N||"").toLowerCase();return/tech|software|it|saas|cloud/.test(E)?"Information Technology & Services":/bank|financ|fintech|invest|payment|insur/.test(E)?"Finance":/health|medic|pharma|bio|clinic|care/.test(E)?"Healthcare":/legal|law|attorney|compliance/.test(E)?"Legal":/e-?commerce|commerce|retail|shop|store|magento|shopify|woocommerce/.test(E)?"Ecommerce & Retail":/media|news|content|video|stream/.test(E)?"Media":/edu|school|college|university|learning|edtech/.test(E)?"Education":"Others"},[g,ae]=n.useState([]),[re,X]=n.useState(0),[he,te]=n.useState(!1),U=n.useMemo(()=>`kabini_cleared_ai_visibility_${o}`,[o]),[ie,De]=n.useState(!1);n.useEffect(()=>{const N=Ue.getHistoryItems();ae(N),console.log("[Overview] Loaded history items:",N.length)},[re]),n.useEffect(()=>{if(localStorage.getItem(U)==="1"){localStorage.removeItem(U),R(null);return}if($&&$.competitors&&Array.isArray($.competitors)&&$.competitors.length>0){console.log("[AIVisibilityAnalysis] Already have meaningful analysis data, skipping restoration");return}try{const d=rt.getLatestAnalysisSession("ai-visibility",o);d?(console.log("[AIVisibilityAnalysis] Restoring cached analysis data:",d),console.log("[AIVisibilityAnalysis] Session has competitors:",d.data?.competitors?.length||0),d.inputValue&&l(d.inputValue),d.inputType&&C(d.inputType),d.analysisType&&h(d.analysisType),d.data&&(R(d.data),D(!0),console.log("[AIVisibilityAnalysis] Analysis result set with",d.data?.competitors?.length||0,"competitors")),console.log("[AIVisibilityAnalysis] Cached data restored successfully")):(console.log("[AIVisibilityAnalysis] No session found for user"),R(null),l(""),C("company"),h("root-domain"))}catch(d){console.error("[AIVisibilityAnalysis] Error restoring cached data:",d)}},[o,U]),n.useEffect(()=>{const N=v=>{(v.key==="comprehensive_history"||v.key==="sessions")&&(console.log("[Overview] Storage changed, refreshing data"),X(j=>j+1))},E=v=>{console.log("[AIVisibilityAnalysis] New analysis detected, refreshing session data");try{const j=rt.getLatestAnalysisSession("ai-visibility",o);j&&j.data&&(R(j.data),j.inputValue&&l(j.inputValue),j.inputType&&C(j.inputType),j.analysisType&&h(j.analysisType),D(!0))}catch(j){console.error("[AIVisibilityAnalysis] Error refreshing session data:",j)}};window.addEventListener("storage",N),window.addEventListener("new-analysis-created",E);const d=setInterval(()=>{Ue.getHistoryItems().length!==g.length&&(console.log("[Overview] Item count changed, refreshing data"),X(j=>j+1))},3e3);return()=>{window.removeEventListener("storage",N),window.removeEventListener("new-analysis-created",E),clearInterval(d)}},[g.length,o]),n.useEffect(()=>{console.log("[AIVisibilityAnalysis] Analysis result changed:",$)},[$]),n.useEffect(()=>{const N=E=>{E.target.closest(".dropdown-container")||be(!1)};return document.addEventListener("mousedown",N),()=>{document.removeEventListener("mousedown",N)}},[]),t&&y.filter(N=>N.userId===t.id);const ze=N=>{try{let E=N.replace(/^https?:\/\//,"").replace(/^www\./,"");E=E.split("/")[0].split("?")[0].split("#")[0];const d=E.split(".");return d.length>=2?d[d.length-2]:E}catch(E){return console.error("Error extracting company from URL:",E),N}},Le=(N,E)=>{const d=N.toLowerCase(),v=E?.toLowerCase()||"";return d.includes("cloud")&&(d.includes("migration")||d.includes("migrate")||d.includes("transform"))?"Cloud Migration & Transformation":d.includes("cloud")||d.includes("aws")||d.includes("azure")||d.includes("gcp")||d.includes("kubernetes")||d.includes("docker")||d.includes("devops")?"Cloud Computing & DevOps":d.includes("ai")||d.includes("artificial intelligence")||d.includes("machine learning")||d.includes("ml")||d.includes("deep learning")||d.includes("neural")?"Artificial Intelligence & ML":d.includes("cyber")||d.includes("security")||d.includes("firewall")||d.includes("vpn")||d.includes("threat")||d.includes("protection")?"Cybersecurity":d.includes("data")&&(d.includes("analytics")||d.includes("warehouse")||d.includes("lake")||d.includes("science")||d.includes("mining"))?"Data Analytics & Science":d.includes("saas")||d.includes("software as a service")||d.includes("platform")||d.includes("api")||d.includes("integration")?"SaaS & Platform Services":d.includes("tech")||d.includes("software")||d.includes("digital")||d.includes("innovation")?"Technology & Software":d.includes("bank")||d.includes("finance")||d.includes("credit")||d.includes("loan")||d.includes("payment")||d.includes("fintech")||d.includes("investment")?"Financial Services & Fintech":d.includes("health")||d.includes("medical")||d.includes("pharma")||d.includes("care")||d.includes("biotech")||d.includes("telehealth")?"Healthcare & Biotech":d.includes("retail")||d.includes("shop")||d.includes("store")||d.includes("commerce")||d.includes("ecommerce")||d.includes("marketplace")?"Retail & E-commerce":d.includes("edu")||d.includes("school")||d.includes("university")||d.includes("college")||d.includes("learning")||d.includes("training")?"Education & Training":d.includes("media")||d.includes("news")||d.includes("entertainment")||d.includes("tv")||d.includes("content")||d.includes("publishing")?"Media & Entertainment":d.includes("auto")||d.includes("car")||d.includes("vehicle")||d.includes("transport")||d.includes("logistics")||d.includes("supply chain")?"Automotive & Transportation":d.includes("food")||d.includes("restaurant")||d.includes("cafe")||d.includes("dining")||d.includes("delivery")||d.includes("catering")?"Food & Beverage":d.includes("real")||d.includes("estate")||d.includes("property")||d.includes("housing")||d.includes("construction")||d.includes("architecture")?"Real Estate & Construction":d.includes("energy")||d.includes("oil")||d.includes("gas")||d.includes("power")||d.includes("renewable")||d.includes("solar")||d.includes("wind")?"Energy & Utilities":d.includes("consulting")||d.includes("consultant")||d.includes("advisory")||d.includes("strategy")||d.includes("management")?"Consulting & Advisory":(/^https?:\/\//.test(v)||/\./.test(v),"Ecommerce & Retail")},st=async()=>{if(!ge.trim()){L("Website URL is required.");return}const N=ge.trim();let E=N,d="company";(N.includes("http://")||N.includes("https://")||N.includes("www."))&&(E=ze(N),d="url",console.log("[Overview] Detected URL, extracted company name:",E));const v=Le(E,N),j=S(v),I=ue!=="auto"?ue:j;console.log("[CompetitorInsight] API call parameters:",{finalCompanyName:E,detectedIndustry:I}),T(!0),L(null),D(!1);try{const H=new AbortController;_(H),console.log("[CompetitorInsight] Starting competitor analysis for:",E),console.log("[CompetitorInsight] Detected industry:",I);const J=await ye.getAIVisibilityAnalysis(E,I,{signal:H.signal},{productName:z.trim()||void 0,productCategory:k.trim()||void 0,competitorName:m.trim()||void 0,country:M.trim()||void 0});if(console.log("[AIVisibilityAnalysis] Analysis results received:",J),J.success&&J.data){console.log("[CompetitorInsight] Setting analysis result:",J.data);const Z={...J.data,industry:I,originalInput:ge,inputType:d,analysisType:c};R(null),setTimeout(()=>{R(Z),D(!0),console.log("[CompetitorInsight] State updated, analysis result set:",Z),X(G=>G+1)},100);try{const G=J.data.competitors||[],oe={id:`ai-visibility-${Date.now()}`,type:"ai-visibility",name:`Competitor Analysis - ${E}`,timestamp:new Date().toISOString(),status:"completed",company:E,industry:I,analysis:{competitors:G.map(ve=>({name:ve.name,mentions:ve.mentions||0,status:"success"})),serviceStatus:J.data.serviceStatus||{gemini:!0,perplexity:!0,claude:!0,chatgpt:!0},summary:{totalCompetitors:G.length,averageVisibilityScore:G.reduce((ve,He)=>ve+(He.mentions||0),0)/Math.max(G.length,1),topCompetitor:G.length>0?G.reduce((ve,He)=>(He.mentions||0)>(ve.mentions||0)?He:ve).name:"None"}}};try{await Ue.addHistoryItem(oe),window.dispatchEvent(new CustomEvent("new-analysis-created",{detail:{type:"ai-visibility",timestamp:new Date().toISOString()}})),console.log("[CompetitorInsight] Analysis saved to history:",oe)}catch(ve){console.error("[CompetitorInsight] Failed to save analysis to history:",ve),window.dispatchEvent(new CustomEvent("new-analysis-created",{detail:{type:"ai-visibility",timestamp:new Date().toISOString()}}))}}catch(G){console.warn("Failed to save analysis to history:",G)}try{rt.saveAnalysisSession("ai-visibility",Z,ge,c,d,I,o),console.log("[AIVisibilityAnalysis] Analysis results saved to session storage")}catch(G){console.warn("Failed to cache analysis results:",G)}}else console.error("[Overview] Analysis failed:",J.error),L(J.error||"Analysis failed. Please try again.")}catch(H){if(H.name==="AbortError"){console.log("Analysis was cancelled");return}console.error("AI analysis error:",H),L(H.message||"Analysis failed. Please try again.")}finally{T(!1),_(null)}},Te=N=>{const E=Array.isArray(N?.competitors)?N.competitors:[],d=[];return E.forEach(v=>{const j=v?.name||"Unknown",I=v?.aiTraffic?.placementTotals,H=Number(v?.aiTraffic?.totalMentions||0);if(!I||H<=0)return;const J=ve=>Math.max(0,Math.min(100,Math.round(Number(ve||0)/H*100))),Z=J(I.first),G=J(I.second),oe=Math.max(0,100-Z-G);d.push({name:j,first:Z,second:G,third:oe})}),d},xt=({result:N})=>{const[E,d]=n.useState(!1),v=Te(N);return e.jsxs("div",{className:"bg-white border border-gray-300 rounded-xl p-4 sm:p-6 lg:p-8 shadow-sm mb-6 hover:shadow-md hover:scale-[1.02] transition-all duration-150",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-9 h-9 rounded-lg flex items-center justify-center bg-gray-200",children:e.jsx(Mt,{className:"w-5 h-5",style:{color:"#2563eb"}})}),e.jsx("h3",{className:"text-xl font-semibold text-gray-900",children:"Share of Visibility"})]}),e.jsx("button",{onClick:()=>d(!E),className:"text-sm px-3 py-1 rounded-md border border-gray-300 text-gray-700 hover:bg-gray-50",title:"Shows overall brand presence in AI answers and how prominently each competitor is positioned (1st, 2nd, or 3rd). Green = 1st place mentions, Yellow = 2nd place, Blue = 3rd+ place. Helps identify who dominates brand presence and wins prime recommendation slots.",children:"i"})]}),E&&e.jsxs("div",{className:"text-sm text-gray-700 bg-gray-50 border border-gray-200 rounded-md p-3 mb-4 space-y-2",children:[e.jsx("div",{children:"Shows overall brand presence and placement quality using raw counts: per competitor we count 1st, 2nd and 3rd+ mentions across AI answers and normalize each bar to 100%."}),e.jsxs("div",{className:"font-mono text-xs leading-5",children:[e.jsx("div",{children:"P1 = count of 1st-place mentions"}),e.jsx("div",{children:"P2 = count of 2nd-place mentions"}),e.jsx("div",{children:"P3 = count of 3rd+ mentions"}),e.jsx("div",{className:"mt-2",children:"Bar = 100% stacked from P1/P2/P3 (per competitor)"})]})]}),v.length>0?e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-4 mb-3 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"inline-block w-3 h-3 rounded-sm bg-emerald-400"}),"1st"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"inline-block w-3 h-3 rounded-sm bg-amber-300"}),"2nd"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"inline-block w-3 h-3 rounded-sm bg-sky-400"}),"3rd"]})]}),e.jsx("div",{className:"w-full overflow-x-auto",children:e.jsxs("div",{className:"min-w-[640px] flex items-end gap-4 px-1 py-2",children:[e.jsxs("div",{className:"flex flex-col justify-between h-56 pr-2 text-[10px] text-gray-500 select-none",children:[e.jsx("span",{children:"100"}),e.jsx("span",{children:"80"}),e.jsx("span",{children:"60"}),e.jsx("span",{children:"40"}),e.jsx("span",{children:"20"}),e.jsx("span",{children:"0"})]}),v.map(j=>e.jsxs("div",{className:"flex flex-col items-center w-24",children:[e.jsxs("div",{className:"h-56 w-full bg-gray-100 rounded-md overflow-hidden flex flex-col-reverse shadow-sm",children:[e.jsx("div",{className:"bg-emerald-400",style:{height:`${j.first}%`},title:`1st: ${j.first}%`}),e.jsx("div",{className:"bg-amber-300",style:{height:`${j.second}%`},title:`2nd: ${j.second}%`}),e.jsx("div",{className:"bg-sky-400",style:{height:`${j.third}%`},title:`3rd: ${j.third}%`})]}),e.jsx("div",{className:"mt-2 text-xs text-gray-800 font-medium text-center truncate w-full",title:j.name,children:j.name})]},j.name))]})})]}):e.jsx("div",{className:"text-sm text-gray-600",children:"No competitor data available yet. Run an analysis to populate this section."})]})},Me=N=>{const E=String(N).trim();if(!E)return[];const v=E.split(/\s+/).join("");return[E,v]},Ae=N=>(Array.isArray(N?.competitors)?N.competitors:[]).map(v=>({name:v?.name||"Unknown",count:Number(v?.shopping?.total||0)})).filter(v=>v.count>0).sort((v,j)=>j.count-v.count),$e=({result:N})=>{const[E,d]=n.useState(!1),v=Ae(N),j=Math.max(1,...v.map(I=>I.count));return e.jsxs("div",{className:"bg-white border border-gray-300 rounded-xl p-4 sm:p-6 lg:p-8 shadow-sm mb-6 hover:shadow-md hover:scale-[1.02] transition-all duration-150",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-9 h-9 rounded-lg flex items-center justify-center bg-gray-200",children:e.jsx(Nt,{className:"w-5 h-5",style:{color:"#2563eb"}})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-semibold text-gray-900",children:"Shopping Visibility"}),e.jsx("div",{className:"text-xs text-gray-600",children:"Measures how often a competitor is cited as a buying destination in AI answers to transactional queries."})]})]}),e.jsx("button",{onClick:()=>d(!E),className:"text-sm px-3 py-1 rounded-md border border-gray-300 text-gray-700 hover:bg-gray-50",title:"Shows how often competitors are cited as buying destinations in AI answers to transactional queries (like 'where to buy X'). Higher bars indicate stronger shopping intent and conversion potential. Only transactional prompts are considered.",children:"i"})]}),E&&e.jsx("div",{className:"text-sm text-gray-700 bg-gray-50 border border-gray-200 rounded-md p-3 mb-4",children:"Shows how often competitors are cited as the buying destination in AI answers to transactional queries. Only transactional prompts are considered."}),v.length>0?e.jsx("div",{className:"w-full overflow-x-auto",children:e.jsxs("div",{className:"min-w-[640px] flex items-end gap-4 px-1 py-2",children:[e.jsxs("div",{className:"flex flex-col justify-between h-56 pr-2 text-[10px] text-gray-500 select-none",children:[e.jsx("span",{children:"100"}),e.jsx("span",{children:"80"}),e.jsx("span",{children:"60"}),e.jsx("span",{children:"40"}),e.jsx("span",{children:"20"}),e.jsx("span",{children:"0"})]}),v.map(I=>e.jsxs("div",{className:"flex flex-col items-center w-24",children:[e.jsx("div",{className:"h-56 w-full bg-gray-100 rounded-md overflow-hidden flex items-end justify-center shadow-sm",children:e.jsx("div",{className:"w-14 bg-sky-400",style:{height:`${I.count/j*100}%`},title:`${I.name}: ${I.count}`})}),e.jsx("div",{className:"mt-2 text-xs text-gray-800 font-medium text-center truncate w-full",title:I.name,children:I.name})]},I.name))]})}):e.jsx("div",{className:"text-sm text-gray-600",children:"No transactional mentions found for the selected product/country."})]})},Ie=["gemini","chatgpt","perplexity","claude"],lt=(N,E)=>{const d=String(N||"").toLowerCase();return E.reduce((v,j)=>{const I=j.toLowerCase().replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&"),H=new RegExp(`(?:^|[^a-z0-9])${I}(?:[^a-z0-9]|$)`,"gi"),J=d.match(H);return v+(J?J.length:0)},0)},ct=N=>{const E=Array.isArray(N?.competitors)?N.competitors:[],d=[];return E.forEach(v=>{const j=v?.name||"Unknown",I={},H=Number(v?.aiTraffic?.totalMentions||0);if(H>0){Ie.forEach(G=>{I[G]=Number(v?.aiTraffic?.byModel?.[G]||0)}),d.push({competitor:j,total:H,byTool:I});return}const J=Me(j);let Z=0;Ie.forEach(G=>{const oe=v?.breakdowns?.[G]?.analysis||"",ve=lt(oe,J);I[G]=ve,Z+=ve}),v?.analysis&&(Z+=lt(v.analysis,J)),d.push({competitor:j,total:Z,byTool:I})}),d.sort((v,j)=>j.total-v.total)},Se=({result:N})=>{const[E,d]=n.useState(!1),v=ct(N).filter(I=>(I.total||0)>0),j=Math.max(1,...v.map(I=>I.total));return e.jsxs("div",{className:"bg-white border border-gray-300 rounded-xl p-4 sm:p-6 lg:p-8 shadow-sm mb-6 hover:shadow-md hover:scale-[1.02] transition-all duration-150",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-9 h-9 rounded-lg flex items-center justify-center bg-gray-200",children:e.jsx(Xt,{className:"w-5 h-5",style:{color:"#2563eb"}})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-semibold text-gray-900",children:"Competitor Mentions"}),e.jsx("div",{className:"text-xs text-gray-600",children:"Bar graph of competitors by number of mentions across prompts."})]})]}),e.jsx("button",{onClick:()=>d(!E),className:"text-sm px-3 py-1 rounded-md border border-gray-300 text-gray-700 hover:bg-gray-50",title:"Shows total mentions of each competitor across all AI tools and prompts. Higher bars indicate stronger brand presence and recognition. This measures overall visibility and frequency of mentions in AI responses.",children:"i"})]}),E&&e.jsx("div",{className:"text-sm text-gray-700 bg-gray-50 border border-gray-200 rounded-md p-3 mb-4",children:"Records which competitors are cited most often across AI tools."}),v.length>0?e.jsx("div",{className:"w-full overflow-x-auto mb-6",children:e.jsxs("div",{className:"min-w-[640px] flex items-end gap-4 px-1 py-2",children:[e.jsxs("div",{className:"flex flex-col justify-between h-56 pr-2 text-[10px] text-gray-500 select-none",children:[e.jsx("span",{children:"100"}),e.jsx("span",{children:"80"}),e.jsx("span",{children:"60"}),e.jsx("span",{children:"40"}),e.jsx("span",{children:"20"}),e.jsx("span",{children:"0"})]}),v.map(I=>e.jsxs("div",{className:"flex flex-col items-center w-24",children:[e.jsx("div",{className:"h-56 w-full bg-gray-100 rounded-md overflow-hidden flex items-end justify-center shadow-sm",children:e.jsx("div",{className:"w-14 bg-rose-300",style:{height:`${I.total/j*100}%`},title:`${I.competitor}: ${I.total}`})}),e.jsx("div",{className:"mt-2 text-xs text-gray-800 font-medium text-center truncate w-full",title:I.competitor,children:I.competitor})]},I.competitor))]})}):e.jsx("div",{className:"text-sm text-gray-600 mb-6",children:"No mention data available."})]})},Be=["Blogs / Guides","Review Sites / Forums","Marketplaces","News / PR Mentions","Directories / Comparison"],A={"Blogs / Guides":["blog","guide","wirecutter","buying guide","how to choose","buyers guide","nytimes wirecutter"],"Review Sites / Forums":["trustpilot","reddit","quora","forum","community","reviews","stackexchange"],Marketplaces:["amazon","etsy","ebay","marketplace","google shopping","shopping feed","merchant center"],"News / PR Mentions":["forbes","techcrunch","news","press","pr","editorial","allure.com","the verge","nytimes"],"Directories / Comparison":["top10","top10.com","capterra","g2","directory","comparison","best-of","top sites"]},B=N=>{const E={};return Ie.forEach(v=>{E[v]={},Be.forEach(j=>E[v][j]=0)}),(Array.isArray(N?.competitors)?N.competitors:[]).forEach(v=>{Ie.forEach(j=>{const I=String(v?.breakdowns?.[j]?.analysis||"").toLowerCase();I&&Be.forEach(H=>{const J=A[H]||[];let Z=0;J.forEach(G=>{I.includes(G)&&(Z+=1)}),E[j][H]+=Z>0?1:0})})}),E},ce=N=>{const E={};return Ie.forEach(v=>{const j={},I={};Be.forEach(H=>{j[H]=0,I[H]=[]}),E[v]={counts:j,domains:I}}),(Array.isArray(N?.competitors)?N.competitors:[]).forEach(v=>{Ie.forEach(j=>{const I=v?.sourcesByTool?.[j];if(!I)return;const H=I.counts||{};Object.keys(H).forEach(Z=>{E[j].counts[Z]+=Number(H[Z]||0)}),(I.examples||[]).forEach(Z=>{if(!Z?.domain||!Z?.category)return;const G=E[j].domains[Z.category]||[];G.includes(Z.domain)||G.push(Z.domain)})})}),E},ne=({counts:N,size:E=180})=>{const d=Math.max(1,Object.values(N).reduce((J,Z)=>J+Z,0)),v={"Blogs / Guides":"#f59e0b","Review Sites / Forums":"#60a5fa",Marketplaces:"#10b981","News / PR Mentions":"#eab308","Directories / Comparison":"#2563eb"};let j=[],I=0;Be.forEach(J=>{const Z=(N[J]||0)/d*100,G=I,oe=I+Z;I=oe,j.push(`${v[J]} ${G}% ${oe}%`)});const H={width:`${E}px`,height:`${E}px`,borderRadius:"50%",background:`conic-gradient(${j.join(",")})`};return e.jsxs("div",{className:"relative",style:{width:E,height:E},children:[e.jsx("div",{style:H}),e.jsx("div",{className:"absolute inset-4 bg-white rounded-full"}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center text-lg text-gray-700 font-semibold",children:Object.values(N).reduce((J,Z)=>J+Z,0)})]})},Ce=({result:N})=>{const[E,d]=n.useState(!1),v=ce(N),j=Ie.some(G=>Object.values(v[G]?.counts||{}).some(oe=>(oe||0)>0));let I=j?Object.fromEntries(Ie.map(G=>[G,v[G].counts])):B(N);const H=G=>Object.values(G||{}).reduce((oe,ve)=>oe+ve,0);Ie.every(G=>H(I[G])===0)&&(I={gemini:{"Blogs / Guides":2,"Review Sites / Forums":1,Marketplaces:1,"News / PR Mentions":0,"Directories / Comparison":1},chatgpt:{"Blogs / Guides":1,"Review Sites / Forums":2,Marketplaces:1,"News / PR Mentions":1,"Directories / Comparison":0},perplexity:{"Blogs / Guides":1,"Review Sites / Forums":1,Marketplaces:1,"News / PR Mentions":1,"Directories / Comparison":0},claude:{"Blogs / Guides":0,"Review Sites / Forums":1,Marketplaces:1,"News / PR Mentions":1,"Directories / Comparison":1}});const Z=Ie;return e.jsxs("div",{className:"bg-white border border-gray-300 rounded-xl p-4 sm:p-6 lg:p-8 shadow-sm mb-6 hover:shadow-md hover:scale-[1.02] transition-all duration-150",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-9 h-9 rounded-lg flex items-center justify-center bg-gray-200",children:e.jsx(es,{className:"w-5 h-5",style:{color:"#2563eb"}})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-semibold text-gray-900",children:"Sources Cited in AI Responses"}),e.jsx("div",{className:"text-xs text-gray-600",children:"Donut charts show which source types each AI tool relies on (Blogs, Reviews/Forums, Marketplaces, PR, Directories)."})]})]}),e.jsx("button",{onClick:()=>d(!E),className:"text-sm px-3 py-1 rounded-md border border-gray-300 text-gray-700 hover:bg-gray-50",title:"Shows which source types each AI tool relies on for competitor information. Donut charts display distribution across Blogs/Guides, Review Sites/Forums, Marketplaces, News/PR, and Directories. Helps understand AI's information sources.",children:"i"})]}),E&&e.jsx("div",{className:"text-sm text-gray-700 bg-gray-50 border border-gray-200 rounded-md p-3 mb-4",children:"Understanding where AI pulls competitor mentions from is as important as who is mentioned. We classify citations into Blogs/Guides, Review Sites/Forums, Marketplaces, News/PR, and Directories/Comparisons per tool."}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6",children:Z.map(G=>e.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 flex flex-col items-center",children:[e.jsxs("div",{className:"text-sm font-semibold text-gray-800 mb-3 capitalize flex items-center gap-2",children:[G,j&&e.jsxs("div",{className:"relative group",children:[e.jsx("span",{className:"inline-flex items-center justify-center w-5 h-5 rounded-full bg-gray-100 text-gray-700 text-xs cursor-default",children:"i"}),e.jsxs("div",{className:"absolute z-10 hidden group-hover:block -left-2 top-6 w-72 bg-white border border-gray-200 rounded-md shadow-lg p-3 text-xs text-gray-800",children:[e.jsx("div",{className:"font-semibold mb-1",children:"Domains cited"}),Be.map(oe=>e.jsxs("div",{className:"mb-1",children:[e.jsx("div",{className:"text-gray-600 mb-0.5",children:oe}),e.jsx("div",{className:"text-gray-800 break-words",children:(v[G]?.domains?.[oe]||[]).slice(0,12).join(", ")||"â€”"})]},`${G}-dom-${oe}`))]})]})]}),e.jsx(ne,{counts:I[G]}),e.jsx("div",{className:"mt-3 space-y-1 text-xs w-full",children:Be.map(oe=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"inline-block w-3 h-3 rounded-sm",style:{backgroundColor:oe==="Blogs / Guides"?"#f59e0b":oe==="Review Sites / Forums"?"#60a5fa":oe==="Marketplaces"?"#10b981":oe==="News / PR Mentions"?"#eab308":"#2563eb"}}),e.jsx("span",{className:"text-gray-700",children:oe})]}),e.jsx("span",{className:"text-gray-600 font-bold",children:I[G][oe]||0})]},`${G}-${oe}`))})]},`donut-${G}`))})]})},xe=["Direct","Marketplace","Content","Authority","Indirect"],de={Direct:["store","shop","official","checkout","cart","buy from","retailer","sephora","ulta","dermstore","target","bestbuy","asos","primark","zara","h&m","massimo dutti","pull & bear","pull&bear"],Marketplace:["amazon","etsy","ebay","walmart","flipkart","aliexpress","mercadolibre","rakuten"],Content:["wirecutter","reddit","quora","youtube","influencer","blog","guide","buyers guide","forum","community","review site","trustpilot","capterra","g2"],Authority:["forbes","allure","bloomberg","wsj","nytimes","the verge","guardian","techcrunch","reuters","cnbc","financial times","ft.com","editorial","press"],Indirect:["the ordinary","tata harper","minimalist","affordable alternative","alternative","substitute","sustainable luxury","organic skincare","budget skincare"]},W=(N,E,d)=>{const v=String(N).toLowerCase(),j=String(E||"").toLowerCase();return de.Marketplace.some(I=>v.includes(I)||j.includes(I))?"Marketplace":de.Content.some(I=>v.includes(I)||j.includes(I))?"Content":de.Authority.some(I=>v.includes(I)||j.includes(I))?"Authority":(d||0)>0?"Direct":de.Indirect.some(I=>v.includes(I)||j.includes(I))||/(alternative|substitute|budget|affordable|sustainable\s+luxury)/i.test(j)?"Indirect":(/store|shop|cart|checkout|official|retail|ecommerce/i.test(j)||de.Direct.some(I=>v.includes(I)),"Direct")},me=N=>{const E={Direct:0,Marketplace:0,Content:0,Authority:0,Indirect:0};return(Array.isArray(N?.competitors)?N.competitors:[]).forEach(v=>{const j=v?.name||"Unknown",I=[v?.analysis,v?.breakdowns?.gemini?.analysis,v?.breakdowns?.chatgpt?.analysis,v?.breakdowns?.perplexity?.analysis,v?.breakdowns?.claude?.analysis].filter(Boolean).join(`
`),H=W(j,I,Number(v?.shopping?.total||0));E[H]+=1}),{counts:E}},we=({result:N})=>{const[E,d]=n.useState(!1);let v=me(N).counts;xe.reduce((oe,ve)=>oe+(v[ve]||0),0)===0&&(v={Direct:5,Marketplace:3,Content:2,Authority:2,Indirect:1});const I={Direct:"#1f4b89",Marketplace:"#f59e0b",Content:"#14b8a6",Authority:"#ef4444",Indirect:"#22c55e"},H=Math.max(1,xe.reduce((oe,ve)=>oe+(v[ve]||0),0));let J=0;const Z=[];xe.forEach(oe=>{const ve=(v[oe]||0)/H*100,He=J,We=J+ve;J=We,Z.push(`${I[oe]} ${He}% ${We}%`)});const G={width:"220px",height:"220px",borderRadius:"50%",background:`conic-gradient(${Z.join(",")})`};return e.jsxs("div",{className:"bg-white border border-gray-300 rounded-xl p-4 sm:p-6 lg:p-8 shadow-sm mb-6 hover:shadow-md hover:scale-[1.02] transition-all duration-150",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-9 h-9 rounded-lg flex items-center justify-center bg-gray-200",children:e.jsx(Mt,{className:"w-5 h-5",style:{color:"#2563eb"}})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-semibold text-gray-900",children:"Competitor Type Breakdown"}),e.jsx("div",{className:"text-xs text-gray-600",children:"Donut shows distribution across Direct, Marketplace, Content, Authority, Indirect."})]})]}),e.jsx("button",{onClick:()=>d(!E),className:"text-sm px-3 py-1 rounded-md border border-gray-300 text-gray-700 hover:bg-gray-50",title:"Shows how competitors are classified: Direct (retail/brand stores), Indirect (substitutes/alternatives), Marketplaces (Amazon/Etsy), Content (reviews/guides), and Authority (PR/editorial). Helps understand competitive landscape structure.",children:"i"})]}),E&&e.jsx("div",{className:"text-sm text-gray-700 bg-gray-50 border border-gray-200 rounded-md p-3 mb-4",children:"We classify competitors into Direct (retail/brand stores), Indirect (substitutes/alternatives), Marketplaces (Amazon/Etsy/eBay), Content (reviews/guides/forums), and Authority (PR/editorial/trusted brands)."}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 items-center",children:[e.jsx("div",{className:"flex items-center justify-center",children:e.jsxs("div",{className:"relative",style:{width:220,height:220},children:[e.jsx("div",{style:G}),e.jsx("div",{className:"absolute inset-6 bg-white rounded-full"}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center text-xl font-bold text-gray-800",children:H})]})}),e.jsx("div",{className:"space-y-2 text-sm",children:xe.map(oe=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"inline-block w-3 h-3 rounded-sm",style:{backgroundColor:I[oe]}}),e.jsx("span",{className:"text-gray-800",children:oe})]}),e.jsx("span",{className:"text-gray-700 font-bold text-base",children:v[oe]||0})]},`type-${oe}`))})]})]})},Re=["List","Comparison","Recommendation","FAQ","Editorial"],je={List:["top ","top-","best ","best-","list of","roundup","top 5","top five","top 10","ranking"],Comparison:[" vs ","versus","compare","comparison","compared to"],Recommendation:["recommend","we suggest","try ","good for","ideal for","if you want","alternative","pick"],FAQ:["where can i","how do i","faq","q:","where to buy","is it safe","can i"],Editorial:["according to","editorial","news","press","reported","magazine","forbes","allure","techcrunch"]},se=N=>(Array.isArray(N?.competitors)?N.competitors:[]).map(d=>{const v=d?.name||"Unknown",j=d?.contentStyle;let I;if(j&&Object.keys(j).length>0)I={List:Number(j.List||0),Comparison:Number(j.Comparison||0),Recommendation:Number(j.Recommendation||0),FAQ:Number(j.FAQ||0),Editorial:Number(j.Editorial||0)};else{const J=[d?.analysis,d?.breakdowns?.gemini?.analysis,d?.breakdowns?.chatgpt?.analysis,d?.breakdowns?.perplexity?.analysis,d?.breakdowns?.claude?.analysis].filter(Boolean).join(`
`).toLowerCase();I={List:0,Comparison:0,Recommendation:0,FAQ:0,Editorial:0},Object.keys(je).forEach(Z=>{const G=je[Z];let oe=0;G.forEach(ve=>{J.includes(ve)&&(oe+=1)}),I[Z]=oe})}const H=Re.reduce((J,Z)=>J+(I[Z]||0),0);return{name:v,counts:I,total:H}}).sort((d,v)=>v.total-d.total),at=({result:N})=>{const[E,d]=n.useState(!1);let v=se(N);(v.length===0||v.every(H=>H.total===0))&&(v=[{name:"Example A",counts:{List:8,Comparison:2,Recommendation:3,FAQ:1,Editorial:1},total:15},{name:"Example B",counts:{List:2,Comparison:6,Recommendation:1,FAQ:0,Editorial:1},total:10}]),Math.max(1,...v.map(H=>H.total));const I={List:"#3b82f6",Comparison:"#f59e0b",Recommendation:"#22c55e",FAQ:"#10b981",Editorial:"#ef4444"};return e.jsxs("div",{className:"bg-white border border-gray-300 rounded-xl p-4 sm:p-6 lg:p-8 shadow-sm mb-6 hover:shadow-md hover:scale-[1.02] transition-all duration-150",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-9 h-9 rounded-lg flex items-center justify-center bg-gray-200",children:e.jsx(Zt,{className:"w-5 h-5",style:{color:"#2563eb"}})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-semibold text-gray-900",children:"Content Styles in AI Mentions"}),e.jsx("div",{className:"text-xs text-gray-600",children:"Stacked bars: List, Comparison, Recommendation, FAQ, Editorial per competitor."})]})]}),e.jsx("button",{onClick:()=>d(!E),className:"text-sm px-3 py-1 rounded-md border border-gray-300 text-gray-700 hover:bg-gray-50",title:"Shows how each competitor is framed in AI responses: Lists (product lists), Comparisons (vs other brands), Recommendations (AI suggestions), FAQ (question-answer format), Editorial (opinion pieces). Helps understand presentation context.",children:"i"})]}),E&&e.jsx("div",{className:"text-sm text-gray-700 bg-gray-50 border border-gray-200 rounded-md p-3 mb-4",children:"We record how each answer frames competitors (FAQ, guide/list, comparison, recommendation, editorial). Use this to see if direct rivals dominate Lists, if indirects appear as Recommendations, and if authority brands surface via Editorials."}),v.length>0?e.jsxs("div",{children:[e.jsx("div",{className:"flex items-center gap-4 mb-3 text-sm",children:Re.map(H=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"inline-block w-3 h-3 rounded-sm",style:{backgroundColor:I[H]}}),H]},`legend-${H}`))}),e.jsx("div",{className:"w-full overflow-x-auto",children:e.jsx("div",{className:"min-w-[720px] flex items-end gap-4 px-1 py-2",children:v.map(H=>e.jsxs("div",{className:"flex flex-col items-center w-28",children:[e.jsx("div",{className:"h-56 w-full bg-gray-100 rounded-md overflow-hidden flex flex-col-reverse shadow-sm",children:Re.map(J=>{const Z=H.counts[J]||0,G=Z/Math.max(1,H.total)*100;return G<=0?null:e.jsx("div",{className:"w-full",style:{height:`${G}%`,backgroundColor:I[J]},title:`${J}: ${Z}`},`${H.name}-${J}`)})}),e.jsx("div",{className:"mt-2 text-xs text-gray-800 font-medium text-center truncate w-full",title:H.name,children:H.name}),e.jsx("div",{className:"text-[11px] text-gray-600",children:H.total})]},H.name))})})]}):e.jsx("div",{className:"text-sm text-gray-600",children:"No content style signals detected."})]})};return e.jsxs("div",{className:"w-full max-w-full mx-auto space-y-6 lg:space-y-8 px-2 sm:px-4 lg:px-6",children:[e.jsxs("div",{className:"flex flex-col lg:flex-row justify-between items-start gap-4",children:[e.jsx("div",{className:"flex-1 min-w-0"}),$&&e.jsxs("button",{onClick:()=>{R(null),L(null),D(!1),fe(""),F(""),x(""),w(""),Y(""),ee("auto");try{localStorage.setItem(U,"1")}catch{}De(!0)},className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg font-medium flex items-center gap-2 transition-colors shadow-sm",children:[e.jsx(Ge,{className:"w-4 h-4"}),"New Analysis"]})]}),e.jsxs("div",{className:"bg-white border border-gray-300 rounded-xl p-4 sm:p-6 lg:p-8 shadow-sm",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h2",{className:"text-3xl font-bold text-gray-900 mb-3",children:"Competitor Analysis Dashboard"}),e.jsx("p",{className:"text-gray-600 text-lg",children:"Enter your website URL or company name to get instant competitor insights and market positioning."})]}),e.jsx("div",{className:"bg-gray-50 border border-gray-300 rounded-xl p-4 sm:p-6 mb-6",children:e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:[grid-template-columns:repeat(24,minmax(0,1fr))] gap-3 items-end",children:[e.jsxs("div",{className:"flex flex-col gap-1 lg:col-span-7",children:[e.jsxs("label",{htmlFor:"websiteUrl",className:"text-xs font-semibold text-gray-700",children:["Website URL ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{id:"websiteUrl",type:"text",value:ge,onChange:N=>Xe(N,fe),onPaste:N=>Ze(N,fe),onKeyDown:et,placeholder:"https://example.com",required:!0,className:"h-11 px-3 py-2 border border-gray-300 rounded-lg text-gray-900 text-sm w-full"})]}),e.jsxs("div",{className:"flex flex-col gap-1 lg:col-span-3",children:[e.jsx("label",{htmlFor:"productName",className:"text-xs font-semibold text-gray-700",children:"Product Name"}),e.jsx("input",{id:"productName",type:"text",value:z,onChange:N=>Xe(N,F),onPaste:N=>Ze(N,F),onKeyDown:et,placeholder:"Product Name",list:"shopify-products-list",className:"h-11 px-3 py-2 border border-gray-300 rounded-lg text-gray-900 text-sm w-full"}),a.length>0&&e.jsx("datalist",{id:"shopify-products-list",children:a.map(N=>e.jsx("option",{value:N.title},N.id))})]}),e.jsxs("div",{className:"flex flex-col gap-1 lg:col-span-3",children:[e.jsx("label",{htmlFor:"productCategory",className:"text-xs font-semibold text-gray-700",children:"Product Category"}),e.jsxs("select",{id:"productCategory",value:k,onChange:N=>x(N.target.value),className:"h-11 px-3 py-2 border border-gray-300 rounded-lg text-gray-900 text-sm w-full",children:[e.jsx("option",{value:"",children:"Select Category"}),e.jsx("option",{value:"Electronics",children:"Electronics"}),e.jsx("option",{value:"Fashion",children:"Fashion"}),e.jsx("option",{value:"Beauty",children:"Beauty"}),e.jsx("option",{value:"Home and Garden",children:"Home and Garden"}),e.jsx("option",{value:"Sports",children:"Sports"}),e.jsx("option",{value:"Automotive",children:"Automotive"}),e.jsx("option",{value:"Books",children:"Books"}),e.jsx("option",{value:"Health",children:"Health"}),e.jsx("option",{value:"Others",children:"Others"})]})]}),e.jsxs("div",{className:"flex flex-col gap-1 lg:col-span-3",children:[e.jsx("label",{htmlFor:"competitorName",className:"text-xs font-semibold text-gray-700",children:"Known Competitor"}),e.jsx("input",{id:"competitorName",type:"text",value:m,onChange:N=>Xe(N,w),onPaste:N=>Ze(N,w),onKeyDown:et,placeholder:"Known Competitor",className:"h-11 px-3 py-2 border border-gray-300 rounded-lg text-gray-900 text-sm w-full"})]}),e.jsxs("div",{className:"flex flex-col gap-1 lg:col-span-3",children:[e.jsx("label",{htmlFor:"country",className:"text-xs font-semibold text-gray-700",children:"Country"}),e.jsxs("select",{id:"country",value:M,onChange:N=>Y(N.target.value),className:"h-11 px-3 py-2 border border-gray-300 rounded-lg text-gray-900 text-sm w-full",children:[e.jsx("option",{value:"",children:"Country"}),e.jsx("option",{value:"United States",children:"United States"}),e.jsx("option",{value:"United Kingdom",children:"United Kingdom"}),e.jsx("option",{value:"Canada",children:"Canada"}),e.jsx("option",{value:"Australia",children:"Australia"}),e.jsx("option",{value:"India",children:"India"}),e.jsx("option",{value:"Germany",children:"Germany"}),e.jsx("option",{value:"France",children:"France"}),e.jsx("option",{value:"Singapore",children:"Singapore"}),e.jsx("option",{value:"United Arab Emirates",children:"United Arab Emirates"}),e.jsx("option",{value:"Others",children:"Others"})]})]}),e.jsxs("div",{className:"flex flex-col gap-1 lg:col-span-3",children:[e.jsx("label",{htmlFor:"industry",className:"text-xs font-semibold text-gray-700",children:"Industry"}),e.jsxs("select",{id:"industry",value:ue,onChange:N=>ee(N.target.value),className:"h-11 px-3 py-2 border border-gray-300 rounded-lg text-gray-900 text-sm w-full",disabled:u,title:"Select industry",children:[e.jsx("option",{value:"auto",children:"Industry"}),e.jsx("option",{value:"Information Technology & Services",children:"Information Technology & Services"}),e.jsx("option",{value:"Finance",children:"Finance"}),e.jsx("option",{value:"Healthcare",children:"Healthcare"}),e.jsx("option",{value:"Legal",children:"Legal"}),e.jsx("option",{value:"Ecommerce & Retail",children:"Ecommerce & Retail"}),e.jsx("option",{value:"Media",children:"Media"}),e.jsx("option",{value:"Education",children:"Education"}),e.jsx("option",{value:"Marketing & Advertising",children:"Marketing & Advertising"}),e.jsx("option",{value:"Computer Software / Internet",children:"Computer Software / Internet"}),e.jsx("option",{value:"Others",children:"Others"})]})]}),e.jsx("button",{onClick:st,disabled:u||!ge.trim(),className:"h-11 px-4 bg-black hover:bg-gray-800 disabled:bg-gray-400 text-white rounded-lg font-medium flex items-center justify-center gap-2 transition-colors shadow w-full text-sm lg:col-span-2 self-end",children:u?e.jsxs(e.Fragment,{children:[e.jsx(Pe,{className:"w-4 h-4 animate-spin"}),"Analyzing..."]}):e.jsxs(e.Fragment,{children:[e.jsx(ht,{className:"w-4 h-4"}),"Analyse"]})})]})}),q&&e.jsx("div",{className:"mb-6 text-red-700 bg-red-50 border border-red-200 rounded-lg px-4 py-3",children:q}),O&&e.jsx("div",{className:"mb-6 text-green-700 bg-green-50 border border-green-200 rounded-lg px-4 py-3",children:"âœ… Analysis completed successfully! Results are ready below."}),$&&e.jsxs("div",{className:"space-y-6",children:[e.jsx(xt,{result:$}),e.jsx($e,{result:$}),e.jsx(Se,{result:$}),e.jsx(Ce,{result:$}),e.jsx(we,{result:$}),e.jsx(at,{result:$}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-6 border border-gray-300 hover:shadow-md hover:scale-[1.02] transition-all duration-150",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Competitor Analysis"}),e.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-700 border border-gray-200",children:"Period: Monthly"})]}),$.competitors&&Array.isArray($.competitors)&&$.competitors.length>0&&e.jsx(ms,{data:$},`analysis-${re}`)]})]})]})]})}function it({title:t,icon:o,iconBgColor:y,children:s,tooltip:l}){return e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-300 hover:shadow-md hover:scale-[1.02] transition-all duration-150",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-100",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-9 h-9 rounded-lg flex items-center justify-center text-white ${y}`,children:o}),e.jsx("h2",{className:"text-base sm:text-lg font-semibold text-gray-900",children:t})]}),l&&e.jsx("button",{className:"text-sm px-3 py-1 rounded-md border border-gray-300 text-gray-700 hover:bg-gray-50",title:l,children:"i"})]}),e.jsx("div",{className:"p-4 sm:p-6",children:s})]})}function Bs({score:t}){const o=Math.max(0,Math.min(100,Math.round(t*10))),y=c=>c>=80?"Excellent":c>=60?"Good":c>=40?"Fair":c>=20?"Poor":"Very Poor",s=c=>c>=80?"text-emerald-600":c>=60?"text-blue-600":c>=40?"text-amber-600":c>=20?"text-orange-600":"text-red-600",l=c=>c>=80?"bg-emerald-500":c>=60?"bg-blue-500":c>=40?"bg-amber-500":c>=20?"bg-orange-500":"bg-red-500";return e.jsx(it,{title:"AI Visibility Score",icon:e.jsx(Ke,{className:"w-5 h-5 text-blue-600"}),iconBgColor:"bg-gray-200",tooltip:"Shows estimated visibility percentage based on share of mentions across AI tools. Higher scores indicate stronger brand presence and recognition in AI responses. This metric helps understand how visible your brand is compared to competitors in AI-generated content.",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-4xl font-bold text-gray-900 mb-1",children:o}),e.jsx("div",{className:"text-sm text-gray-600 mb-2",children:"out of 100"}),e.jsx("div",{className:`text-lg font-bold ${s(o)} mb-4`,children:y(o)}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:`h-2 rounded-full ${l(o)}`,style:{width:`${o}%`}})})]})})}function Hs({score:t}){const o=l=>l>=80?"Excellent":l>=60?"Good":l>=40?"Fair":l>=20?"Poor":"Very Poor",y=l=>l>=80?"text-emerald-600":l>=60?"text-blue-600":l>=40?"text-amber-600":l>=20?"text-orange-600":"text-red-600",s=l=>l>=80?"bg-emerald-500":l>=60?"bg-blue-500":l>=40?"bg-amber-500":l>=20?"bg-orange-500":"bg-red-500";return e.jsx(it,{title:"AI Readiness Score",icon:e.jsx(Fe,{className:"w-5 h-5 text-blue-600"}),iconBgColor:"bg-gray-200",tooltip:"Measures how well your content is optimized for AI understanding and recommendations. Based on schema markup, content quality, trust signals, and technical SEO. Higher scores indicate better AI readiness and higher chances of being recommended by AI tools.",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-4xl font-bold text-gray-900 mb-1",children:t}),e.jsx("div",{className:"text-sm text-gray-600 mb-2",children:"out of 100"}),e.jsx("div",{className:`text-lg font-bold ${y(t)} mb-4`,children:o(t)}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:`h-2 rounded-full ${s(t)}`,style:{width:`${t}%`}})})]})})}const Ht={Luxury:["luxury","premium","high-end","curated"],Affordable:["affordable","budget","low-cost","cheap","value","deal","discount"],"Fast Shipping":["fast shipping","same-day","next-day","prime delivery","quick delivery"],Organic:["organic","clean beauty","natural"],Sustainable:["sustainable","eco-friendly","green","recyclable"],Variety:["variety","wide selection","assortment","many options"]};function Vs(t){const o=Object.keys(Ht),y=(Array.isArray(t?.competitors)?t.competitors:[]).map(l=>l?.name||"Unknown"),s={};return o.forEach(l=>{s[l]={},y.forEach(c=>{s[l][c]=0})}),(Array.isArray(t?.competitors)?t.competitors:[]).forEach(l=>{const c=l?.name||"Unknown";if(l?.productAttributes&&typeof l.productAttributes=="object"){const h={Luxury:"Luxury",Affordable:"Affordable","Fast Shipping":"Fast Shipping",Organic:"Organic",Sustainable:"Sustainable",Variety:"Variety","Cheap Deals":"Affordable",Minimalist:"Luxury"};Object.entries(l.productAttributes).forEach(([u,T])=>{const b=h[u]||u;o.includes(b)&&(s[b][c]=(s[b][c]||0)+Number(T||0))})}else{const h=[l?.analysis,l?.breakdowns?.gemini?.analysis,l?.breakdowns?.chatgpt?.analysis,l?.breakdowns?.perplexity?.analysis,l?.breakdowns?.claude?.analysis].filter(u=>u!=null).map(u=>String(u||"").toLowerCase());o.forEach(u=>{const T=Ht[u]||[];h.forEach(b=>{T.forEach(C=>{b.includes(C.toLowerCase())&&(s[u][c]=(s[u][c]||0)+1)})})})}}),{attributes:o,competitors:y,counts:s}}function _s({result:t}){const o=Vs(t),y=Math.max(1,...o.attributes.flatMap(s=>Object.values(o.counts[s]||{})));return e.jsx(it,{title:"Product Analysis by GEO",icon:e.jsx(Fe,{className:"w-5 h-5 text-blue-600"}),iconBgColor:"bg-gray-200",tooltip:"Shows which product attributes (luxury, affordable, organic, sustainable) AI associates with each competitor in location-aware queries. Bubble size indicates frequency of association. Helps understand how competitors are positioned in the market and identify attribute gaps.",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-[720px] w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left p-2 text-xs text-black font-semibold",children:"Attribute"}),o.competitors.map(s=>e.jsx("th",{className:"text-center p-2 text-xs text-black font-semibold",children:s},s))]})}),e.jsx("tbody",{children:o.attributes.map(s=>e.jsxs("tr",{className:"border-t",children:[e.jsx("td",{className:"p-2 font-semibold text-black",children:s}),o.competitors.map(l=>{const c=o.counts[s]&&o.counts[s][l]||0,h=16+Math.round(c/y*28);return e.jsx("td",{className:"p-2 text-center",children:c>0?e.jsx("div",{className:"mx-auto rounded-full bg-sky-400/70",style:{width:h,height:h},title:`${s} â€“ ${l}: ${c}`}):e.jsx("span",{className:"text-gray-300",children:"â€“"})},l)})]},s))})]})})})}const zs=["great","best","top","trust","popular","recommended","winner"],Gs=["avoid","bad","scam","fake","complaint","poor"],Ks=t=>t==="Positive"?"bg-green-100 text-green-800":t==="Negative"?"bg-red-100 text-red-800":t==="Mixed"?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800";function Ws({result:t}){const[o,y]=n.useState(!1),l=(Array.isArray(t?.competitors)?t.competitors:[]).map(c=>{const h=c?.name||"Unknown";if(c?.sentiment&&Array.isArray(c.sentiment)&&c.sentiment.length>0){const q=c.sentiment[0];return{name:q.name||h,tone:q.tone||"Neutral",quote:q.quote||"No quote available",source:q.source||"AI Analysis",attr:q.attr||"General",takeaway:q.takeaway||"Analysis not available"}}const T=[c?.analysis,c?.breakdowns?.gemini?.analysis,c?.breakdowns?.chatgpt?.analysis].filter(Boolean).map(q=>String(q||"").toLowerCase()).join(" "),b=zs.filter(q=>T.includes(q)).length,C=Gs.filter(q=>T.includes(q)).length;let $="Neutral";b>C&&b>1?$="Positive":C>b&&C>1?$="Negative":b>0&&C>0&&($="Mixed");const R=(c?.analysis||"").substring(0,150)||"No analysis available";return{name:h,tone:$,quote:R,source:"AI Analysis",attr:"General Perception",takeaway:$==="Positive"?"Strong brand perception":$==="Negative"?"Challenges in brand perception":"Neutral brand positioning"}});return e.jsxs(it,{title:"Sentiment Analysis",icon:e.jsx(Fe,{className:"w-5 h-5 text-blue-600"}),iconBgColor:"bg-gray-200",tooltip:"Shows how competitors are perceived in AI responses: Positive (praise), Neutral (factual), Negative (criticism), Mixed (both). Includes example quotes, sources, and context. Helps understand brand perception and reputation in AI-generated content.",children:[e.jsx("div",{className:"mb-3",children:e.jsx("div",{className:"text-xs text-gray-600",children:"Tone, example mention, source, attribute/context, and takeaway per competitor."})}),o&&e.jsx("div",{className:"text-sm text-gray-700 bg-gray-50 border border-gray-200 rounded-md p-3 mb-3",children:"Heuristic tone derived from AI analyses when backend sentiment rows are missing."}),e.jsx("div",{className:"w-full overflow-x-auto",children:e.jsxs("table",{className:"min-w-[900px] w-full text-sm border border-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-3 py-2 text-left border-b border-gray-200",children:"Competitor"}),e.jsx("th",{className:"px-3 py-2 text-left border-b border-gray-200",children:"Tone"}),e.jsx("th",{className:"px-3 py-2 text-left border-b border-gray-200",children:"Example Mention"}),e.jsx("th",{className:"px-3 py-2 text-left border-b border-gray-200",children:"Source"}),e.jsx("th",{className:"px-3 py-2 text-left border-b border-gray-200",children:"Attribute/Context"}),e.jsx("th",{className:"px-3 py-2 text-left border-b border-gray-200",children:"Key Takeaway"})]})}),e.jsx("tbody",{children:l.map(c=>e.jsxs("tr",{className:"border-b border-gray-100",children:[e.jsx("td",{className:"px-3 py-2 font-medium text-gray-900 whitespace-nowrap",children:c.name}),e.jsx("td",{className:"px-3 py-2",children:e.jsx("span",{className:`px-2 py-1 rounded ${Ks(c.tone)}`,children:c.tone})}),e.jsx("td",{className:"px-3 py-2 text-gray-800",children:c.quote}),e.jsx("td",{className:"px-3 py-2 text-gray-700 whitespace-nowrap",children:c.source}),e.jsx("td",{className:"px-3 py-2 text-gray-700 whitespace-nowrap",children:c.attr}),e.jsx("td",{className:"px-3 py-2 text-gray-800",children:c.takeaway})]},`sent-${c.name}`))})]})})]})}const dt=["Reviews","Backlinks","PR Coverage","Certifications/Awards"],Ys={Reviews:["trustpilot","google reviews","sitejabber","review","ratings","reddit","forum"],Backlinks:["backlink","high da","wirecutter","forbes.com","nytimes","domain authority","link profile"],"PR Coverage":["forbes","techcrunch","press","pr","news","editorial","coverage","featured in"],"Certifications/Awards":["certified","certification","ssl","badge","award","best of beauty","editorâ€™s choice","editors choice"]};function Js({result:t}){const y=(Array.isArray(t?.competitors)?t.competitors:[]).map(c=>{const h=c?.name||"Unknown",u={Reviews:0,Backlinks:0,"PR Coverage":0,"Certifications/Awards":0};return c?.authority&&Array.isArray(c.authority)&&c.authority.length>0?c.authority.forEach(T=>{const b=(T.signal||"").toLowerCase();b.includes("review")||b.includes("trustpilot")||b.includes("rating")?u.Reviews+=1:b.includes("backlink")||b.includes("domain authority")?u.Backlinks+=1:b.includes("pr")||b.includes("press")||b.includes("coverage")?u["PR Coverage"]+=1:b.includes("certification")||b.includes("award")||b.includes("badge")?u["Certifications/Awards"]+=1:u.Reviews+=1}):[c?.analysis,c?.breakdowns?.gemini?.analysis,c?.breakdowns?.chatgpt?.analysis,c?.breakdowns?.perplexity?.analysis,c?.breakdowns?.claude?.analysis].filter(b=>b!=null).map(b=>String(b||"").toLowerCase()).forEach(b=>{dt.forEach(C=>{(Ys[C]||[]).forEach(R=>{b.includes(R.toLowerCase())&&(u[C]=(u[C]||0)+1)})})}),{name:h,counts:u}}),s={Reviews:0,Backlinks:0,"PR Coverage":0,"Certifications/Awards":0};y.forEach(c=>dt.forEach(h=>{s[h]+=c.counts[h]})),Math.max(1,...Object.values(s));const l={Reviews:"bg-sky-400",Backlinks:"bg-emerald-400","PR Coverage":"bg-amber-400","Certifications/Awards":"bg-rose-400"};return e.jsxs(it,{title:"Authority Signals",icon:e.jsx(Fe,{className:"w-5 h-5 text-blue-600"}),iconBgColor:"bg-gray-200",tooltip:"Shows trust signals that make AI recommend competitors: Reviews (Trustpilot, Google), Backlinks (high DA sites), PR Coverage (Forbes, TechCrunch), Certifications/Awards. Stacked bars show per-competitor breakdown, donut shows overall distribution. Helps understand what builds AI trust.",children:[e.jsx("div",{className:"flex items-center gap-4 text-sm mb-3",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("span",{className:"inline-flex items-center gap-1 text-gray-800",children:[e.jsx("span",{className:"inline-block w-3 h-3 rounded bg-sky-400"})," Reviews"]}),e.jsxs("span",{className:"inline-flex items-center gap-1 text-gray-800",children:[e.jsx("span",{className:"inline-block w-3 h-3 rounded bg-emerald-400"})," Backlinks"]}),e.jsxs("span",{className:"inline-flex items-center gap-1 text-gray-800",children:[e.jsx("span",{className:"inline-block w-3 h-3 rounded bg-amber-400"})," PR Coverage"]}),e.jsxs("span",{className:"inline-flex items-center gap-1 text-gray-800",children:[e.jsx("span",{className:"inline-block w-3 h-3 rounded bg-rose-400"})," Certifications/Awards"]})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsx("div",{className:"flex items-end gap-3 overflow-x-auto",children:y.map(c=>{const h=dt.reduce((u,T)=>u+(c.counts[T]||0),0)||1;return e.jsxs("div",{className:"flex flex-col items-center flex-shrink-0",children:[e.jsxs("div",{className:"w-20 h-40 bg-gray-100 rounded-md overflow-hidden flex flex-col justify-end",children:[e.jsx("div",{className:"bg-rose-400",style:{height:`${c.counts["Certifications/Awards"]/h*100}%`}}),e.jsx("div",{className:"bg-amber-400",style:{height:`${c.counts["PR Coverage"]/h*100}%`}}),e.jsx("div",{className:"bg-emerald-400",style:{height:`${c.counts.Backlinks/h*100}%`}}),e.jsx("div",{className:"bg-sky-400",style:{height:`${c.counts.Reviews/h*100}%`}})]}),e.jsx("div",{className:"mt-2 text-xs font-medium text-gray-800",children:c.name}),e.jsx("div",{className:"text-[11px] text-gray-600",children:h})]},c.name)})}),e.jsxs("div",{className:"flex items-center gap-8",children:[e.jsxs("div",{className:"relative",style:{width:220,height:220},children:[e.jsx("div",{className:"absolute inset-0 rounded-full border-[18px] border-sky-400"}),e.jsx("div",{className:"absolute inset-6 rounded-full border-[18px] border-emerald-400"}),e.jsx("div",{className:"absolute inset-12 rounded-full border-[18px] border-amber-400"}),e.jsx("div",{className:"absolute inset-[72px] rounded-full border-[18px] border-rose-400 flex items-center justify-center text-sm font-semibold",children:dt.reduce((c,h)=>c+(s[h]||0),0)})]}),e.jsx("div",{className:"text-sm",children:dt.map(c=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`inline-block w-3 h-3 rounded ${l[c]}`}),e.jsx("span",{className:"w-40 text-gray-800",children:c}),e.jsx("span",{className:"text-gray-700",children:s[c]})]},c))})]})]})]})}const Ct=["Reddit","Quora","Trustpilot","Forums"],kt=["Safe checkout","Fast shipping","Return policy","Trusted reviews","Authenticity"],Vt={Reddit:["reddit"],Quora:["quora"],Trustpilot:["trustpilot"],Forums:["forum"]},_t={"Safe checkout":["safe","secure","trusted","checkout"],"Fast shipping":["fast shipping","next-day","prime","quick delivery"],"Return policy":["return","refund","policy"],"Trusted reviews":["review","rating","trustpilot","reddit","quora"],Authenticity:["authentic","genuine","fake","scam"]};function Zs({result:t}){const o=Array.isArray(t?.competitors)?t.competitors:[],y={},s={Reddit:0,Quora:0,Trustpilot:0,Forums:0},l={"Safe checkout":0,"Fast shipping":0,"Return policy":0,"Trusted reviews":0,Authenticity:0};o.length>0&&o.forEach(b=>{const C=b?.name||"Unknown";if(b?.faq&&Array.isArray(b.faq)&&b.faq.length>0)y[C]=b.faq.length,b.faq.forEach($=>{const R=($.source||"").toLowerCase(),q=($.question||"").toLowerCase(),L=($.answer||"").toLowerCase(),O=`${R} ${q} ${L}`;Ct.forEach(D=>{Vt[D].some(P=>O.includes(P))&&(s[D]+=1)}),kt.forEach(D=>{_t[D].some(P=>O.includes(P))&&(l[D]+=1)})});else{const $=[b?.analysis,b?.breakdowns?.gemini?.analysis,b?.breakdowns?.chatgpt?.analysis,b?.breakdowns?.perplexity?.analysis,b?.breakdowns?.claude?.analysis].filter(q=>q!=null).map(q=>String(q||"").toLowerCase());let R=0;$.forEach(q=>{(q.includes("where can i")||q.includes("where to buy")||q.includes("faq")||q.includes("question"))&&(R+=1),Ct.forEach(L=>{Vt[L].some(O=>q.includes(O))&&(s[L]+=1)}),kt.forEach(L=>{_t[L].some(O=>q.includes(O))&&(l[L]+=1)})}),y[C]=R}});const c=Object.entries(y).sort((b,C)=>C[1]-b[1]),h=Math.max(1,...c.map(b=>b[1])),u=Math.max(1,...Object.values(s)),T=Math.max(1,...Object.values(l));return e.jsxs(it,{title:"FAQ / Conversational Mentions",icon:e.jsx(Fe,{className:"w-5 h-5 text-blue-600"}),iconBgColor:"bg-gray-200",tooltip:"Shows competitors mentioned in Q&A-style AI responses (like 'Where can I buy X safely?'). Includes source breakdown (Reddit, Quora, Trustpilot, Forums) and common themes (safe checkout, fast shipping, return policy). Captures conversational search intent and trust-building mentions.",children:[e.jsx("div",{className:"text-xs text-gray-600 mb-3",children:"Counts of FAQ-style mentions, sources referenced, and common themes."}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold mb-2 text-gray-800",children:"Competitor FAQ Mentions"}),e.jsx("div",{className:"w-full overflow-x-auto",children:e.jsxs("div",{className:"min-w-[640px] flex items-end gap-4 px-1 py-2",children:[e.jsxs("div",{className:"flex flex-col h-56 pr-2 text-[10px] text-gray-500 select-none justify-between",children:[e.jsx("span",{children:"100"}),e.jsx("span",{children:"80"}),e.jsx("span",{children:"60"}),e.jsx("span",{children:"40"}),e.jsx("span",{children:"20"}),e.jsx("span",{children:"0"})]}),c.map(([b,C])=>e.jsxs("div",{className:"flex flex-col items-center w-24",children:[e.jsx("div",{className:"h-56 w-full bg-gray-100 rounded-md overflow-hidden flex items-end justify-center shadow-sm",children:e.jsx("div",{className:"w-14 bg-amber-400",style:{height:`${Number(C)/h*100}%`},title:`${b}: ${C}`})}),e.jsx("div",{className:"mt-2 text-xs text-black font-semibold text-center truncate w-full",title:b,children:b}),e.jsx("div",{className:"text-[11px] text-gray-600",children:C})]},b))]})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold mb-2 text-gray-800",children:"Sources"}),e.jsx("div",{className:"space-y-2",children:Ct.map(b=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-24 text-xs text-gray-700",children:b}),e.jsx("div",{className:"basis-[80%] h-3 bg-gray-100 rounded",children:e.jsx("div",{className:"h-3 rounded bg-sky-400",style:{width:`${s[b]/u*100}%`}})}),e.jsx("div",{className:"w-8 text-right text-xs text-gray-600",children:s[b]})]},b))})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold mb-2 text-gray-800",children:"Themes"}),e.jsx("div",{className:"space-y-2",children:kt.map(b=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-32 text-xs text-gray-700",children:b}),e.jsx("div",{className:"basis-[80%] h-3 bg-gray-100 rounded",children:e.jsx("div",{className:"h-3 rounded bg-rose-400",style:{width:`${l[b]/T*100}%`}})}),e.jsx("div",{className:"w-8 text-right text-xs text-gray-600",children:l[b]})]},b))})]})]})]})]})}function Xs(){const{user:t}=tt(),o=qe(),y=t?.id||t?.email||t?.name||"anonymous",s=`kabini_cleared_product_insights_${y}`,[l,c]=n.useState(""),[h,u]=n.useState(""),[T,b]=n.useState(""),[C,$]=n.useState(""),[R,q]=n.useState(""),[L,O]=n.useState("auto"),[D,P]=n.useState(null),[_,ue]=n.useState(!1),[ee,le]=n.useState(null),[be,ge]=n.useState(!1);n.useEffect(()=>{if(localStorage.getItem(s)==="1"){localStorage.removeItem(s),P(null);return}if(D&&D.competitors&&Array.isArray(D.competitors)&&D.competitors.length>0){console.log("[ProductInsights] Already have meaningful analysis data, skipping restoration");return}try{const M=rt.getLatestAnalysisSession("product-insights",y);M?(console.log("[ProductInsights] Restoring cached analysis data:",M),console.log("[ProductInsights] Session has competitors:",M.data?.competitors?.length||0),M.inputValue&&c(M.inputValue),M.analysisType&&O(M.analysisType),M.data&&(P(M.data),console.log("[ProductInsights] Analysis result set with",M.data?.competitors?.length||0,"competitors")),console.log("[ProductInsights] Cached data restored successfully")):(console.log("[ProductInsights] No session found for user"),P(null),c(""),u(""),b(""),$(""),q(""),O("auto"),le(null))}catch(M){console.error("[ProductInsights] Error restoring cached data:",M),le("Failed to restore previous analysis")}},[y,s]);const fe=async()=>{if(!l.trim()){le("Website URL is required.");return}ue(!0),le(null);try{const m=L==="auto"?"Ecommerce & Retail":L,w=await ye.getAIVisibilityAnalysis(l.trim(),m,{},{productName:h.trim()||void 0,productCategory:T.trim()||void 0,competitorName:C.trim()||void 0,country:R.trim()||void 0});if(w?.success&&w?.data){P(w.data);try{rt.saveAnalysisSession("product-insights",w.data,l.trim(),m,"url",m,y),console.log("[ProductInsights] Analysis results saved to session storage")}catch(M){console.error("[ProductInsights] Error saving analysis results:",M)}}else le(w?.error||"Failed to analyze")}catch(m){le(m?.message||"Failed to analyze")}finally{ue(!1)}},z=m=>{const w=Array.isArray(m?.competitors)?m.competitors:[];if(w.length===0)return 0;const M=w.map(S=>Number(S?.aiTraffic?.totalMentions||S?.mentions||0)),Y=M.reduce((S,g)=>S+g,0)||1;return Math.max(...M)/Y*10},F=m=>{if(!m||!Array.isArray(m?.competitors)||m.competitors.length===0)return 0;const w=m.competitors;let M=0,Y=0;return w.forEach(a=>{const i=Math.min(30,(a?.schemaMarkup||0)*3),S=Math.min(40,(a?.contentQuality||0)*4),g=Math.min(30,(a?.trustSignals||0)*3),ae=i+S+g,re=Number(a?.aiTraffic?.totalMentions||1);M+=ae*re,Y+=re}),Y>0?Math.round(M/Y):0},k=()=>{try{rt.clearSessionsByType("product-insights"),P(null),c(""),u(""),b(""),$(""),q(""),O("auto"),le(null);try{localStorage.setItem(s,"1")}catch{}console.log("[ProductInsights] Analysis data cleared")}catch(m){console.error("[ProductInsights] Error clearing analysis data:",m)}},x=D;return e.jsxs("div",{className:"w-full max-w-full mx-auto space-y-6 lg:space-y-8 px-2 sm:px-4 lg:px-6",children:[e.jsxs("div",{className:"flex flex-col lg:flex-row justify-between items-start gap-4",children:[e.jsx("div",{className:"flex-1 min-w-0",children:e.jsx("button",{className:"text-sm text-gray-900 hover:underline mb-2",onClick:()=>o("/ai-visibility-analysis"),children:"â† Back to Competitor Insight"})}),x&&e.jsxs("button",{className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg font-medium flex items-center gap-2 transition-colors shadow-sm",onClick:k,children:[e.jsx(Ge,{className:"w-4 h-4"}),"New Analysis"]})]}),e.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl p-4 sm:p-6 lg:p-8 shadow-sm",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h2",{className:"text-3xl font-bold text-gray-900 mb-3",children:"Product Analysis Dashboard"}),e.jsx("p",{className:"text-gray-600 text-lg",children:"Enter your product details to get comprehensive product insights and competitive analysis."})]}),e.jsx("div",{className:"bg-gray-50 border border-gray-300 rounded-xl p-4 sm:p-6 mb-6",children:e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:[grid-template-columns:repeat(24,minmax(0,1fr))] gap-3 items-end",children:[e.jsxs("div",{className:"flex flex-col gap-1 lg:col-span-7",children:[e.jsxs("label",{htmlFor:"websiteUrl",className:"text-xs font-semibold text-gray-700",children:["Website URL ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{id:"websiteUrl",type:"text",value:l,onChange:m=>Xe(m,c),onPaste:m=>Ze(m,c),onKeyDown:et,placeholder:"https://example.com",required:!0,className:"h-11 px-3 py-2 border border-gray-300 rounded-lg text-gray-900 text-sm w-full"})]}),e.jsxs("div",{className:"flex flex-col gap-1 lg:col-span-3",children:[e.jsx("label",{htmlFor:"productName",className:"text-xs font-semibold text-gray-700",children:"Product Name"}),e.jsx("input",{id:"productName",type:"text",value:h,onChange:m=>Xe(m,u),onPaste:m=>Ze(m,u),onKeyDown:et,placeholder:"Product Name",className:"h-11 px-3 py-2 border border-gray-300 rounded-lg text-gray-900 text-sm w-full"})]}),e.jsxs("div",{className:"flex flex-col gap-1 lg:col-span-3",children:[e.jsx("label",{htmlFor:"productCategory",className:"text-xs font-semibold text-gray-700",children:"Product Category"}),e.jsxs("select",{id:"productCategory",value:T,onChange:m=>b(m.target.value),className:"h-11 px-3 py-2 border border-gray-300 rounded-lg text-gray-900 text-sm w-full",children:[e.jsx("option",{value:"",children:"Select Category"}),e.jsx("option",{value:"Electronics",children:"Electronics"}),e.jsx("option",{value:"Fashion",children:"Fashion"}),e.jsx("option",{value:"Beauty",children:"Beauty"}),e.jsx("option",{value:"Home and Garden",children:"Home and Garden"}),e.jsx("option",{value:"Sports",children:"Sports"}),e.jsx("option",{value:"Automotive",children:"Automotive"}),e.jsx("option",{value:"Books",children:"Books"}),e.jsx("option",{value:"Health",children:"Health"}),e.jsx("option",{value:"Others",children:"Others"})]})]}),e.jsxs("div",{className:"flex flex-col gap-1 lg:col-span-3",children:[e.jsx("label",{htmlFor:"competitorName",className:"text-xs font-semibold text-gray-700",children:"Known Competitor"}),e.jsx("input",{id:"competitorName",type:"text",value:C,onChange:m=>Xe(m,$),onPaste:m=>Ze(m,$),onKeyDown:et,placeholder:"Known Competitor",className:"h-11 px-3 py-2 border border-gray-300 rounded-lg text-gray-900 text-sm w-full"})]}),e.jsxs("div",{className:"flex flex-col gap-1 lg:col-span-3",children:[e.jsx("label",{htmlFor:"country",className:"text-xs font-semibold text-gray-700",children:"Country"}),e.jsxs("select",{id:"country",value:R,onChange:m=>q(m.target.value),className:"h-11 px-3 py-2 border border-gray-300 rounded-lg text-gray-900 text-sm w-full",children:[e.jsx("option",{value:"",children:"Country"}),e.jsx("option",{value:"United States",children:"United States"}),e.jsx("option",{value:"United Kingdom",children:"United Kingdom"}),e.jsx("option",{value:"Canada",children:"Canada"}),e.jsx("option",{value:"Australia",children:"Australia"}),e.jsx("option",{value:"India",children:"India"}),e.jsx("option",{value:"Germany",children:"Germany"}),e.jsx("option",{value:"France",children:"France"}),e.jsx("option",{value:"Singapore",children:"Singapore"}),e.jsx("option",{value:"United Arab Emirates",children:"United Arab Emirates"}),e.jsx("option",{value:"Others",children:"Others"})]})]}),e.jsxs("div",{className:"flex flex-col gap-1 lg:col-span-3",children:[e.jsx("label",{htmlFor:"industry",className:"text-xs font-semibold text-gray-700",children:"Industry"}),e.jsxs("select",{id:"industry",value:L,onChange:m=>O(m.target.value),className:"h-11 px-3 py-2 border border-gray-300 rounded-lg text-gray-900 text-sm w-full",disabled:_,title:"Select industry",children:[e.jsx("option",{value:"auto",children:"Industry"}),e.jsx("option",{value:"Information Technology & Services",children:"Information Technology & Services"}),e.jsx("option",{value:"Finance",children:"Finance"}),e.jsx("option",{value:"Healthcare",children:"Healthcare"}),e.jsx("option",{value:"Legal",children:"Legal"}),e.jsx("option",{value:"Ecommerce & Retail",children:"Ecommerce & Retail"}),e.jsx("option",{value:"Media",children:"Media"}),e.jsx("option",{value:"Education",children:"Education"}),e.jsx("option",{value:"Marketing & Advertising",children:"Marketing & Advertising"}),e.jsx("option",{value:"Computer Software / Internet",children:"Computer Software / Internet"}),e.jsx("option",{value:"Others",children:"Others"})]})]}),e.jsx("button",{onClick:fe,disabled:_||!l.trim(),className:"h-11 px-4 bg-black hover:bg-gray-800 disabled:bg-gray-400 text-white rounded-lg font-medium flex items-center justify-center gap-2 transition-colors shadow w-full text-sm lg:col-span-2 self-end",children:_?e.jsxs(e.Fragment,{children:[e.jsx(Pe,{className:"w-4 h-4 animate-spin"}),"Analyzing..."]}):e.jsxs(e.Fragment,{children:[e.jsx(ht,{className:"w-4 h-4"}),"Analyse"]})})]})}),ee&&e.jsx("div",{className:"mt-3 text-sm text-red-600",children:ee})]}),x&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsx(Bs,{score:z(x)}),e.jsx(Hs,{score:F(x)})]}),e.jsx(_s,{result:x}),e.jsx(Ws,{result:x}),e.jsx(Js,{result:x}),e.jsx(Zs,{result:x})]})]})}const ea=()=>{const[t]=Wt(),o=qe(),[y,s]=n.useState("loading"),[l,c]=n.useState(""),[h,u]=n.useState(!1),[T,b]=n.useState(""),[C,$]=n.useState(""),R=t.get("token");n.useEffect(()=>{R?q(R):(s("error"),c("No verification token provided"))},[R]);const q=async D=>{try{const P=await fetch("/api/auth/verify-email",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:D})}),_=await P.json();P.ok&&_.success?(s("success"),c(_.message),setTimeout(()=>{o("/login")},3e3)):(_.error.includes("expired")?s("expired"):s("error"),c(_.error))}catch(P){console.error("Email verification error:",P),s("error"),c("Failed to verify email. Please try again.")}},L=async()=>{if(!C){b("Please enter your email address");return}u(!0),b("");try{const D=await fetch("/api/auth/resend-verification",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:C})}),P=await D.json();D.ok&&P.success?b("Verification email sent successfully! Please check your inbox."):b(P.error||"Failed to resend verification email")}catch(D){console.error("Resend verification error:",D),b("Failed to resend verification email. Please try again.")}finally{u(!1)}},O=()=>{switch(y){case"loading":return e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-b-2 border-blue-600 mx-auto mb-4"}),e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Verifying your email..."}),e.jsx("p",{className:"text-gray-600",children:"Please wait while we verify your email address."})]});case"success":return e.jsxs("div",{className:"text-center",children:[e.jsx(Qe,{className:"w-16 h-16 text-green-500 mx-auto mb-4"}),e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Email Verified Successfully!"}),e.jsx("p",{className:"text-gray-600 mb-4",children:l}),e.jsx("p",{className:"text-sm text-gray-500",children:"Redirecting to login page..."})]});case"expired":return e.jsxs("div",{className:"text-center",children:[e.jsx(It,{className:"w-16 h-16 text-red-500 mx-auto mb-4"}),e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Verification Link Expired"}),e.jsx("p",{className:"text-gray-600 mb-6",children:l}),e.jsxs("div",{className:"bg-gray-50 p-6 rounded-lg",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Resend Verification Email"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email Address"}),e.jsx("input",{type:"email",value:C,onChange:D=>$(D.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter your email address"})]}),e.jsx("button",{onClick:L,disabled:h||!C,className:"w-full bg-blue-600 text-white py-2 px-4 rounded-md hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:h?e.jsxs(e.Fragment,{children:[e.jsx(Pt,{className:"w-4 h-4 animate-spin"}),"Sending..."]}):e.jsxs(e.Fragment,{children:[e.jsx(vs,{className:"w-4 h-4"}),"Resend Verification Email"]})}),T&&e.jsx("p",{className:`text-sm ${T.includes("successfully")?"text-green-600":"text-red-600"}`,children:T})]})]})]});case"error":return e.jsxs("div",{className:"text-center",children:[e.jsx(It,{className:"w-16 h-16 text-red-500 mx-auto mb-4"}),e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Verification Failed"}),e.jsx("p",{className:"text-gray-600 mb-6",children:l}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("button",{onClick:()=>o("/login"),className:"w-full bg-blue-600 text-white py-2 px-4 rounded-md hover:bg-blue-700",children:"Go to Login"}),e.jsx("button",{onClick:()=>o("/signup"),className:"w-full bg-gray-600 text-white py-2 px-4 rounded-md hover:bg-gray-700",children:"Create New Account"})]})]});default:return null}};return e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-100 px-4",children:e.jsx("div",{className:"max-w-md w-full bg-white rounded-lg shadow-md p-8",children:O()})})};class ta extends Yt.Component{constructor(o){super(o),this.state={hasError:!1}}static getDerivedStateFromError(o){return{hasError:!0,message:String(o?.message||"Unexpected error")}}componentDidCatch(o,y){console.error("[ErrorBoundary]",o,y)}handleReset=()=>{try{Object.keys(localStorage).forEach(o=>{o.startsWith("structure_analysis_state")&&localStorage.removeItem(o)})}catch{}this.setState({hasError:!1,message:void 0});try{window.location.reload()}catch{}};render(){return this.state.hasError?e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center p-6",children:e.jsxs("div",{className:"max-w-lg w-full bg-white border border-gray-200 rounded-xl p-6 text-center",children:[e.jsx("h2",{className:"text-xl font-bold text-black mb-2",children:"Something went wrong"}),e.jsx("p",{className:"text-sm text-gray-600 mb-4",children:this.state.message||"The page failed to render."}),e.jsx("button",{className:"bg-black text-white px-4 py-2 rounded-lg hover:bg-gray-800",onClick:this.handleReset,children:"Reset Structure Analysis"})]})}):this.props.children}}function sa(){const t=Ft(),o=qe(),{content:y="",url:s=""}=t.state||{},l=()=>{o(-1)};return e.jsx(ta,{fallbackMessage:"Structure analysis failed. Click reset and then Restore Last Analysis to reload your previous results.",children:e.jsx(us,{content:y,url:s,onBack:l})})}const aa=({password:t,className:o=""})=>{const y=/[A-Z]/.test(t),s=/[a-z]/.test(t),l=/\d/.test(t),c=/[!@#$%^&*()_+\-=\[\]{};':"\\|,.<>\/?]/.test(t),h=t.length>=8,u=y&&s&&l&&c&&h;return t.length===0?null:e.jsx("div",{className:`text-sm ${u?"text-green-600":"text-red-600"} ${o}`,children:u?"âœ… Password meets all requirements":"âŒ Password must contain: at least 8 characters, one uppercase letter, one lowercase letter, one number, and one special character"})},ra=()=>{const[t,o]=n.useState({firstName:"",lastName:"",email:"",password:"",confirmPassword:""}),[y,s]=n.useState(""),[l,c]=n.useState(""),[h,u]=n.useState(!1),[T,b]=n.useState(!1),[C,$]=n.useState(!1),[R,q]=n.useState(!1),[L,O]=n.useState(null),[D,P]=n.useState(!0),_=qe(),{login:ue,error:ee,clearError:le,isAuthenticated:be}=tt(),{handleInputChangeAggressive:ge,handlePaste:fe,handleKeyDown:z}=Lt();n.useEffect(()=>{const k=setTimeout(()=>{P(!1)},100);return()=>clearTimeout(k)},[]),n.useEffect(()=>{const k=async()=>{if(be){console.log("[SignUp] User is authenticated via AuthContext, redirecting to overview..."),_("/overview",{replace:!0});return}if(Tt.isAuthenticated()){console.log("[SignUp] User is authenticated via authService, redirecting to overview..."),_("/overview",{replace:!0});return}};k();const x=setInterval(k,100);return()=>clearInterval(x)},[_,be]);const F=async k=>{if(k.preventDefault(),s(""),c(""),O(null),!t.firstName.trim()){s("First name is required");return}if(!t.lastName.trim()){s("Last name is required");return}if(!t.email.trim()){s("Email is required");return}if(!t.password.trim()){s("Password is required");return}if(!t.confirmPassword.trim()){s("Please confirm your password");return}const x=/^[A-Za-z]+$/;if(!x.test(t.firstName)){if(/[\u{1F600}-\u{1F64F}]|[\u{1F300}-\u{1F5FF}]|[\u{1F680}-\u{1F6FF}]|[\u{1F1E0}-\u{1F1FF}]|[\u{2600}-\u{26FF}]|[\u{2700}-\u{27BF}]/u.test(t.firstName)){s("First name cannot contain emojis");return}if(/[^A-Za-z]/.test(t.firstName)){s("First name can only contain letters (A-Z, a-z). No numbers, spaces, or special characters allowed.");return}s("First name can contain only letters (A-Z, a-z)");return}if(!x.test(t.lastName)){if(/[\u{1F600}-\u{1F64F}]|[\u{1F300}-\u{1F5FF}]|[\u{1F680}-\u{1F6FF}]|[\u{1F1E0}-\u{1F1FF}]|[\u{2600}-\u{26FF}]|[\u{2700}-\u{27BF}]/u.test(t.lastName)){s("Last name cannot contain emojis");return}if(/[^A-Za-z]/.test(t.lastName)){s("Last name can only contain letters (A-Z, a-z). No numbers, spaces, or special characters allowed.");return}s("Last name can contain only letters (A-Z, a-z)");return}if(t.firstName.trim().length<2){s("First name must be at least 2 characters long");return}if(t.firstName.trim().length>30){s("First name cannot exceed 30 characters");return}if(t.lastName.trim().length<2){s("Last name must be at least 2 characters long");return}if(t.lastName.trim().length>30){s("Last name cannot exceed 30 characters");return}const m=Ve(t.email);if(!m.isValid){c(_e(t.email,m));return}c("");const w=t.password;if(w.length<4){s("Password must be at least 4 characters long");return}if(w.length>128){s("Password cannot exceed 128 characters");return}if(!/[A-Z]/.test(w)){s("Password must contain at least one uppercase letter (A-Z)");return}if(!/[a-z]/.test(w)){s("Password must contain at least one lowercase letter (a-z)");return}if(!/\d/.test(w)){s("Password must contain at least one number (0-9)");return}if(!/[!@#$%^&*()_+\-=\[\]{};':"\\|,.<>\/?]/.test(w)){s("Password must contain at least one special character (!@#$%^&*()_+-=[]{};':\"\\|,.<>/?`)");return}if(/(.)\1{2,}/.test(w)){s("Password cannot contain 3 or more repeated characters");return}if(/abc|bcd|cde|def|efg|fgh|ghi|hij|ijk|jkl|klm|lmn|mno|nop|opq|pqr|qrs|rst|stu|tuv|uvw|vwx|wxy|xyz/i.test(w)){s("Password cannot contain sequential characters (abc, 123, etc.)");return}if(/qwerty|asdfgh|zxcvbn|123456|654321/i.test(w)){s("Password cannot contain common keyboard patterns");return}if(t.password!==t.confirmPassword){s("Passwords do not match");return}u(!0),le();try{const M=await Tt.register({email:t.email,password:t.password,name:`${t.firstName} ${t.lastName}`,displayName:`${t.firstName} ${t.lastName}`});M.success?(console.log("[SignUp] Sign up successful"),M.emailVerificationRequired?(O(""),s(""),c(""),O("Account created successfully! Please check your email to verify your account before logging in."),setTimeout(()=>{_("/login",{state:{message:"Account created successfully! Please check your email to verify your account.",email:t.email}})},3e3)):(O(""),s(""),c(""),console.log("[SignUp] Forcing immediate navigation to overview..."),_("/overview",{replace:!0}))):s(M.error||"Sign up failed. Please try again.")}catch(M){console.error("[SignUp] Sign up error:",M);let Y="Sign up failed. Please try again.";M&&typeof M=="object"&&(M.message&&typeof M.message=="string"?M.message.includes("already exists")||M.message.includes("duplicate")?Y="Account already exists on this email":M.message.includes("Network")||M.message.includes("fetch")?Y="Network error. Please check your connection and try again.":Y=M.message:M.error&&typeof M.error=="string"&&(M.error.includes("already exists")||M.error.includes("duplicate")?Y="Account already exists on this email":M.error.includes("Network")||M.error.includes("connection")?Y="Network error. Please check your connection and try again.":Y=M.error)),console.log("[SignUp] Setting authentication error message:",Y),O(Y),s(""),c("")}finally{u(!1)}};return e.jsxs("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-blue-100 via-indigo-100 to-purple-100 px-4 relative overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-blue-300/30 via-indigo-300/30 to-purple-300/30"}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-tr from-cyan-200/20 via-blue-200/20 to-indigo-200/20"}),e.jsx("div",{className:"absolute top-0 left-0 w-96 h-96 bg-gradient-to-br from-blue-400/40 to-cyan-400/40 rounded-full blur-3xl -translate-x-1/2 -translate-y-1/2 animate-pulse"}),e.jsx("div",{className:"absolute bottom-0 right-0 w-[500px] h-[500px] bg-gradient-to-tl from-purple-400/40 to-pink-400/40 rounded-full blur-3xl translate-x-1/2 translate-y-1/2 animate-pulse",style:{animationDelay:"1s"}}),e.jsx("div",{className:"absolute top-1/2 left-1/2 w-80 h-80 bg-gradient-to-r from-indigo-400/35 to-blue-400/35 rounded-full blur-3xl -translate-x-1/2 -translate-y-1/2 animate-pulse",style:{animationDelay:"2s"}}),e.jsx("div",{className:"absolute top-1/4 right-1/4 w-32 h-32 bg-gradient-to-br from-cyan-300/30 to-blue-300/30 rounded-full blur-2xl animate-bounce",style:{animationDelay:"0.5s"}}),e.jsx("div",{className:"absolute bottom-1/4 left-1/4 w-24 h-24 bg-gradient-to-br from-purple-300/30 to-pink-300/30 rounded-full blur-2xl animate-bounce",style:{animationDelay:"1.5s"}}),e.jsxs("div",{className:"w-full max-w-md mx-auto p-8 bg-white/90 backdrop-blur-md rounded-2xl shadow-2xl border border-white/30 relative z-10 bg-gradient-to-br from-white/95 via-white/90 to-white/95",children:[e.jsxs("div",{className:"text-center mb-10",children:[e.jsx("div",{className:"w-24 h-24 bg-black rounded-2xl flex items-center justify-center mx-auto mb-6 shadow-lg",children:e.jsx(nt,{className:"w-12 h-12 text-white"})}),e.jsx("h1",{className:"text-4xl font-bold text-black mb-3",children:"Create your account"}),e.jsx("p",{className:"text-gray-600 text-lg",children:"Sign up to get started with kabini.ai"})]}),e.jsxs("form",{onSubmit:F,className:"space-y-8",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-bold text-gray-900 mb-2",children:["First Name ",e.jsx("span",{className:"text-red-600",children:"*"})]}),e.jsx("input",{type:"text",name:"firstName",value:t.firstName,onChange:k=>ge(k,x=>{const m=x.replace(/[^A-Za-z]/g,"");if(/[\u{1F600}-\u{1F64F}]|[\u{1F300}-\u{1F5FF}]|[\u{1F680}-\u{1F6FF}]|[\u{1F1E0}-\u{1F1FF}]|[\u{2600}-\u{26FF}]|[\u{2700}-\u{27BF}]/u.test(x)){s("First name cannot contain emojis");return}o(w=>({...w,firstName:m})),y&&s(""),l&&c("")}),onPaste:k=>fe(k,x=>{const m=x.replace(/[^A-Za-z]/g,"");o(w=>({...w,firstName:m}))}),onKeyDown:z,onCompositionStart:k=>k.preventDefault(),onCompositionUpdate:k=>k.preventDefault(),onCompositionEnd:k=>k.preventDefault(),required:!0,placeholder:"Enter your first name *",pattern:"[A-Za-z]+",autoComplete:"off","data-form-type":"other",readOnly:D,className:"w-full px-4 py-4 border-2 border-gray-300 rounded-xl text-gray-900 placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-black focus:border-black transition-all"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-bold text-gray-900 mb-2",children:["Last Name ",e.jsx("span",{className:"text-red-600",children:"*"})]}),e.jsx("input",{type:"text",name:"lastName",value:t.lastName,onChange:k=>ge(k,x=>{const m=x.replace(/[^A-Za-z]/g,"");if(/[\u{1F600}-\u{1F64F}]|[\u{1F300}-\u{1F5FF}]|[\u{1F680}-\u{1F6FF}]|[\u{1F1E0}-\u{1F1FF}]|[\u{2600}-\u{26FF}]|[\u{2700}-\u{27BF}]/u.test(x)){s("Last name cannot contain emojis");return}o(w=>({...w,lastName:m})),y&&s(""),l&&c("")}),onPaste:k=>fe(k,x=>{const m=x.replace(/[^A-Za-z]/g,"");o(w=>({...w,lastName:m}))}),onKeyDown:z,onCompositionStart:k=>k.preventDefault(),onCompositionUpdate:k=>k.preventDefault(),onCompositionEnd:k=>k.preventDefault(),required:!0,placeholder:"Enter your last name *",pattern:"[A-Za-z]+",autoComplete:"off","data-form-type":"other",readOnly:D,className:"w-full px-4 py-4 border-2 border-gray-300 rounded-xl text-gray-900 placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-black focus:border-black transition-all"})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-bold text-gray-900 mb-2",children:["Email ",e.jsx("span",{className:"text-red-600",children:"*"})]}),e.jsx("input",{type:"email",name:"email",value:t.email,onChange:k=>ge(k,x=>{const m=ot(x);if(o(w=>({...w,email:m})),y&&s(""),l&&c(""),!m.trim())c("");else{const w=Ve(m);w.isValid?c(""):c(_e(m,w))}}),onPaste:k=>fe(k,x=>{const m=ot(x);o(M=>({...M,email:m}));const w=Ve(m);w.isValid?c(""):c(_e(m,w))}),onKeyDown:z,onCompositionStart:k=>k.preventDefault(),onCompositionUpdate:k=>k.preventDefault(),onCompositionEnd:k=>k.preventDefault(),required:!0,autoComplete:"off","data-form-type":"other",readOnly:D,placeholder:"Enter your email address *",className:`w-full px-4 py-4 border-2 rounded-xl text-gray-900 placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-black focus:border-black transition-all ${l?"border-red-500 focus:ring-red-500 focus:border-red-500":"border-gray-300"}`}),l&&e.jsx("div",{className:"mt-2 text-sm text-red-600",children:"Please enter valid email address"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-bold text-gray-900 mb-2",children:["Password ",e.jsx("span",{className:"text-red-600",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:T?"text":"password",name:"password",value:t.password,onChange:k=>ge(k,x=>{o(S=>({...S,password:x})),y&&s(""),l&&c("");const m=/[A-Z]/.test(x),w=/[a-z]/.test(x),M=/\d/.test(x),Y=/[!@#$%^&*()_+\-=\[\]{};':"\\|,.<>\/?]/.test(x),a=x.length>=8,i=m&&w&&M&&Y&&a;q(i),i&&s("")}),onPaste:k=>fe(k,x=>{o(S=>({...S,password:x}));const m=/[A-Z]/.test(x),w=/[a-z]/.test(x),M=/\d/.test(x),Y=/[!@#$%^&*()_+\-=\[\]{};':"\\|,.<>\/?]/.test(x),a=x.length>=8,i=m&&w&&M&&Y&&a;q(i),i&&s("")}),onKeyDown:z,onCompositionStart:k=>k.preventDefault(),onCompositionUpdate:k=>k.preventDefault(),onCompositionEnd:k=>k.preventDefault(),required:!0,autoComplete:"new-password","data-form-type":"other",readOnly:D,placeholder:"Create a password *",className:"w-full px-4 pr-12 py-4 border-2 border-gray-300 rounded-xl text-gray-900 placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-black focus:border-black transition-all"}),e.jsx("button",{type:"button",onClick:()=>b(!T),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600 transition-colors focus:outline-none",tabIndex:-1,"aria-label":T?"Hide password":"Show password",children:T?e.jsx(ut,{className:"w-5 h-5"}):e.jsx(Ke,{className:"w-5 h-5"})})]}),e.jsx(aa,{password:t.password,className:"mt-3"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-bold text-gray-900 mb-2",children:["Confirm Password ",e.jsx("span",{className:"text-red-600",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:C?"text":"password",name:"confirmPassword",value:t.confirmPassword,onChange:k=>ge(k,x=>{o(m=>({...m,confirmPassword:x})),y&&s("")}),onPaste:k=>fe(k,x=>{o(m=>({...m,confirmPassword:x}))}),onKeyDown:z,onCompositionStart:k=>k.preventDefault(),onCompositionUpdate:k=>k.preventDefault(),onCompositionEnd:k=>k.preventDefault(),required:!0,autoComplete:"new-password","data-form-type":"other",readOnly:D,placeholder:"Re-enter your password *",className:"w-full px-4 pr-12 py-4 border-2 border-gray-300 rounded-xl text-gray-900 placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-black focus:border-black transition-all"}),e.jsx("button",{type:"button",onClick:()=>$(!C),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600 transition-colors focus:outline-none",tabIndex:-1,"aria-label":C?"Hide confirm password":"Show confirm password",children:C?e.jsx(ut,{className:"w-5 h-5"}):e.jsx(Ke,{className:"w-5 h-5"})})]})]}),e.jsx("button",{type:"submit",disabled:h,className:"w-full bg-black text-white font-bold py-4 px-6 rounded-xl hover:bg-gray-800 transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2 shadow-lg transform hover:scale-[1.02]",children:h?e.jsx(Pe,{className:"w-5 h-5 animate-spin"}):"Create Account"})]}),e.jsx("div",{className:"mt-6 text-center",children:e.jsx("span",{onClick:()=>_("/login"),className:"text-sm text-black hover:text-gray-700 underline hover:no-underline transition-colors cursor-pointer",children:"Already have an account? Sign in"})})]}),e.jsx(gt,{error:L||ee,onClose:()=>{O(null),le()},autoClose:!0,autoCloseDelay:5e3})]})},na=()=>{const[t,o]=n.useState(""),[y,s]=n.useState(!1),[l,c]=n.useState(null),[h,u]=n.useState(null),[T,b]=n.useState(!1),C=qe(),{handleInputChangeAggressive:$,handlePaste:R,handleKeyDown:q}=Lt(),L=async O=>{if(O.preventDefault(),console.log("[ForgotPassword] Form submitted, clearing previous errors"),c(""),!t||!t.trim()){console.log("[ForgotPassword] Email is empty, setting validation error"),u("Please enter your email address");return}try{const D=Ve(t);if(!D||!D.isValid){console.log("[ForgotPassword] Email validation failed, setting validation error"),u(_e(t,D));return}}catch(D){console.log("[ForgotPassword] Email validation error:",D),u("Please enter a valid email address");return}console.log("[ForgotPassword] Starting API call to forgot-password endpoint"),b(!0);try{const D=await fetch("/api/auth/forgot-password",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:t.trim()})}),P=await D.json();console.log("[ForgotPassword] Response:",D.status,P),D.ok?(console.log("[ForgotPassword] Password reset email sent successfully"),s(!0)):(console.error("[ForgotPassword] Failed to send reset email:",P.error),c(P.error||"Failed to send reset email. Please try again."))}catch(D){console.error("[ForgotPassword] Error during forgot password request:",D),c("Network error. Please check your connection and try again.")}finally{b(!1)}};return e.jsxs("div",{className:"min-h-screen flex items-center justify-center bg-gray-100 px-4 relative overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 bg-gray-200/30"}),e.jsx("div",{className:"absolute inset-0 bg-gray-300/20"}),e.jsx("div",{className:"absolute top-0 left-0 w-96 h-96 bg-gradient-to-br from-blue-400/40 to-cyan-400/40 rounded-full blur-3xl -translate-x-1/2 -translate-y-1/2 animate-pulse"}),e.jsx("div",{className:"absolute bottom-0 right-0 w-[500px] h-[500px] bg-gradient-to-tl from-purple-400/40 to-pink-400/40 rounded-full blur-3xl translate-x-1/2 translate-y-1/2 animate-pulse",style:{animationDelay:"1s"}}),e.jsx("div",{className:"absolute top-1/2 left-1/2 w-80 h-80 bg-gradient-to-r from-indigo-400/35 to-blue-400/35 rounded-full blur-3xl -translate-x-1/2 -translate-y-1/2 animate-pulse",style:{animationDelay:"2s"}}),e.jsx("div",{className:"absolute top-1/4 right-1/4 w-32 h-32 bg-gradient-to-br from-cyan-300/30 to-blue-300/30 rounded-full blur-2xl animate-bounce",style:{animationDelay:"0.5s"}}),e.jsx("div",{className:"absolute bottom-1/4 left-1/4 w-24 h-24 bg-gradient-to-br from-purple-300/30 to-pink-300/30 rounded-full blur-2xl animate-bounce",style:{animationDelay:"1.5s"}}),e.jsxs("div",{className:"w-full max-w-md mx-auto p-8 bg-white/90 backdrop-blur-md rounded-2xl shadow-2xl border border-white/30 relative z-10 bg-gradient-to-br from-white/95 via-white/90 to-white/95",children:[e.jsxs("div",{className:"text-center mb-10",children:[e.jsx("div",{className:"w-24 h-24 bg-black rounded-2xl flex items-center justify-center mx-auto mb-6 shadow-lg",children:e.jsx(nt,{className:"w-12 h-12 text-white"})}),e.jsx("h1",{className:"text-4xl font-bold text-black mb-3",children:"Forgot your password?"}),e.jsx("p",{className:"text-gray-600 text-lg",children:"Enter your email address and we'll send you a link to reset your password."})]}),y?e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-6 mb-6",children:[e.jsx("div",{className:"text-green-600 font-semibold mb-2",children:"Check your email"}),e.jsxs("div",{className:"text-gray-600 text-sm",children:["If an account with that email exists, a reset link has been sent to ",e.jsx("strong",{children:t}),"."]})]}),e.jsxs("button",{onClick:()=>C("/login"),className:"w-full bg-black text-white font-bold py-4 px-6 rounded-xl hover:bg-gray-800 transition-all duration-200 flex items-center justify-center gap-2 shadow-lg transform hover:scale-[1.02]",children:[e.jsx(jt,{className:"w-5 h-5"}),"Back to Login"]})]}):e.jsxs("form",{onSubmit:L,className:"space-y-8",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-bold text-gray-900 mb-3",children:["Email ",e.jsx("span",{className:"text-red-600",children:"*"})]}),e.jsx("input",{type:"email",value:t,onChange:O=>$(O,D=>{const P=ot(D);o(P);const _=Ve(P);_.isValid?u(null):u(_e(P,_))}),onPaste:O=>R(O,D=>{const P=ot(D);o(P);const _=Ve(P);_.isValid?u(null):u(_e(P,_))}),onKeyDown:q,onCompositionStart:O=>O.preventDefault(),onCompositionUpdate:O=>O.preventDefault(),onCompositionEnd:O=>O.preventDefault(),required:!0,placeholder:"Enter your email address *",className:`w-full px-4 py-4 border-2 rounded-xl text-gray-900 placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-black focus:border-black transition-all ${h?"border-red-500 focus:ring-red-500 focus:border-red-500":"border-gray-300"}`}),h&&e.jsx("div",{className:"mt-2 text-sm text-red-600",children:"Please enter valid email address"})]}),e.jsx("button",{type:"submit",disabled:T||!!h,className:"w-full bg-black text-white font-bold py-4 px-6 rounded-xl hover:bg-gray-800 transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2 shadow-lg transform hover:scale-[1.02]",children:T?e.jsx(Pe,{className:"w-5 h-5 animate-spin"}):"Send Reset Link"}),e.jsxs("button",{type:"button",onClick:()=>C("/login"),className:"w-full bg-black text-white font-bold py-4 px-6 rounded-xl hover:bg-gray-800 transition-all duration-200 flex items-center justify-center gap-2 shadow-lg transform hover:scale-[1.02]",children:[e.jsx(jt,{className:"w-5 h-5"}),"Back to Login"]})]})]}),e.jsx(gt,{error:l,onClose:()=>c(null),autoClose:!0,autoCloseDelay:5e3,type:"error"})]})},oa=()=>{const[t]=Wt(),[o,y]=n.useState({password:"",confirmPassword:""}),[s,l]=n.useState(""),[c,h]=n.useState(!1),[u,T]=n.useState(!1),[b,C]=n.useState(!1),[$,R]=n.useState(!0),[q,L]=n.useState(!1),[O,D]=n.useState(!1),[P,_]=n.useState(!1),ue=qe(),ee=t.get("token");n.useEffect(()=>{if(!ee){l("Invalid reset link. Please request a new password reset."),R(!1);return}console.log("[ResetPassword] Token found in URL, showing reset form"),C(!0),R(!1)},[ee]);const le=fe=>{const{name:z,value:F}=fe.target;if(y({...o,[z]:F}),z==="password"){const k=F.length>=8&&/[a-z]/.test(F)&&/[A-Z]/.test(F)&&/\d/.test(F);_(k)}},be=()=>o.password?o.confirmPassword?o.password.length<8?(l("Password must be at least 8 characters long"),!1):/(?=.*[a-z])/.test(o.password)?/(?=.*[A-Z])/.test(o.password)?/(?=.*\d)/.test(o.password)?o.password!==o.confirmPassword?(l("Passwords do not match"),!1):!0:(l("Password must contain at least one number"),!1):(l("Password must contain at least one uppercase letter"),!1):(l("Password must contain at least one lowercase letter"),!1):(l("Please confirm your password"),!1):(l("Password is required"),!1),ge=async fe=>{if(fe.preventDefault(),l(""),!!be()){if(!ee){l("Invalid reset token. Please request a new password reset.");return}h(!0);try{console.log("[ResetPassword] Attempting to reset password with token:",ee);const z=await fetch("/api/auth/reset-password",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:ee,newPassword:o.password})}),F=await z.json();console.log("[ResetPassword] Response:",z.status,F),z.ok?(console.log("[ResetPassword] Password reset successful"),T(!0)):(console.error("[ResetPassword] Password reset failed:",F.error),l(F.error||"Failed to reset password. Please try again."))}catch(z){console.error("[ResetPassword] Error during password reset:",z),l("Network error. Please check your connection and try again.")}finally{h(!1)}}};return $?e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-100",children:e.jsx("div",{className:"w-full max-w-md mx-auto p-8 bg-white rounded-lg shadow-sm",children:e.jsxs("div",{className:"text-center",children:[e.jsx(Pe,{className:"w-8 h-8 animate-spin mx-auto mb-4 text-blue-600"}),e.jsx("div",{className:"text-gray-600",children:"Verifying reset link..."})]})})}):b?u?e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-100",children:e.jsx("div",{className:"w-full max-w-md mx-auto p-8 bg-white rounded-lg shadow-sm",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-green-100 rounded-lg flex items-center justify-center mx-auto mb-4",children:e.jsx(Qe,{className:"w-8 h-8 text-green-600"})}),e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Password Reset Successfully"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"Your password has been updated. You can now log in with your new password."}),e.jsxs("button",{onClick:()=>ue("/login"),className:"w-full bg-blue-600 text-white font-bold py-3 px-6 rounded-lg hover:bg-blue-700 transition-all flex items-center justify-center gap-2",children:[e.jsx(jt,{className:"w-5 h-5"}),"Back to Login"]})]})})}):e.jsxs("div",{className:"min-h-screen flex items-center justify-center bg-gray-100",children:[e.jsxs("div",{className:"w-full max-w-md mx-auto p-8 bg-white rounded-lg shadow-sm",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("div",{className:"w-16 h-16 bg-blue-100 rounded-lg flex items-center justify-center mx-auto mb-4",children:e.jsx(nt,{className:"w-8 h-8 text-blue-600"})}),e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Reset Your Password"}),e.jsx("p",{className:"text-gray-600",children:"Enter your new password below"})]}),e.jsxs("form",{onSubmit:ge,className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-bold text-gray-900 mb-2",children:["New Password ",e.jsx("span",{className:"text-red-600",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:q?"text":"password",name:"password",value:o.password,onChange:le,required:!0,placeholder:"Enter your new password",className:"w-full px-4 pr-12 py-3 border border-gray-300 rounded-lg text-gray-900 placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all"}),e.jsx("button",{type:"button",onClick:()=>L(!q),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600",tabIndex:-1,"aria-label":q?"Hide password":"Show password",children:q?e.jsx(ut,{className:"w-5 h-5"}):e.jsx(Ke,{className:"w-5 h-5"})})]}),e.jsx("div",{className:`mt-2 text-xs ${P?"text-green-600":"text-gray-500"}`,children:P?"Password meets requirements":"Must be at least 8 characters with uppercase, lowercase, and number"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-bold text-gray-900 mb-2",children:["Confirm New Password ",e.jsx("span",{className:"text-red-600",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:O?"text":"password",name:"confirmPassword",value:o.confirmPassword,onChange:le,required:!0,placeholder:"Re-enter your new password",className:"w-full px-4 pr-12 py-3 border border-gray-300 rounded-lg text-gray-900 placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all"}),e.jsx("button",{type:"button",onClick:()=>D(!O),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600",tabIndex:-1,"aria-label":O?"Hide confirm password":"Show confirm password",children:O?e.jsx(ut,{className:"w-5 h-5"}):e.jsx(Ke,{className:"w-5 h-5"})})]})]}),e.jsx("button",{type:"submit",disabled:c,className:"w-full bg-blue-600 text-white font-bold py-3 px-6 rounded-lg hover:bg-blue-700 transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:c?e.jsx(Pe,{className:"w-5 h-5 animate-spin"}):"Reset Password"})]}),e.jsx("div",{className:"mt-6 text-center",children:e.jsxs("button",{type:"button",onClick:()=>ue("/login"),className:"w-full bg-blue-500 border-2 border-blue-600 text-white hover:bg-blue-600 hover:text-white font-bold py-3 px-6 rounded-lg transition-all duration-200 flex items-center justify-center gap-2 shadow-lg",children:[e.jsx(jt,{className:"w-5 h-5"}),"Back to Login"]})})]}),e.jsx(gt,{error:s,onClose:()=>l(""),autoClose:!0,autoCloseDelay:5e3})]}):e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-100",children:e.jsx("div",{className:"w-full max-w-md mx-auto p-8 bg-white rounded-lg shadow-sm",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-red-100 rounded-lg flex items-center justify-center mx-auto mb-4",children:e.jsx(nt,{className:"w-8 h-8 text-red-600"})}),e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Invalid Reset Link"}),e.jsx("p",{className:"text-gray-600 mb-6",children:s}),e.jsx("button",{onClick:()=>ue("/forgot-password"),className:"w-full bg-blue-600 text-white font-bold py-3 px-6 rounded-lg hover:bg-blue-700 transition-all",children:"Request New Reset Link"})]})})})};function ia(t){const[o,y]=n.useState("integrations");return e.jsxs("div",{className:"p-6 max-w-6xl mx-auto",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-black mb-2",children:"Settings"}),e.jsx("p",{className:"text-gray-600",children:"Manage your integrations, usage, and account preferences"})]}),e.jsx("div",{className:"border-b border-gray-200 mb-8",children:e.jsx("nav",{className:"flex space-x-8",children:[{id:"integrations",label:"Integrations",icon:ts},{id:"usage",label:"Plan Usage & Limits",icon:Fe},{id:"account",label:"Account Settings",icon:Xt}].map(s=>e.jsxs("button",{onClick:()=>y(s.id),className:`flex items-center gap-2 py-4 px-1 border-b-2 font-medium text-sm transition-colors ${o===s.id?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[e.jsx(s.icon,{className:"w-5 h-5"}),s.label]},s.id))})}),o==="integrations"&&e.jsx(la,{}),o==="usage"&&e.jsx(ca,{}),o==="account"&&e.jsx(da,{})]})}function la(){const[t,o]=n.useState({cms:{wordpress:!1,webflow:!1},analytics:{ga4:!1,searchConsole:!1},ecommerce:{shopify:!1,bigcommerce:!1,woocommerce:!1,magento:!1}}),y=[{category:"CMS Platforms",description:"Connect with your content management systems",integrations:[{id:"wordpress",name:"WordPress",icon:Ge,status:t.cms.wordpress},{id:"webflow",name:"Webflow",icon:ss,status:t.cms.webflow}]},{category:"Analytics & Monitoring",description:"Track performance and user behavior",integrations:[{id:"ga4",name:"Google Analytics 4",icon:Fe,status:t.analytics.ga4},{id:"searchConsole",name:"Google Search Console",icon:js,status:t.analytics.searchConsole}]},{category:"E-commerce Platforms",description:"Integrate with your online stores",integrations:[{id:"shopify",name:"Shopify",icon:mt,status:t.ecommerce.shopify},{id:"bigcommerce",name:"BigCommerce",icon:mt,status:t.ecommerce.bigcommerce},{id:"woocommerce",name:"WooCommerce",icon:mt,status:t.ecommerce.woocommerce},{id:"magento",name:"Magento",icon:mt,status:t.ecommerce.magento}]}],s=(l,c)=>{o(h=>{const u=l,T=c;return{...h,[u]:{...h[u],[T]:!h[u][T]}}})};return e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-black mb-2",children:"Integrations"}),e.jsx("p",{className:"text-gray-600",children:"Connect with CMS platforms, analytics tools, and e-commerce systems to enhance your content optimization workflow."})]}),y.map((l,c)=>e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-black mb-1",children:l.category}),e.jsx("p",{className:"text-gray-600",children:l.description})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:l.integrations.map(h=>e.jsxs("div",{className:`border rounded-lg p-4 cursor-pointer transition-all ${h.status?"border-green-200 bg-green-50":"border-gray-200 bg-white hover:border-gray-300"}`,onClick:()=>s(l.category==="CMS Platforms"?"cms":l.category==="Analytics & Monitoring"?"analytics":"ecommerce",h.id),children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx(h.icon,{className:`w-6 h-6 ${h.status?"text-green-600":"text-gray-400"}`}),h.status?e.jsx(Qe,{className:"w-5 h-5 text-green-600"}):e.jsx(It,{className:"w-5 h-5 text-gray-400"})]}),e.jsx("h4",{className:"font-medium text-black mb-1",children:h.name}),e.jsx("p",{className:"text-sm text-gray-600",children:h.status?"Connected":"Not connected"})]},h.id))})]},c)),e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(Ns,{className:"w-5 h-5 text-black"}),e.jsx("h3",{className:"text-lg font-bold text-black",children:"Shopify Integration"})]}),e.jsx(ma,{})]})]})}function ca(){const[t]=n.useState({analyses:{used:45,limit:100,type:"Content Analyses"},generations:{used:23,limit:50,type:"AI Generations"},monitoring:{used:12,limit:25,type:"Monitoring Jobs"}}),o=(s,l)=>Math.round(s/l*100),y=s=>s>=90?"text-red-600 bg-red-50":s>=75?"text-yellow-600 bg-yellow-50":"text-green-600 bg-green-50";return e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-black mb-2",children:"Plan Usage & Limits"}),e.jsx("p",{className:"text-gray-600",children:"Track your current usage against your plan limits and monitor quota consumption."})]}),e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:Object.entries(t).map(([s,l])=>{const c=o(l.used,l.limit),h=y(c);return e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"font-semibold text-black",children:l.type}),e.jsxs("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${h}`,children:[c,"% used"]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("div",{className:"flex justify-between text-sm text-gray-600 mb-2",children:[e.jsxs("span",{children:[l.used," used"]}),e.jsxs("span",{children:[l.limit," limit"]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:`h-2 rounded-full transition-all ${c>=90?"bg-red-500":c>=75?"bg-yellow-500":"bg-green-500"}`,style:{width:`${Math.min(c,100)}%`}})})]}),e.jsxs("div",{className:"text-sm text-gray-600",children:[l.limit-l.used," remaining"]})]},s)})}),e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-6",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(wt,{className:"w-5 h-5 text-blue-600 mt-0.5"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-blue-900 mb-1",children:"Usage Tips"}),e.jsx("p",{className:"text-blue-800 text-sm",children:"Monitor your usage regularly to avoid hitting limits. Consider upgrading your plan if you're consistently approaching your limits."})]})]})})]})}function da(){const[t,o]=n.useState({workspace:"My Workspace",timezone:"UTC-8 (Pacific Time)",notifications:{email:!0,push:!1,weekly:!0}}),[y]=n.useState([{name:"John Doe",email:"john@example.com",role:"Admin",status:"Active"},{name:"Jane Smith",email:"jane@example.com",role:"Editor",status:"Active"},{name:"Mike Johnson",email:"mike@example.com",role:"Viewer",status:"Pending"}]);return e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-black mb-2",children:"Account Settings"}),e.jsx("p",{className:"text-gray-600",children:"Manage users, roles, billing, and workspace preferences."})]}),e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-black mb-4",children:"Workspace Settings"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Workspace Name"}),e.jsx("input",{type:"text",value:t.workspace,onChange:s=>o(l=>({...l,workspace:s.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Timezone"}),e.jsxs("select",{value:t.timezone,onChange:s=>o(l=>({...l,timezone:s.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[e.jsx("option",{value:"UTC-8 (Pacific Time)",children:"UTC-8 (Pacific Time)"}),e.jsx("option",{value:"UTC-5 (Eastern Time)",children:"UTC-5 (Eastern Time)"}),e.jsx("option",{value:"UTC+0 (GMT)",children:"UTC+0 (GMT)"}),e.jsx("option",{value:"UTC+1 (CET)",children:"UTC+1 (CET)"})]})]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-black",children:"User Management"}),e.jsxs("button",{className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors flex items-center gap-2",children:[e.jsx(as,{className:"w-4 h-4"}),"Invite User"]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-gray-200",children:[e.jsx("th",{className:"text-left py-3 px-4 font-medium text-gray-700",children:"Name"}),e.jsx("th",{className:"text-left py-3 px-4 font-medium text-gray-700",children:"Email"}),e.jsx("th",{className:"text-left py-3 px-4 font-medium text-gray-700",children:"Role"}),e.jsx("th",{className:"text-left py-3 px-4 font-medium text-gray-700",children:"Status"}),e.jsx("th",{className:"text-left py-3 px-4 font-medium text-gray-700",children:"Actions"})]})}),e.jsx("tbody",{children:y.map((s,l)=>e.jsxs("tr",{className:"border-b border-gray-100",children:[e.jsx("td",{className:"py-3 px-4 text-black",children:s.name}),e.jsx("td",{className:"py-3 px-4 text-gray-600",children:s.email}),e.jsx("td",{className:"py-3 px-4",children:e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${s.role==="Admin"?"bg-purple-100 text-purple-800":s.role==="Editor"?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-800"}`,children:s.role})}),e.jsx("td",{className:"py-3 px-4",children:e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${s.status==="Active"?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800"}`,children:s.status})}),e.jsx("td",{className:"py-3 px-4",children:e.jsx("button",{className:"text-blue-600 hover:text-blue-800 text-sm",children:"Edit"})})]},l))})]})})]}),e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-black mb-4",children:"Notification Preferences"}),e.jsx("div",{className:"space-y-4",children:Object.entries(t.notifications).map(([s,l])=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h4",{className:"font-medium text-black capitalize",children:[s," Notifications"]}),e.jsxs("p",{className:"text-sm text-gray-600",children:[s==="email"&&"Receive notifications via email",s==="push"&&"Receive push notifications in browser",s==="weekly"&&"Receive weekly summary reports"]})]}),e.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:l,onChange:c=>o(h=>({...h,notifications:{...h.notifications,[s]:c.target.checked}})),className:"sr-only peer"}),e.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]})]},s))})]}),e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-black mb-4",children:"Billing & Subscription"}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-black",children:"Pro Plan"}),e.jsx("p",{className:"text-sm text-gray-600",children:"$29/month â€¢ Next billing: Jan 15, 2024"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:"Update Payment"}),e.jsx("button",{className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Manage Subscription"})]})]})]})]})}function ma(){const[t,o]=n.useState("oauth"),[y,s]=n.useState(""),[l,c]=n.useState(!1),[h,u]=n.useState({name:"",apiKey:"",apiSecret:"",redirectUri:""}),[T,b]=n.useState([]),[C,$]=n.useState(""),[R,q]=n.useState(""),[L,O]=n.useState(!1),[D,P]=n.useState(null),[_,ue]=n.useState([]),ee=async()=>{try{const F=await ye.listShopifyConnections();ue(F?.shops||[]);const k=await ye.listShopifyCreds().catch(()=>({items:[]}));b(k?.items||[])}catch{}};Yt.useEffect(()=>{ee()},[]);const le=F=>{let k=(F||"").trim().toLowerCase();return k=k.replace(/^https?:\/\//,"").replace(/\/.*/,""),k=k.replace("shopify.com.myshopify.com","myshopify.com"),k.endsWith(".shopify.com")&&!k.endsWith(".myshopify.com")&&(k=k.replace(/\.shopify\.com$/,".myshopify.com")),k.endsWith(".myshopify.com")||k.includes(".")||(k=`${k}.myshopify.com`),k},be=()=>{if(!y)return;c(!0);const F=le(y.trim()),k=C?ye.getShopifyAuthStartUrlWithCreds(F,C):ye.getShopifyAuthStartUrl(F),x=localStorage.getItem("accessToken")||"";if(!x){c(!1);return}const m=`${k}${k.includes("?")?"&":"?"}token=${encodeURIComponent(x)}`,w=640,M=720,Y=window.screenX+Math.max(0,(window.outerWidth-w)/2),a=window.screenY+Math.max(0,(window.outerHeight-M)/2),i=window.open(m,"shopify_oauth",`width=${w},height=${M},left=${Y},top=${a}`),S=g=>{if(!(!g?.data||typeof g.data!="object")){if(g.data.type==="SHOPIFY_CONNECTED"){ee(),window.removeEventListener("message",S);try{i?.close()}catch{}c(!1)}else if(g.data.type==="SHOPIFY_CONNECT_ERROR"){window.removeEventListener("message",S);try{i?.close()}catch{}c(!1)}}};window.addEventListener("message",S)},ge=async()=>{!h.apiKey||!h.apiSecret||(await ye.createShopifyCreds(h),u({name:"",apiKey:"",apiSecret:"",redirectUri:""}),await ee())},fe=async()=>{if(!(!y||!R)){O(!0),P(null);try{await ye.connectStorefront(le(y.trim()),R.trim()),q(""),P("Storefront token saved. You can now load products in Eâ€‘commerce Content Analysis â†’ Pick from Shopify â†’ Storefront (token).")}catch(F){P(`Failed to save token: ${F?.message||"unknown error"}`)}finally{O(!1)}}},z=async F=>{await ye.disconnectShopify(F),await ee()};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("label",{className:"text-sm font-bold text-black",children:"Mode"}),e.jsxs("select",{value:t,onChange:F=>o(F.target.value),className:"bg-white border border-black/20 rounded-lg px-3 py-2 text-black",children:[e.jsx("option",{value:"oauth",children:"OAuth (Admin API)"}),e.jsx("option",{value:"public",children:"Public (no auth)"}),e.jsx("option",{value:"storefront",children:"Storefront (token)"}),e.jsx("option",{value:"byo",children:"Bring Your Own App (OAuth)"})]})]}),(t==="oauth"||t==="byo")&&e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold text-black mb-2",children:"Shop Domain"}),e.jsx("input",{value:y,onChange:F=>s(F.target.value),placeholder:"your-shop.myshopify.com",className:"w-full bg-white border border-black/20 rounded-lg px-3 py-2 text-black"})]}),t==="byo"&&e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[e.jsx("input",{value:h.name,onChange:F=>u({...h,name:F.target.value}),placeholder:"Credentials name",className:"bg-white border border-black/20 rounded-lg px-3 py-2 text-black"}),e.jsx("input",{value:h.redirectUri,onChange:F=>u({...h,redirectUri:F.target.value}),placeholder:"Redirect URI (optional)",className:"bg-white border border-black/20 rounded-lg px-3 py-2 text-black"}),e.jsx("input",{value:h.apiKey,onChange:F=>u({...h,apiKey:F.target.value}),placeholder:"API Key",className:"bg-white border border-black/20 rounded-lg px-3 py-2 text-black"}),e.jsx("input",{value:h.apiSecret,onChange:F=>u({...h,apiSecret:F.target.value}),placeholder:"API Secret",className:"bg-white border border-black/20 rounded-lg px-3 py-2 text-black"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:ge,className:"px-4 py-2 rounded-lg bg-gray-800 text-white",children:"Save Credentials"}),e.jsxs("select",{value:C,onChange:F=>$(F.target.value),className:"bg-white border border-black/20 rounded-lg px-3 py-2 text-black",children:[e.jsx("option",{value:"",children:"Select saved credentials"}),T.map(F=>e.jsxs("option",{value:F.id,children:[F.name," (",F.id.slice(0,6),")"]},F.id))]})]})]}),e.jsx("div",{className:"flex gap-3",children:e.jsx("button",{onClick:be,disabled:!y||l,className:"px-4 py-2 rounded-lg bg-blue-600 text-white disabled:opacity-50",children:l?"Redirecting...":"Connect Shopify"})}),e.jsx("p",{className:"text-xs text-gray-600",children:"You will be redirected to Shopify to approve read scopes."})]}),t==="public"&&e.jsxs("div",{className:"space-y-2 text-sm text-gray-700",children:[e.jsx("p",{children:"Public mode doesnâ€™t require admin access. Use a product URL or shop+handle in analysis to fetch public JSON."}),e.jsx("p",{children:"Example: https://your-shop.myshopify.com/products/handle"})]}),t==="storefront"&&e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[e.jsx("input",{value:y,onChange:F=>s(F.target.value),placeholder:"your-shop.myshopify.com",className:"bg-white border border-black/20 rounded-lg px-3 py-2 text-black"}),e.jsx("input",{value:R,onChange:F=>q(F.target.value),placeholder:"Storefront access token",className:"bg-white border border-black/20 rounded-lg px-3 py-2 text-black"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:fe,disabled:L||!y||!R,className:"px-4 py-2 rounded-lg bg-blue-600 text-white disabled:opacity-50",children:L?"Savingâ€¦":"Save Storefront Token"}),D&&e.jsx("span",{className:`text-sm ${/Failed/i.test(D)?"text-red-600":"text-green-700"}`,children:D})]})]}),e.jsxs("div",{className:"border-t border-gray-200 pt-4",children:[e.jsx("div",{className:"font-semibold text-black mb-2",children:"Connected Shops (Admin OAuth)"}),_.length===0?e.jsx("div",{className:"text-sm text-gray-600",children:"No shops connected yet."}):e.jsx("div",{className:"space-y-2",children:_.map((F,k)=>e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-black",children:F.shop}),e.jsx("button",{onClick:()=>z(F.shop),className:"px-2 py-1 rounded bg-red-50 text-red-700",children:"Disconnect"})]},k))})]})]})}function ua(t,o){const s=new DOMParser().parseFromString(t,"text/html"),l=(s.querySelector("title")?.textContent||"").trim()||s.querySelector('meta[property="og:title"]')?.content||void 0,c=s.querySelector('meta[name="description"]')?.content||s.querySelector('meta[property="og:description"]')?.content||void 0;let h=Array.from(s.querySelectorAll("h1")).map(z=>z.textContent?.trim()||"").filter(Boolean),u=Array.from(s.querySelectorAll("h2")).map(z=>z.textContent?.trim()||"").filter(Boolean),T=Array.from(s.querySelectorAll("h3")).map(z=>z.textContent?.trim()||"").filter(Boolean);const b=(s.body?.textContent||"").replace(/\s+/g," ").trim(),C=[],$=(()=>{try{return o?new URL(o).host:""}catch{return""}})();Array.from(s.querySelectorAll("a[href]")).forEach(z=>{const F=(z.getAttribute("href")||"").trim();if(F)try{const k=o?new URL(F,o):new URL(F,window.location.origin);($?k.host===$:F.startsWith("/")||F.startsWith("#"))&&C.push({text:(z.textContent||"").trim(),href:k.href})}catch{}});const R=Array.from(s.querySelectorAll('script[type="application/ld+json"]'));let q=!1,L=!1,O=!1,D=!1,P=[],_="";if(R.forEach(z=>{try{const F=JSON.parse(z.textContent||"null");(Array.isArray(F)?F:[F]).forEach(x=>{const m=w=>{if(!w||typeof w!="object")return;const M=w["@type"],Y=Array.isArray(M)?M:[M];Y.includes("Product")&&(q=!0),Y.includes("FAQPage")&&(L=!0),Y.includes("BreadcrumbList")&&(O=!0),(Y.includes("Review")||w.aggregateRating)&&(D=!0);const a=w.name||w.headline||w.alternativeHeadline||w.title;if(typeof a=="string"&&a.trim()&&P.push(a.trim()),!_&&w.brand&&typeof w.brand=="object"){const i=w.brand.name||w.brand["@name"]||w.brand.title;typeof i=="string"&&i.trim()&&(_=i.trim())}Object.values(w).forEach(m)};m(x)})}catch{}}),h.length===0){const z=Array.from(s.querySelectorAll('[role="heading"][aria-level="1"], [aria-level="1"][role="heading"]')).map(F=>(F.textContent||"").trim()).filter(Boolean);z.length&&(h=z)}if(h.length===0){const z=Array.from(s.querySelectorAll('[itemprop="name"], .product-title, .title, [data-test="product-title"], h1[title]')).map(F=>(F.textContent||F.title||"").trim()).filter(Boolean);z.length&&(h=z)}if(h.length===0&&s.querySelector('meta[property="og:title"]')?.content){const z=s.querySelector('meta[property="og:title"]').content.trim();z&&(h=[z])}h.length===0&&P.length>0&&(h=[P[0]]);const ue=z=>Array.from(new Set(z.map(F=>F.replace(/\s+/g," ").trim()))).map(F=>F.length>300?F.slice(0,300):F);h=ue(h),u=ue(u),T=ue(T);const ee=Array.from(s.querySelectorAll("img")),be={withAlt:ee.filter(z=>(z.getAttribute("alt")||"").trim().length>0).length,total:ee.length},fe=/(reviews?|ratings?|testimonials?|\b"?stars?"?\b)/i.test(b);return{url:o,html:t,title:l,metaDescription:c,h1:h,h2:u,h3:T,bodyText:b,brandName:_||void 0,productSchemaFound:q,faqSchemaFound:L,breadcrumbSchemaFound:O,reviewsSchemaFound:D,imageAltCoverage:be,internalLinks:C,reviewsOrTestimonialsMentioned:fe}}function ha(t,o){const y=[],s=t.bodyText.split(/\s+/).filter(Boolean).length,l=/\bfaq(s)?\b|frequently asked questions/i.test(t.bodyText)||t.faqSchemaFound,h=/(size|dimensions?|material|care|price|stock|sku|model)/i.test(t.bodyText),u=/(benefit|use case|why|features?|specifications?|ideal for|best for)/i.test(t.bodyText),T=t.reviewsSchemaFound||t.reviewsOrTestimonialsMentioned,b=t.imageAltCoverage.total===0?!0:t.imageAltCoverage.withAlt/t.imageAltCoverage.total>=.7,C={name:"Product Page Quality",score:0,checks:[{id:"specs",label:"Product specs present",passed:h,weight:3},{id:"rich",label:"Rich description (benefits/use cases)",passed:u,weight:3},{id:"faqs",label:"FAQs included",passed:l,weight:2},{id:"reviews",label:"Customer reviews present",passed:T,weight:3},{id:"alt",label:"Image alt tags coverage",passed:b,weight:2}]},$=/(buying guide|how to choose|what to look for)/i.test(t.bodyText),R=/(compare|vs\.?|comparison)/i.test(t.bodyText)||Array.from(t.html.matchAll(/<table[\s\S]*?<\/table>/gi)).length>0,q=/(summer|winter|spring|fall|seasonal|202[3-9]|202\d)/i.test(t.bodyText),L=t.internalLinks.length,O={name:"Category & Guides",score:0,checks:[{id:"guide",label:"Buying guides present",passed:$,weight:2},{id:"comparison",label:"Comparison charts/tables",passed:R,weight:2},{id:"seasonal",label:"Trend/seasonal keywords",passed:q,weight:1},{id:"links",label:"Adequate internal links (>=10)",passed:L>=10,weight:2}]},D=s>=500,P=/(features?|benefits?|pros|cons|alternatives?|questions?|best|top|guide|review)/i.test(t.bodyText),_={name:"Content Depth & Authority",score:0,checks:[{id:"length",label:"Sufficient word count (>=500)",passed:D,weight:3},{id:"topics",label:"Topical coverage breadth",passed:P,weight:3},{id:"questions",label:"Questions answered present",passed:l,weight:2}]},ue=/<meta[^>]+name=["']viewport["'][^>]*>/i.test(t.html),ee=(t.url||"").startsWith("https://"),le={name:"Technical & Schema",score:0,checks:[{id:"productSchema",label:"Product schema implemented",passed:t.productSchemaFound,weight:3},{id:"faqSchema",label:"FAQ schema implemented",passed:t.faqSchemaFound,weight:2},{id:"breadcrumb",label:"Breadcrumb schema",passed:t.breadcrumbSchemaFound,weight:1},{id:"mobile",label:"Mobile-friendly (viewport tag)",passed:ue,weight:2},{id:"https",label:"HTTPS secure",passed:ee||!t.url,weight:1}]};let be;if(o&&o.counts){const F=o.counts||{},k=(F.trustpilot?1:0)+(F.google?1:0)+(F.reddit?1:0)+(F.quora?1:0)+(F.youtube?1:0),x=Math.min(100,k*20),m=k>0||(o.totals?.totalMentions||0)>0;be={name:"Off-Site & Trust Signals",score:x,checks:[{id:"externalReviews",label:"External reviews/mentions referenced",passed:!!m,weight:2}]}}else be={name:"Off-Site & Trust Signals",score:0,checks:[{id:"externalReviews",label:"External reviews/mentions referenced",passed:/(trustpilot|google reviews?|as seen on|featured in|award|certified|warranty)/i.test(t.bodyText),weight:2}]};const ge=[C,O,_,le,be];ge.forEach(F=>{const k=F.checks.reduce((m,w)=>m+w.weight,0),x=F.checks.reduce((m,w)=>m+(w.passed?w.weight:0),0);F.score=Math.round(x/Math.max(1,k)*100),F.checks.forEach(m=>{if(!m.passed){const w={specs:"Add structured product specs like size, material, care, price, and stock.",rich:"Expand product description with benefits, use cases, and differentiators.",faqs:"Add an FAQ section or implement FAQ schema to answer common questions.",reviews:"Show customer reviews or ratings; implement Review/AggregateRating schema.",alt:"Ensure at least 70% of product images have descriptive alt text.",guide:"Publish a buying guide explaining how to choose the right product.",comparison:"Add a comparison table between models or alternatives.",seasonal:"Incorporate seasonal/trend keywords where relevant.",links:"Add internal links to related categories, guides, and products.",length:"Increase page content to at least 500 words with useful details.",topics:"Cover more topics: features, benefits, pros/cons, alternatives, FAQs.",productSchema:"Add Product JSON-LD schema with offers, brand, and ratings.",faqSchema:"Add FAQPage JSON-LD schema for your FAQ section.",breadcrumb:"Implement BreadcrumbList schema for better navigation.",mobile:"Add meta viewport and ensure mobile-friendly layout.",https:"Serve the page over HTTPS with a valid certificate.",externalReviews:"Build trust with external reviews (Trustpilot/Google) and cite them."};y.push(w[m.id]||m.label)}})});const fe=[30,20,25,20,5];return{overall:Math.round(ge.reduce((F,k,x)=>F+k.score*(fe[x]/100),0)),pillars:ge,suggestions:Array.from(new Set(y))}}const ga=t=>{switch(t){case"Product Page Quality":return e.jsx(yt,{className:"w-5 h-5",style:{color:"#2563eb"}});case"Category & Guides":return e.jsx(Is,{className:"w-5 h-5",style:{color:"#2563eb"}});case"Content Depth & Authority":return e.jsx(Ps,{className:"w-5 h-5",style:{color:"#2563eb"}});case"Technical & Schema":return e.jsx(rs,{className:"w-5 h-5",style:{color:"#2563eb"}});case"Off Site & Trust Signals":return e.jsx(Es,{className:"w-5 h-5",style:{color:"#2563eb"}});default:return e.jsx(Fe,{className:"w-5 h-5",style:{color:"#2563eb"}})}};function xa(){const[t,o]=n.useState("url"),[y,s]=n.useState(""),[l,c]=n.useState(""),[h,u]=n.useState(!1),[T,b]=n.useState(null),[C,$]=n.useState(null),[R,q]=n.useState(null),[L,O]=n.useState([]),[D,P]=n.useState([]),[_,ue]=n.useState([]),[ee,le]=n.useState([]),[be,ge]=n.useState(!1),[fe,z]=n.useState(!1),[F,k]=n.useState(!1),x=n.useRef(null);n.useEffect(()=>{const A=localStorage.getItem("contentAnalysisResults");if(A)try{const B=JSON.parse(A);B.extracted&&$(B.extracted),B.offsite&&q(B.offsite),B.competitors&&O(B.competitors),B.brandCompetitors&&ue(B.brandCompetitors),B.priceOffers&&le(B.priceOffers),B.urlInput&&s(B.urlInput),B.contentInput&&c(B.contentInput),B.inputMode&&o(B.inputMode)}catch(B){console.warn("Failed to load saved content analysis results:",B)}},[]),n.useEffect(()=>{if(C||R||L.length>0||_.length>0||ee.length>0){const A={extracted:C,offsite:R,competitors:L,brandCompetitors:_,priceOffers:ee,urlInput:y,contentInput:l,inputMode:t,timestamp:Date.now()};localStorage.setItem("contentAnalysisResults",JSON.stringify(A))}},[C,R,L,_,ee,y,l,t]);const[m,w]=n.useState(!1),[M,Y]=n.useState("oauth"),[a,i]=n.useState([]),[S,g]=n.useState([]),[ae,re]=n.useState(""),[X,he]=n.useState([]),[te,U]=n.useState(null),[ie,De]=n.useState(!1),[ze,Le]=n.useState(""),st=async()=>{try{const A=await ye.listShopifyConnections();i(A?.shops||[])}catch{}},Te=A=>A.endsWith(".myshopify.com")?A:`${A}.myshopify.com`,xt=async(A,B)=>{De(!0);try{const ce=A.trim(),ne=await ye.listShopifyProducts(B,ce),xe=(ne?.data?.nodes||ne?.data?.edges?.map(me=>me.node)||[]).map(me=>({id:me.id,title:me.title,handle:me.handle}));he(me=>B?[...me,...xe]:xe);const de=ne?.data?.pageInfo?.endCursor||null,W=ne?.data?.pageInfo?.hasNextPage;U(W?de:null)}catch{he([]),U(null)}finally{De(!1)}},Me=async(A,B)=>{De(!0);try{const ce=Te(A.trim()),ne=await ye.listStorefrontProducts(ce,B),xe=(ne?.data?.nodes||ne?.data?.edges?.map(me=>me.node)||[]).map(me=>({id:me.id,title:me.title,handle:me.handle}));he(me=>B?[...me,...xe]:xe);const de=ne?.data?.pageInfo?.endCursor||null,W=ne?.data?.pageInfo?.hasNextPage;U(W?de:null)}catch{he([]),U(null)}finally{De(!1)}},Ae=async()=>{w(!0),Y("oauth"),re(""),he([]),U(null);try{const A=JSON.parse(localStorage.getItem("shopify_connections")||"[]");if(A.length>0){De(!0);const B=[];for(const ce of A)if(ce.token)try{const Ce=await fetch(`https://${ce.shop}/api/2023-10/graphql.json`,{method:"POST",headers:{"Content-Type":"application/json","X-Shopify-Storefront-Access-Token":ce.token},body:JSON.stringify({query:`
              query {
                products(first: 50) {
                  edges {
                    node {
                      id
                      title
                      handle
                    }
                  }
                }
              }
            `})});if(Ce.ok){const de=(await Ce.json()).data?.products?.edges?.map(W=>W.node)||[];B.push(...de.map(W=>({...W,shop:ce.shop})))}}catch(ne){console.warn(`Failed to fetch products from ${ce.shop}:`,ne)}he(B),B.length>0&&A.length>0&&re(A[0].shop),De(!1)}}catch(A){console.error("Error loading Shopify products:",A)}await st();try{const A=await ye.listStorefrontConnections();g(A?.shops||[])}catch{}},$e=(A,B)=>{const ce=Te(A);s(`https://${ce}/products/${B}`),w(!1),o("url")},Ie=async A=>{const B=A.target.files?.[0];if(!B)return;const ce=await B.text();c(ce),o("content")},lt=()=>{$(null),q(null),O([]),ue([]),P([]),le([]),b(null),s(""),c(""),localStorage.removeItem("contentAnalysisResults")},ct=async()=>{u(!0),b(null),$(null),q(null),O([]),ue([]),P([]),le([]);try{let A="",B;if(t==="url"){const xe=y.trim();if(!xe)throw new Error("Please enter a URL");B=xe;try{const de=await ye.extractSmartHtml(xe);de?.success&&de.html&&(A=de.html)}catch{}if(!A)try{const de=await ye.extractFullPageHtml(xe);de?.success&&de.html&&(A=de.html)}catch{}if(A||(A=(await ye.extractContentFromUrl(xe))?.content||""),!A)throw new Error("Failed to extract content from the URL")}else A=l,/</.test(A)||(A=`<html><head><title>Document</title></head><body><article>${l.replace(/&/g,"&amp;").replace(/</g,"&lt;")}</article></body></html>`);const ce=ua(A,B);$(ce);const Ce=((xe,de)=>{const W=[];xe.title&&W.push(xe.title),xe.h1&&xe.h1.length>0&&W.push(xe.h1[0]);let me=W.find(we=>we&&we.length>3)||"";if(me=me.replace(/\s*\|\s*Flipkart.*$/i,"").replace(/\s*\|\s*Amazon.*$/i,"").replace(/\s*- Buy.*Online.*$/i,"").replace(/\s*\(.*?\)\s*$/,"").replace(/\s{2,}/g," ").trim(),(!me||me.length<4)&&de)try{const je=new URL(de).pathname.split("/").filter(Boolean).findLast(se=>/[a-z\-_%]/i.test(se)&&!/^buy$/i.test(se)&&!/^p$/i.test(se)&&!/^\d+$/i.test(se));if(je){const se=decodeURIComponent(je).replace(/[-_]+/g," ").replace(/\s{2,}/g," ").trim();se.length>4&&(me=se)}}catch{}if(!me&&de)try{me=new URL(de).hostname.replace(/^www\./,"").split(".")[0]}catch{}return me.length>80&&(me=me.slice(0,80)),me})(ce,B);if(Ce)try{const xe=[ce.h1?.[0]||"",ce.title||""].map(je=>(je||"").trim()).filter(Boolean)[0]||Ce;ge(!0),z(!0),k(!0),console.log("[EcommerceContentAnalysis] Starting parallel API calls..."),console.log("[EcommerceContentAnalysis] Product query for price comparison:",xe),console.log("[EcommerceContentAnalysis] Current URL for price comparison:",B);const[de,W,me,we]=await Promise.all([ye.getOffsiteSignals({brandOrProduct:Ce,domain:B?new URL(B).hostname:void 0}).catch(je=>(console.log("[EcommerceContentAnalysis] Offsite signals failed:",je),null)),ye.getCompetitors({brandOrProduct:Ce,currentUrl:B}).catch(je=>(console.log("[EcommerceContentAnalysis] Domain competitors failed:",je),{competitors:[]})),ye.getProductCompetitors(xe,B).catch(je=>(console.log("[EcommerceContentAnalysis] Product competitors failed:",je),{competitors:[]})),ye.priceCompare(xe,B).catch(je=>(console.log("[EcommerceContentAnalysis] Price compare failed:",je),{offers:[]}))]);console.log("[EcommerceContentAnalysis] Parallel API calls completed"),de&&(de.success===void 0||de.success)&&q({totals:de.totals,counts:de.counts,topResults:de.topResults||[]}),ge(!1);const Re=[...W?.competitors||[],...me?.competitors||[]];if(Re.length>0){const je=new Set,se=Re.filter(j=>{try{const I=new URL(j.link||j.domain||j.name).hostname||j.name;return je.has(I)?!1:(je.add(I),!0)}catch{return je.has(j.name)?!1:(je.add(j.name),!0)}}).slice(0,10);O(se);const at=ce.brandName||"",N=j=>j.replace(/^www\./,"").split(".")[0].replace(/[-_]+/g," ").replace(/\b\w/g,I=>I.toUpperCase()),E=se.map(j=>{const I=(()=>{try{return new URL(j.link).hostname}catch{return j.name||""}})();let H="";const J=`${j.name||""} ${j.snippet||""}`,Z=J.match(/\bby\s+([A-Z][\w.&' -]{2,})/)||J.match(/\bfrom\s+([A-Z][\w.&' -]{2,})/);return Z&&(H=Z[1].trim()),!H&&I&&(H=N(I)),H}).filter(Boolean).map(j=>j.replace(/\b(in|the|for|with|and)\b/gi,"").replace(/\s{2,}/g," ").trim()).filter(j=>j&&(!at||j.toLowerCase()!==at.toLowerCase())),d=Array.from(new Set(E)).slice(0,12);ue(d);const v=se.slice(0,5).map(j=>j.link);if(v.length>0){const j=await ye.fetchBatchHtml(v).catch(()=>null);j&&j.success!==!1&&P(j.results||[])}}z(!1),console.log("[EcommerceContentAnalysis] Price response:",we),console.log("[EcommerceContentAnalysis] Price response type:",typeof we),console.log("[EcommerceContentAnalysis] Price response keys:",we?Object.keys(we):"null"),console.log("[EcommerceContentAnalysis] Price offers:",we?.offers),console.log("[EcommerceContentAnalysis] Price offers type:",typeof we?.offers),console.log("[EcommerceContentAnalysis] Price offers length:",we?.offers?.length),we&&we.success!==!1?Array.isArray(we.offers)&&we.offers.length>0?(console.log("[EcommerceContentAnalysis] Setting price offers:",we.offers),le(we.offers)):(console.log("[EcommerceContentAnalysis] Empty offers array:",we.offers),le([])):(console.log("[EcommerceContentAnalysis] Price API failed or no data:",we),le([])),k(!1)}catch(xe){console.error("[EcommerceContentAnalysis] Error in parallel API calls:",xe)}}catch(A){b(A?.message||"Analysis failed")}finally{u(!1)}},Se=n.useMemo(()=>C?ha(C,R||void 0):null,[C,R]),Be=n.useMemo(()=>!!(C&&!h),[C,h]);return e.jsxs("div",{className:"w-full max-w-full mx-auto space-y-6 lg:space-y-8 px-2 sm:px-4 lg:px-6",children:[e.jsxs("div",{className:"flex flex-col lg:flex-row justify-between items-start gap-4",children:[e.jsx("div",{className:"flex-1 min-w-0"}),C&&e.jsxs("button",{onClick:lt,className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg font-medium flex items-center gap-2 transition-colors shadow-sm",children:[e.jsx(Ge,{className:"w-4 h-4"}),"New Analysis"]})]}),e.jsxs("div",{className:"bg-white border border-gray-300 rounded-xl p-4 sm:p-6 lg:p-8 shadow-sm",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h2",{className:"text-3xl font-bold text-gray-900 mb-3",children:"Content Analysis Dashboard"}),e.jsx("p",{className:"text-gray-600 text-lg",children:"Enter your website URL or paste HTML content to analyze your e-commerce content structure and optimization."})]}),e.jsxs("div",{className:"bg-gray-50 border border-gray-300 rounded-xl p-4 sm:p-6 mb-6",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[e.jsxs("button",{className:`px-4 py-2 rounded-lg text-sm font-medium ${t==="url"?"bg-blue-600 text-white":"bg-gray-100 text-gray-800"}`,onClick:()=>o("url"),children:[e.jsx(ts,{className:"w-4 h-4 inline mr-1"})," URL"]}),e.jsxs("button",{className:`px-4 py-2 rounded-lg text-sm font-medium ${t==="content"?"bg-blue-600 text-white":"bg-gray-100 text-gray-800"}`,onClick:()=>o("content"),children:[e.jsx(Ge,{className:"w-4 h-4 inline mr-1"})," HTML/Text"]})]}),t==="url"?e.jsxs("div",{className:"flex gap-3 items-center",children:[e.jsx("input",{value:y,onChange:A=>s(A.target.value),placeholder:"https://example.com/product",className:"flex-1 h-11 px-3 py-2 border border-gray-300 rounded-lg text-gray-900 text-sm"}),e.jsx("button",{onClick:Ae,type:"button",className:"h-11 px-4 rounded-lg bg-white border border-gray-300 text-gray-800 hover:bg-gray-50 font-medium transition-colors",children:"Pick from Shopify"}),e.jsx("button",{onClick:ct,disabled:h,className:"h-11 px-4 rounded-lg bg-blue-600 text-white hover:bg-blue-700 disabled:opacity-50 font-medium transition-colors flex items-center gap-2",children:h?e.jsx(Pe,{className:"w-4 h-4 animate-spin"}):"Analyze"})]}):e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx("input",{type:"file",accept:".html,.htm,.txt,.md",ref:x,onChange:Ie,className:"hidden"}),e.jsxs("button",{onClick:()=>x.current?.click(),className:"h-11 px-4 bg-white border border-gray-300 rounded-lg text-gray-800 hover:bg-gray-50 font-medium transition-colors flex items-center gap-2",children:[e.jsx(Ss,{className:"w-4 h-4"})," Upload File"]})]}),e.jsx("textarea",{value:l,onChange:A=>c(A.target.value),rows:8,placeholder:"Paste HTML or raw text here...",className:"w-full border border-gray-300 rounded-lg px-3 py-2 text-gray-900 text-sm"}),e.jsx("div",{className:"mt-3",children:e.jsx("button",{onClick:ct,disabled:h,className:"h-11 px-4 rounded-lg bg-blue-600 text-white hover:bg-blue-700 disabled:opacity-50 font-medium transition-colors flex items-center gap-2",children:h?e.jsx(Pe,{className:"w-4 h-4 animate-spin"}):"Analyze"})})]}),T&&e.jsxs("div",{className:"mt-3 p-3 bg-red-50 border border-red-200 rounded-lg text-red-700 flex items-center gap-2",children:[e.jsx(Ot,{className:"w-4 h-4"})," ",T]})]}),m&&e.jsx("div",{className:"fixed inset-0 bg-black/30 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 w-full max-w-3xl p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold text-black",children:"Select a product"}),X.length>0&&!ie&&e.jsxs("div",{className:"text-xs text-green-600 mt-1",children:["âœ“ Loaded ",X.length," product",X.length!==1?"s":""," from connected Shopify stores"]})]}),e.jsx("button",{onClick:()=>w(!1),className:"text-gray-600",children:"âœ•"})]}),e.jsx("div",{className:"mt-3",children:e.jsx("input",{value:ze,onChange:A=>Le(A.target.value),placeholder:"Search by title or handle...",className:"w-full bg-white border border-black/20 rounded-lg px-3 py-2 text-black mb-2"})}),e.jsx("div",{className:"max-h-80 overflow-auto border rounded bg-white",children:ie?e.jsxs("div",{className:"text-sm text-gray-600 p-3 flex items-center gap-2",children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-600"}),"Loading products..."]}):X.length===0?e.jsx("div",{className:"text-sm text-gray-600 p-3",children:"No products loaded. Connect Shopify in Dashboard to see products."}):e.jsx("div",{className:"divide-y",children:(ze?X.filter(A=>{const B=ze.toLowerCase();return(A.title||"").toLowerCase().includes(B)||(A.handle||"").toLowerCase().includes(B)}):X).map(A=>e.jsxs("button",{onClick:()=>$e(A.shop||ae,A.handle),className:"w-full text-left p-3 bg-white hover:bg-gray-50 focus:bg-white focus:outline-none",children:[e.jsx("div",{className:"font-medium text-black",children:A.title}),e.jsxs("div",{className:"text-xs text-gray-600",children:["/",A.handle]})]},A.id))})}),te&&e.jsx("div",{className:"mt-2",children:e.jsx("button",{onClick:()=>M==="oauth"?xt(ae,te||void 0):Me(ae,te||void 0),className:"px-3 py-2 rounded-lg bg-white border text-gray-800",children:"Load more"})})]})}),T&&e.jsxs("div",{className:"mt-3 p-3 bg-red-50 border border-red-200 rounded-lg text-red-700 flex items-center gap-2",children:[e.jsx(Ot,{className:"w-4 h-4"})," ",T]})]}),Be&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"bg-white border border-gray-300 rounded-lg p-4 hover:shadow-md hover:scale-[1.02] transition-all duration-150",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4 pb-3 border-b border-gray-100",children:[e.jsx("div",{className:"w-9 h-9 rounded-lg flex items-center justify-center bg-gray-200",children:e.jsx(Fe,{className:"w-5 h-5",style:{color:"#2563eb"}})}),e.jsx("h3",{className:"text-base font-semibold",style:{color:"#000000"},children:"AI Readiness Score"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-4xl font-bold text-gray-900 mb-1",children:Se.overall}),e.jsx("div",{className:"text-sm text-gray-600 mb-2",children:"out of 100"}),e.jsx("div",{className:`text-lg font-bold mb-4 ${Se.overall>=80?"text-emerald-600":Se.overall>=60?"text-blue-600":Se.overall>=40?"text-amber-600":Se.overall>=20?"text-orange-600":"text-red-600"}`,children:Se.overall>=80?"Excellent":Se.overall>=60?"Good":Se.overall>=40?"Fair":Se.overall>=20?"Poor":"Very Poor"}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:`h-2 rounded-full ${Se.overall>=80?"bg-emerald-500":Se.overall>=60?"bg-blue-500":Se.overall>=40?"bg-amber-500":Se.overall>=20?"bg-orange-500":"bg-red-500"}`,style:{width:`${Se.overall}%`}})})]})]}),e.jsxs("div",{className:"bg-white border border-gray-300 rounded-lg p-4 hover:shadow-md hover:scale-[1.02] transition-all duration-150",children:[e.jsx("div",{className:"text-lg font-semibold mb-2",style:{color:"#000000"},children:"Title"}),e.jsx("div",{className:"text-base font-medium text-black break-words",children:C.title||"â€”"})]}),e.jsxs("div",{className:"bg-white border border-gray-300 rounded-lg p-4 hover:shadow-md hover:scale-[1.02] transition-all duration-150",children:[e.jsx("div",{className:"text-lg font-semibold mb-2",style:{color:"#000000"},children:"Description"}),e.jsx("div",{className:"text-base text-black break-words",children:C.metaDescription||"â€”"})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:Se.pillars.map(A=>e.jsxs("div",{className:"bg-white border border-gray-300 rounded-lg p-4 hover:shadow-md hover:scale-[1.02] transition-all duration-150",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-9 h-9 rounded-lg flex items-center justify-center bg-gray-200",children:ga(A.name)}),e.jsx("div",{className:"text-lg font-semibold",style:{color:"#000000"},children:A.name})]}),e.jsxs("span",{className:"px-2 py-0.5 text-sm rounded-full bg-gray-100 text-gray-700 font-semibold",children:[A.score,"%"]})]}),e.jsx("div",{className:"divide-y",children:A.checks.map(B=>e.jsxs("div",{className:"flex items-center justify-between py-2 text-base",children:[e.jsx("span",{className:"text-black",children:B.label}),B.passed?e.jsx(Ut,{className:"w-4 h-4 text-green-600"}):e.jsx(Et,{className:"w-4 h-4 text-red-600"})]},B.id))})]},A.name))}),console.log("[EcommerceContentAnalysis] Rendering, priceOffers:",ee),ee&&ee.length>0&&e.jsxs("div",{className:"bg-white border border-gray-300 rounded-lg p-4 hover:shadow-md hover:scale-[1.02] transition-all duration-150",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-9 h-9 rounded-lg flex items-center justify-center bg-gray-200",children:e.jsx(Fe,{className:"w-5 h-5",style:{color:"#2563eb"}})}),e.jsx("div",{className:"text-lg font-semibold",style:{color:"#000000"},children:"Price Comparison"})]}),e.jsxs("span",{className:"text-sm text-gray-600",children:["Typically ",(()=>{const A=ee.map(Ce=>Ce.price).filter(Boolean),B=Math.min(...A),ce=Math.max(...A),ne=ee[0]?.currency||"INR";try{const Ce=new Intl.NumberFormat(void 0,{style:"currency",currency:ne});return`${Ce.format(B)}â€“${Ce.format(ce)}`}catch{return`${ne} ${B.toLocaleString()}â€“${ce.toLocaleString()}`}})()]})]}),e.jsx("div",{className:"space-y-3",children:ee.map((A,B)=>e.jsxs("div",{className:"border rounded-lg p-4 hover:bg-gray-50 transition-colors",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"flex items-center gap-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded flex items-center justify-center",children:e.jsx("span",{className:"text-sm font-bold text-blue-600",children:A.site.charAt(0).toUpperCase()})}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-black capitalize",children:A.site.replace(/^www\./,"")}),A.rating&&A.reviews&&e.jsxs("div",{className:"text-sm text-gray-600 flex items-center gap-1",children:[e.jsx("span",{className:"text-yellow-400",children:"â˜…"}),e.jsxs("span",{children:[A.rating,"/5"]}),e.jsx("span",{children:"Â·"}),e.jsxs("span",{children:[A.reviews.toLocaleString()," reviews"]})]})]})]})}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"text-lg font-bold text-black",children:(()=>{const ce=(A.currency||"USD").toUpperCase();try{return new Intl.NumberFormat(void 0,{style:"currency",currency:ce}).format(Number(A.price))}catch{return`${ce} ${Number(A.price).toLocaleString?.()||"-"}`}})()}),A.discount&&e.jsxs("span",{className:"text-sm bg-green-100 text-green-700 px-2 py-1 rounded",children:[A.discount,"% off"]})]}),A.originalPrice&&e.jsx("div",{className:"text-sm text-gray-500 line-through",children:(()=>{const ce=(A.currency||"USD").toUpperCase();try{return new Intl.NumberFormat(void 0,{style:"currency",currency:ce}).format(Number(A.originalPrice))}catch{return`${ce} ${Number(A.originalPrice).toLocaleString?.()||"-"}`}})()})]})]}),e.jsxs("div",{className:"mt-2 flex items-center justify-between text-sm text-gray-600",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[A.availability&&e.jsx("span",{className:"text-green-600 font-medium",children:A.availability.includes("InStock")?"In stock online":A.availability}),A.delivery&&e.jsx("span",{children:A.delivery})]}),e.jsx("a",{href:A.url,target:"_blank",rel:"noreferrer",className:"text-blue-600 hover:underline font-medium",children:"View â†’"})]})]},B))})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-white border border-gray-300 rounded-lg p-4 hover:shadow-md hover:scale-[1.02] transition-all duration-150",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx("div",{className:"w-9 h-9 rounded-lg flex items-center justify-center bg-gray-200",children:e.jsx(Ge,{className:"w-5 h-5",style:{color:"#2563eb"}})}),e.jsx("div",{className:"text-lg font-semibold",style:{color:"#000000"},children:"Structure"})]}),e.jsxs("div",{className:"text-base text-black",children:[e.jsx("strong",{children:"H1"}),": ",C.h1.join(" | ")||"â€”"]}),e.jsxs("div",{className:"text-base text-black mt-1",children:[e.jsx("strong",{children:"H2"}),": ",C.h2.slice(0,6).join(" | ")||"â€”"]}),e.jsxs("div",{className:"text-base text-black mt-1",children:[e.jsx("strong",{children:"H3"}),": ",C.h3.slice(0,6).join(" | ")||"â€”"]})]}),e.jsxs("div",{className:"bg-white border border-gray-300 rounded-lg p-4 hover:shadow-md hover:scale-[1.02] transition-all duration-150",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx("div",{className:"w-9 h-9 rounded-lg flex items-center justify-center bg-gray-200",children:e.jsx(Cs,{className:"w-5 h-5",style:{color:"#2563eb"}})}),e.jsx("div",{className:"text-lg font-semibold",style:{color:"#000000"},children:"Schema & Media"})]}),e.jsxs("div",{className:"text-base text-black",children:["Product schema: ",C.productSchemaFound?"Yes":"No"]}),e.jsxs("div",{className:"text-base text-black",children:["FAQ schema: ",C.faqSchemaFound?"Yes":"No"]}),e.jsxs("div",{className:"text-base text-black",children:["Breadcrumb: ",C.breadcrumbSchemaFound?"Yes":"No"]}),e.jsxs("div",{className:"text-base text-black",children:["Reviews schema: ",C.reviewsSchemaFound?"Yes":"No"]}),e.jsxs("div",{className:"text-base text-black",children:["Image alt coverage: ",C.imageAltCoverage.withAlt,"/",C.imageAltCoverage.total]})]})]}),e.jsxs("div",{className:"bg-white border border-gray-300 rounded-lg p-4 hover:shadow-md hover:scale-[1.02] transition-all duration-150",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx("div",{className:"w-9 h-9 rounded-lg flex items-center justify-center bg-gray-200",children:e.jsx(ks,{className:"w-5 h-5",style:{color:"#2563eb"}})}),e.jsx("div",{className:"text-lg font-semibold",style:{color:"#000000"},children:"Actionable Suggestions"})]}),Se.suggestions.length===0?e.jsx("div",{className:"text-base text-green-700",children:"No critical issues found. Great job!"}):e.jsx("ul",{className:"list-disc pl-5 text-base text-black space-y-1",children:Se.suggestions.map((A,B)=>e.jsx("li",{children:A},B))})]}),R&&e.jsxs("div",{className:"bg-white border border-gray-300 rounded-lg p-4 hover:shadow-md hover:scale-[1.02] transition-all duration-150",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-9 h-9 rounded-lg flex items-center justify-center bg-gray-200",children:e.jsx(As,{className:"w-5 h-5",style:{color:"#2563eb"}})}),e.jsx("div",{className:"text-lg font-semibold",style:{color:"#000000"},children:"Offâ€‘Site & Trust Signals"})]}),e.jsxs("span",{className:"px-2 py-0.5 text-sm rounded-full bg-gray-100 text-gray-700 font-semibold",children:[(()=>{const A=Se.pillars.find(B=>B.name==="Off-Site & Trust Signals");return A?A.score:0})(),"%"]})]}),e.jsx("div",{className:"divide-y text-base",children:[{id:"reviews",label:"Thirdâ€‘party reviews",pass:(R.counts?.trustpilot||0)+(R.counts?.google||0)>0},{id:"blogs",label:"Blog mentions",pass:(R.counts?.google||0)>0},{id:"social",label:"Social discussions",pass:(R.counts?.reddit||0)>0},{id:"authority",label:"Brand authority",pass:(R.totals?.totalMentions||0)>=5||(R.counts?.youtube||0)>0}].map(A=>e.jsxs("div",{className:"flex items-center justify-between py-2",children:[e.jsx("span",{className:"text-black",children:A.label}),A.pass?e.jsx(Ut,{className:"w-4 h-4 text-green-600"}):e.jsx(Et,{className:"w-4 h-4 text-red-600"})]},A.id))}),Array.isArray(R.topResults)&&R.topResults.length>0&&e.jsx("div",{className:"mt-3 space-y-2",children:R.topResults.slice(0,8).map((A,B)=>{let ce=(A.name||"").trim();try{(!ce||/^untitled$/i.test(ce))&&(ce=new URL(A.link).hostname.replace(/^www\./,"")||"Link")}catch{ce||(ce="Link")}return e.jsxs("a",{href:A.link,target:"_blank",rel:"noreferrer",className:"block text-base text-blue-700 hover:underline",children:[e.jsx(Qt,{className:"w-3.5 h-3.5 inline mr-1"})," ",ce]},B)})})]}),(_.length>0||L&&L.length>0)&&e.jsxs("div",{className:"bg-white border border-gray-300 rounded-lg p-4 hover:shadow-md hover:scale-[1.02] transition-all duration-150",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx("div",{className:"w-9 h-9 rounded-lg flex items-center justify-center bg-gray-200",children:e.jsx(es,{className:"w-5 h-5",style:{color:"#2563eb"}})}),e.jsx("div",{className:"text-lg font-semibold",style:{color:"#000000"},children:"Product Competitors"})]}),_.length>0&&e.jsxs("div",{className:"mb-3 text-base text-black",children:[e.jsx("div",{className:"font-medium mb-1",children:"Similar brands"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:_.map((A,B)=>e.jsx("span",{className:"px-2 py-1 bg-gray-100 rounded border border-gray-200",children:A},B))})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:L.map((A,B)=>e.jsxs("a",{href:A.link,target:"_blank",rel:"noreferrer",className:"p-3 border rounded-lg hover:bg-gray-50",children:[e.jsxs("div",{className:"font-medium text-black flex items-center gap-2",children:[e.jsx(Qt,{className:"w-3.5 h-3.5"})," ",A.name]}),e.jsx("div",{className:"text-sm text-gray-600 mt-1 line-clamp-2",children:A.snippet})]},B))})]})]})]})}const pa=()=>{const[t,o]=n.useState(null),[y,s]=n.useState(null),l=()=>{o("Invalid email or password. Please check your credentials and try again.")},c=()=>{s("Login successful! Welcome back.")},h=()=>{o("Your session will expire soon. Please save your work.")};return e.jsxs("div",{className:"p-8 space-y-4",children:[e.jsx("h2",{className:"text-2xl font-bold",children:"Notification Test"}),e.jsxs("div",{className:"space-x-4",children:[e.jsx("button",{onClick:l,className:"px-4 py-2 bg-red-500 text-white rounded hover:bg-red-600",children:"Show Error"}),e.jsx("button",{onClick:c,className:"px-4 py-2 bg-green-500 text-white rounded hover:bg-green-600",children:"Show Success"}),e.jsx("button",{onClick:h,className:"px-4 py-2 bg-yellow-500 text-white rounded hover:bg-yellow-600",children:"Show Warning"})]}),e.jsx(gt,{error:t,onClose:()=>o(null),autoClose:!0,autoCloseDelay:5e3,type:"error"}),e.jsx(Kt,{message:y,onClose:()=>s(null),autoClose:!0,autoCloseDelay:3e3})]})},zt="llm_qa_sessions",At="llm_qa_current_session";function fa(){const{user:t}=tt();qe();const[o,y]=n.useState("ecommerce"),[s,l]=n.useState("product"),[c,h]=n.useState([]),[u,T]=n.useState([]),[b,C]=n.useState(new Set),[$,R]=n.useState(!1),[q,L]=n.useState(!1),[O,D]=n.useState(!1),[P,_]=n.useState(null),[ue,ee]=n.useState(!1),[le,be]=n.useState([]),[ge,fe]=n.useState(new Set),[z,F]=n.useState(!1),[k,x]=n.useState(!1),[m,w]=n.useState(!1),[M,Y]=n.useState(!1),a="kabini_ecommerce_content",i="kabini_ecommerce_content_type";n.useEffect(()=>{try{const r=localStorage.getItem(a);if(r){const f=JSON.parse(r),V=We(f);V&&_(V)}const p=localStorage.getItem(i);(p==="product"||p==="category"||p==="faq")&&l(p)}catch{}},[]),n.useEffect(()=>{try{P?localStorage.setItem(a,JSON.stringify(P)):localStorage.removeItem(a)}catch{}},[P]),n.useEffect(()=>{try{localStorage.setItem(i,s)}catch{}},[s]),n.useEffect(()=>{o!=="ecommerce"&&_(null)},[o]);const[S,g]=n.useState({name:"",features:"",targetAudience:"",category:"",tone:"professional"}),[ae,re]=n.useState({categoryName:"",productTypes:"",audience:""}),[X,he]=n.useState("gemini"),[te,U]=n.useState("gemini-2.0-flash"),[ie,De]=n.useState([]),[ze,Le]=n.useState(!1),[st,Te]=n.useState(!1),[xt,Me]=n.useState(null),[Ae,$e]=n.useState(""),[Ie,lt]=n.useState([]),[ct,Se]=n.useState(""),[Be,A]=n.useState(!1),[B,ce]=n.useState(!1),[ne,Ce]=n.useState(""),[xe,de]=n.useState([]),[W,me]=n.useState(null),[we,Re]=n.useState(new Set),[je,se]=n.useState(null),[at,N]=n.useState("success"),E=n.useRef(null),d=n.useRef(null),v=(r,p)=>`${r}_${p}`,j=()=>v("faq_last_persisted",t?.id||"anonymous"),I=r=>{try{return new URL(r.trim()),!0}catch{return!1}},H=r=>{const p=r.trim();if(I(p))return p;const f=/https?:\/\/[^\s]+/g,V=p.match(f);return V?V[0]:null};n.useEffect(()=>{if(E.current&&Ae){E.current.style.height="auto";const r=Math.max(36,Math.min(E.current.scrollHeight,150));E.current.style.height=r+"px"}},[Ae]),n.useEffect(()=>{if(d.current&&ne){d.current.style.height="auto";const r=Math.max(36,Math.min(d.current.scrollHeight,150));d.current.style.height=r+"px"}},[ne]),n.useEffect(()=>{switch(X){case"gemini":U("gemini-2.0-flash");break;case"openai":U("gpt-3.5-turbo");break;case"perplexity":U("sonar");break;case"claude":U("claude-3.5-sonnet-20241022");break;default:U("gemini-2.0-flash")}},[X]),n.useEffect(()=>{if(t?.id){const r=v(zt,t.id),p=v(At,t.id);console.log("[FAQ Session] Loading sessions from localStorage:",{userSessionsKey:r,userCurrentSessionKey:p,userId:t.id});try{const f=localStorage.getItem(r);if(f){const Q=JSON.parse(f);console.log("[FAQ Session] Loaded sessions:",Q.length),de(Q)}const V=localStorage.getItem(p);if(V){const Q=JSON.parse(V);console.log("[FAQ Session] Loaded current session:",{id:Q.id,type:Q.type,qaDataLength:Q.qaData?.length||0,questionsLength:Q.generatedQuestions?.length||0,showQuestionsSection:Q.showQuestionsSection,showFAQSection:Q.showFAQSection}),me(Q)}else console.log("[FAQ Session] No current session found in localStorage")}catch(f){console.error("[Session Loading] Error loading sessions:",f)}}},[t?.id]),n.useEffect(()=>{try{if(W)return;const r=j(),p=localStorage.getItem(r);if(!p)return;const f=JSON.parse(p);if(f?.savedAt&&Date.now()-f.savedAt>24*60*60*1e3)return;if(console.log("[FAQ Persist] Restoring last persisted FAQ state"),(f.selectedIndustry==="general"||f.selectedIndustry==="ecommerce")&&y(f.selectedIndustry),(f.contentType==="product"||f.contentType==="category"||f.contentType==="faq")&&l(f.contentType),typeof f.content=="string"&&$e(f.content),typeof f.ecomFaqContent=="string"&&Ce(f.ecomFaqContent),Array.isArray(f.generatedQuestions)&&T(f.generatedQuestions),Array.isArray(f.ecomGeneratedQuestions)&&be(f.ecomGeneratedQuestions),Array.isArray(f.faqs)&&h(f.faqs),typeof f.showEcomQuestionsSection=="boolean"&&w(f.showEcomQuestionsSection),typeof f.showEcomFAQSection=="boolean"&&Y(f.showEcomFAQSection),typeof f.faqProvider=="string"&&he(f.faqProvider),typeof f.faqModel=="string"&&U(f.faqModel),typeof f.showQuestionsSection=="boolean"&&Te(f.showQuestionsSection),typeof f.showFAQSection=="boolean"&&Le(f.showFAQSection),f.ecommerceContent){const V=We(f.ecommerceContent);V&&_(V)}}catch(r){console.warn("[FAQ Persist] Failed to restore persisted FAQ state:",r)}},[W,t?.id]),n.useEffect(()=>{try{const r={selectedIndustry:o,contentType:s,content:Ae,ecomFaqContent:ne,generatedQuestions:u,ecomGeneratedQuestions:le,faqs:c,faqProvider:X,faqModel:te,showQuestionsSection:st,showFAQSection:ze,showEcomQuestionsSection:m,showEcomFAQSection:M,ecommerceContent:P,savedAt:Date.now()};localStorage.setItem(j(),JSON.stringify(r))}catch{}},[o,s,Ae,ne,u,le,c,X,te,st,ze,m,M,P,t?.id]),n.useEffect(()=>{if(t?.id&&xe.length>0){const r=v(zt,t.id);try{localStorage.setItem(r,JSON.stringify(xe))}catch(p){console.error("[Session Saving] Error saving sessions:",p)}}},[xe,t?.id]),n.useEffect(()=>{if(t?.id&&W){const r=v(At,t.id);try{console.log("[FAQ Session] Saving current session to localStorage:",{key:r,sessionId:W.id,sessionType:W.type,qaDataLength:W.qaData?.length||0,questionsLength:W.generatedQuestions?.length||0,showQuestionsSection:W.showQuestionsSection,showFAQSection:W.showFAQSection}),localStorage.setItem(r,JSON.stringify(W))}catch(p){console.error("[Session Saving] Error saving current session:",p)}}},[W,t?.id]),n.useEffect(()=>{t||(de([]),me(null),Re(new Set),h([]),T([]),Le(!1),Te(!1),$e(""),R(!1),L(!1),Me(null))},[t]),n.useEffect(()=>{W&&W.type==="faq"?(console.log("[FAQ Session] Restoring FAQ session:",{id:W.id,qaDataLength:W.qaData?.length||0,questionsLength:W.generatedQuestions?.length||0,blogContentLength:W.blogContent?.length||0,showQuestionsSection:W.showQuestionsSection,showFAQSection:W.showFAQSection}),h(W.qaData||[]),$e(W.blogContent||""),he(W.questionProvider||"gemini"),U(W.questionModel||(W.questionProvider==="perplexity"?"sonar":W.questionProvider==="claude"?"claude-3.5-sonnet-20241022":"gemini-2.0-flash")),T(W.generatedQuestions||[]),Te(W.showQuestionsSection||!1),Le(W.showFAQSection||!1),E.current&&W.blogContent&&setTimeout(()=>{if(E.current){E.current.style.height="auto";const r=Math.max(36,Math.min(E.current.scrollHeight,150));E.current.style.height=r+"px"}},100)):W&&W.type!=="faq"?(console.log("[FAQ Session] Clearing FAQ state - current session is not FAQ type:",W.type),h([]),T([]),Le(!1),Te(!1)):W||(console.log("[FAQ Session] Clearing FAQ state - no current session"),h([]),T([]),Le(!1),Te(!1))},[W]),n.useEffect(()=>{if(t?.id){const r=v("pending_faq_generation",t.id),p=v("generated_faqs",t.id);try{const f=localStorage.getItem(r);if(f){const Q=JSON.parse(f);Date.now()-Q.timestamp<5*60*1e3?(Me(Q),R(!0),$e(Q.content),he(Q.provider),U(Q.model),De(Q.targetKeywords),J(Q)):localStorage.removeItem(r)}const V=localStorage.getItem(p);if(V){const Q=JSON.parse(V);Date.now()-Q.timestamp<10*60*1e3&&(console.log("[Background FAQ] Restoring generated FAQs:",Q.faqs.length),setTimeout(()=>{h(Q.faqs),Le(!0),$e(Q.content),he(Q.provider),U(Q.model),D(!1);const Ee=Q.faqs.length===1?"FAQ":"FAQs";se(`Restored ${Q.faqs.length} previously generated ${Ee}!`)},100)),localStorage.removeItem(p)}}catch(f){console.error("[Background FAQ] Error loading background data:",f),localStorage.removeItem(r),localStorage.removeItem(p)}}},[t?.id]);const J=async r=>{try{console.log("[Pending FAQ] Continuing FAQ generation for content length:",r.content.length);const p=await ye.generateAIFAQs({content:r.content.trim(),provider:r.provider,model:r.model,targetKeywords:r.targetKeywords});if(p.faqs&&Array.isArray(p.faqs)&&p.faqs.length>0){if(console.log("[Pending FAQ] Successfully generated FAQs:",p.faqs.length),t?.id){const V=v("generated_faqs",t.id),Q={faqs:p.faqs,content:r.content,provider:r.provider,model:r.model,timestamp:Date.now()};localStorage.setItem(V,JSON.stringify(Q))}if(h(p.faqs),Le(!0),D(!1),Me(null),t?.id){const V=v("pending_faq_generation",t.id);localStorage.removeItem(V)}if(t?.id){const V=H(r.content),Q={id:`faq-session-${Date.now()}`,name:`FAQ Session - ${new Date().toLocaleDateString()}`,type:"faq",timestamp:new Date().toISOString(),model:r.model,questionProvider:r.provider,answerProvider:r.provider,questionModel:r.model,answerModel:r.model,blogContent:r.content,blogUrl:V||void 0,sourceUrls:V?[V]:void 0,qaData:p.faqs.map(K=>({question:K.question,answer:K.answer})),totalInputTokens:r.content.length/4,totalOutputTokens:p.faqs.reduce((K,pe)=>K+pe.question.length+pe.answer.length,0)/4,statistics:{totalQuestions:p.faqs.length,avgAccuracy:"85",avgCitationLikelihood:"75",totalCost:"0.01"},userId:t.id};de(K=>[Q,...K]),me(Q)}const f=p.faqs.length===1?"FAQ":"FAQs";se(`Successfully generated ${p.faqs.length} ${f}!`)}else if(console.error("[Pending FAQ] Invalid response format:",p),se("Failed to generate FAQs. Please try again."),D(!1),Me(null),t?.id){const f=v("pending_faq_generation",t.id);localStorage.removeItem(f)}}catch(p){if(console.error("[Pending FAQ] Error generating FAQs:",p),se("Error generating FAQs. Please try again."),D(!1),Me(null),t?.id){const f=v("pending_faq_generation",t.id);localStorage.removeItem(f)}}},Z=async()=>{if(!Ae.trim()){se("Please enter some content first");return}const r=Ae.trim();if(!(f=>{try{return new URL(f),!0}catch{return!1}})(r)){if(/^\d+$/.test(r)){N("error"),se("Enter valid content");return}if(/^[\p{Emoji}\p{Symbol}\p{Punctuation}\s]+$/u.test(r)){N("error"),se("Enter valid content");return}if(r.length<10||/^[a-zA-Z\s]{1,10}$/.test(r)){N("error"),se("Enter valid content");return}if(r.split(/\s+/).filter(V=>V.length>0).length<3){N("error"),se("Enter valid content");return}}R(!0),T([]),C(new Set);try{const f=await ye.generateAIFAQs({content:Ae.trim(),provider:X,model:te,targetKeywords:ie,generateQuestionsOnly:!0});if(f.success&&f.questions){const V=f.questions||[];T(V),Te(!0);const Q=V.length===1?"question":"questions";N("success"),se(`Generated ${V.length} ${Q} successfully!`),ve(V)}else N("error"),se("Failed to generate questions. Please try again.")}catch(f){console.error("[Questions Generation] Error:",f),N("error"),se("Error generating questions. Please try again.")}finally{R(!1)}},G=async()=>{const r=S.name.trim()||ae.categoryName.trim(),p=ne.trim();if(!r&&!p){se("Please fill in product/category name or provide additional content");return}if(p){const f=ne.trim();if(!(Q=>{try{return new URL(Q),!0}catch{return!1}})(f)){if(/^\d+$/.test(f)){N("error"),se("Enter valid content");return}if(/^[\p{Emoji}\p{Symbol}\p{Punctuation}\s]+$/u.test(f)){N("error"),se("Enter valid content");return}if(f.length<10||/^[a-zA-Z\s]{1,10}$/.test(f)){N("error"),se("Enter valid content");return}if(f.split(/\s+/).filter(K=>K.length>0).length<3){N("error"),se("Enter valid content");return}}}F(!0),be([]),fe(new Set),h([]),Y(!1);try{let f="";if(r){const Q=S.name||ae.categoryName,K=S.targetAudience||"";f=`Product/Category: ${Q}
Target Audience: ${K}`}if(p){const Q=ne.trim();if(I(Q)){console.log("[E-commerce FAQ] Detected URL, crawling content:",Q);try{const K=await ye.extractContentFromUrl(Q);if(K.success&&K.content){const pe=K.content;f?f+=`

Additional Content from URL (${Q}):
${pe}`:f=`Content from URL (${Q}):
${pe}`,console.log("[E-commerce FAQ] Successfully crawled URL content, length:",pe.length)}else console.warn("[E-commerce FAQ] Failed to crawl URL, using URL as text"),f?f+=`

Additional Content:
${ne}`:f=ne}catch(K){console.error("[E-commerce FAQ] Error crawling URL:",K),f?f+=`

Additional Content:
${ne}`:f=ne}}else f?f+=`

Additional Content:
${ne}`:f=ne}const V=await ye.generateAIFAQs({content:f.trim(),provider:X,model:te,targetKeywords:ie,generateQuestionsOnly:!0});if(V.success&&V.questions){const Q=V.questions||[];be(Q),w(!0);const K=Q.length===1?"question":"questions";N("success"),se(`Generated ${Q.length} ${K} successfully!`)}else N("error"),se("Failed to generate questions. Please try again.")}catch(f){console.error("[E-commerce Questions Generation] Error:",f),N("error"),f instanceof Error&&(f.message.includes("403")||f.message.includes("Forbidden")||f.message.includes("Invalid or expired token")||f.message.includes("Session expired"))?(se("Your session has expired. Please log in again."),setTimeout(()=>{window.location.href="/login"},2e3)):se("Error generating questions. Please try again.")}finally{F(!1)}},oe=async()=>{if(ge.size===0){se("Please select at least one question to generate answers for");return}x(!0);try{let r="";const p=S.name.trim()||ae.categoryName.trim(),f=ne.trim();if(p){const K=S.name||ae.categoryName,pe=S.targetAudience||"";r=`Product/Category: ${K}
Target Audience: ${pe}`}if(f){const K=ne.trim();if(I(K)){console.log("[E-commerce FAQ] Detected URL for answers, crawling content:",K);try{const pe=await ye.extractContentFromUrl(K);if(pe.success&&pe.content){const Ee=pe.content;r?r+=`

Additional Content from URL (${K}):
${Ee}`:r=`Content from URL (${K}):
${Ee}`,console.log("[E-commerce FAQ] Successfully crawled URL content for answers, length:",Ee.length)}else console.warn("[E-commerce FAQ] Failed to crawl URL for answers, using URL as text"),r?r+=`

Additional Content:
${ne}`:r=ne}catch(pe){console.error("[E-commerce FAQ] Error crawling URL for answers:",pe),r?r+=`

Additional Content:
${ne}`:r=ne}}else r?r+=`

Additional Content:
${ne}`:r=ne}const V=Array.from(ge).map(K=>le[K]),Q=await ye.generateAIFAQs({content:r.trim(),provider:X,model:te,targetKeywords:ie,selectedQuestions:V,generateAnswersOnly:!0});if(Q.success&&Q.faqs){const K=Q.faqs.map(pe=>({question:pe.question,answer:pe.answer}));h(pe=>[...pe,...K]),N("success"),se(`Generated answers for ${K.length} questions successfully!`)}else N("error"),se("Failed to generate answers. Please try again.")}catch(r){console.error("[E-commerce Answers Generation] Error:",r),N("error"),r instanceof Error&&(r.message.includes("403")||r.message.includes("Forbidden")||r.message.includes("Invalid or expired token")||r.message.includes("Session expired"))?(se("Your session has expired. Please log in again."),setTimeout(()=>{window.location.href="/login"},2e3)):se("Error generating answers. Please try again.")}finally{x(!1)}},ve=r=>{if(!t?.id){console.warn("[FAQ Session] Cannot save questions session - no user ID");return}const p={id:`faq-${Date.now()}`,name:`FAQ Session - ${new Date().toLocaleDateString()}`,type:"faq",timestamp:new Date().toISOString(),model:te,questionProvider:X||null,answerProvider:X||null,questionModel:te||null,answerModel:te||null,blogContent:Ae,blogUrl:H(Ae)||void 0,sourceUrls:H(Ae)?[H(Ae)]:[],qaData:[],totalInputTokens:0,totalOutputTokens:0,statistics:{totalQuestions:r.length,avgAccuracy:"N/A",avgCitationLikelihood:"N/A",totalCost:"N/A"},userId:t.id,generatedQuestions:r,showQuestionsSection:!0,showFAQSection:!1};console.log("[FAQ Session] Saving questions session:",{id:p.id,questionsLength:p.generatedQuestions?.length||0,blogContentLength:p.blogContent.length,userId:p.userId}),de(f=>[p,...f]),me(p)},He=r=>{t?.id&&(de(p=>p.filter(V=>V.id!==r)),W?.id===r&&me(null),Re(p=>{const f=new Set(p);return f.delete(r),f}))},We=r=>{if(!r)return null;if(typeof r=="object"&&("productContent"in r||"categoryContent"in r||"faqs"in r))return r;if(typeof r=="object"&&"shortDescription"in r&&"longDescription"in r)return{productContent:r,categoryContent:void 0,faqs:[],seoRecommendations:{schemaSuggestions:[],contentDepthScore:0,aiOptimizationTips:[],technicalSeoReminders:[]}};if(typeof r=="object"&&"faqs"in r){const p=r.faqs;let f=[];if(Array.isArray(p))f=p;else if(Array.isArray(p?.faqs))f=p.faqs;else if(p&&typeof p=="object")try{f=Object.values(p)}catch{f=[]}const V=r.seoRecommendations||p?.seoRecommendations||{schemaSuggestions:[],contentDepthScore:0,aiOptimizationTips:[],technicalSeoReminders:[]};return{productContent:void 0,categoryContent:void 0,faqs:f,seoRecommendations:V}}return null},is=async()=>{if(!S.name.trim()||!S.features.trim()){alert("Please fill in product name and features");return}ee(!0);const r=performance.now();try{const p=await ye.generateEcommerceContent({type:"product",inputs:S,provider:X,model:te});if(p.success){console.log("[Product Content] Received data:",p.data);const f=We(p.data);_(f);const V=Math.round(performance.now()-r);se(`Product content generated successfully in ${V}ms!`)}else console.error("[Product Content] API error:",p.error),alert("Failed to generate product content: "+(p.error||"Unknown error"))}catch(p){console.error("Error generating product content:",p),alert("Failed to generate product content")}finally{ee(!1)}},ls=async()=>{if(!ae.categoryName.trim()){alert("Please fill in category name");return}ee(!0);try{const r=await ye.generateEcommerceContent({type:"category",inputs:ae,provider:X,model:te});if(r.success){console.log("[Category Content] Received data:",r.data);const p=We(r.data);_(p),se("Category content generated successfully!")}else console.error("[Category Content] API error:",r.error),alert("Failed to generate category content: "+(r.error||"Unknown error"))}catch(r){console.error("Error generating category content:",r),alert("Failed to generate category content")}finally{ee(!1)}};return e.jsxs("div",{className:"flex gap-8 w-full",children:[e.jsx("div",{className:"flex-1 space-y-8",children:e.jsxs("div",{className:"card bg-white border border-primary/10 shadow-xl",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h2",{className:"text-3xl font-bold text-gray-900 mb-3",children:"GEO Content Writer Tool"}),e.jsx("p",{className:"text-gray-600 text-lg",children:"Generate high-quality, SEO-optimized content for your products and categories."})]}),e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-base font-semibold text-black mb-3 flex items-center gap-2",children:[e.jsx(yt,{className:"w-5 h-5 text-black"}),"Content Type"]}),e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("button",{onClick:()=>l("product"),className:`px-4 py-2 rounded-lg font-medium transition-all duration-200 flex items-center gap-2 ${s==="product"?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:[e.jsx(yt,{className:"w-4 h-4"}),"Product Description"]}),e.jsxs("button",{onClick:()=>l("category"),className:`px-4 py-2 rounded-lg font-medium transition-all duration-200 flex items-center gap-2 ${s==="category"?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:[e.jsx(vt,{className:"w-4 h-4"}),"Category Page"]}),e.jsxs("button",{onClick:()=>l("faq"),className:`px-4 py-2 rounded-lg font-medium transition-all duration-200 flex items-center gap-2 ${s==="faq"?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:[e.jsx(ht,{className:"w-4 h-4"}),"FAQ Generator"]})]})]}),s==="product"&&e.jsxs("div",{className:"space-y-4 p-4 bg-blue-50 rounded-lg",children:[e.jsx("h3",{className:"text-lg font-semibold text-black",children:"Product Description Generator"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Product Name"}),e.jsx("input",{type:"text",value:S.name,onChange:r=>g(p=>({...p,name:r.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"e.g., iPhone 15 Pro"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Category"}),e.jsx("input",{type:"text",value:S.category,onChange:r=>g(p=>({...p,category:r.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"e.g., Smartphones"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Target Audience"}),e.jsx("input",{type:"text",value:S.targetAudience,onChange:r=>g(p=>({...p,targetAudience:r.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"e.g., Tech enthusiasts, professionals"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tone"}),e.jsxs("select",{value:S.tone,onChange:r=>g(p=>({...p,tone:r.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[e.jsx("option",{value:"casual",children:"Casual"}),e.jsx("option",{value:"professional",children:"Professional"}),e.jsx("option",{value:"persuasive",children:"Persuasive"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Features/Specs"}),e.jsx("textarea",{value:S.features,onChange:r=>g(p=>({...p,features:r.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",rows:3,placeholder:"List key features, specifications, and technical details..."})]}),e.jsxs("button",{onClick:is,disabled:ue,className:"bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 transition-colors flex items-center gap-2 disabled:opacity-50",children:[ue?e.jsx(Pe,{className:"w-4 h-4 animate-spin"}):e.jsx(Je,{className:"w-4 h-4"}),"Generate Product Content"]})]}),s==="category"&&e.jsxs("div",{className:"space-y-4 p-4 bg-blue-50 rounded-lg",children:[e.jsx("h3",{className:"text-lg font-semibold text-black",children:"Category Page Content Generator"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Category Name"}),e.jsx("input",{type:"text",value:ae.categoryName,onChange:r=>re(p=>({...p,categoryName:r.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"e.g., Men's T-Shirts"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Product Types"}),e.jsx("input",{type:"text",value:ae.productTypes,onChange:r=>re(p=>({...p,productTypes:r.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"e.g., Cotton, Polyester, Blends"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Target Audience"}),e.jsx("input",{type:"text",value:ae.audience,onChange:r=>re(p=>({...p,audience:r.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"e.g., Fashion-conscious men, 25-45 years old"})]})]}),e.jsxs("button",{onClick:ls,disabled:ue,className:"bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 transition-colors flex items-center gap-2 disabled:opacity-50",children:[ue?e.jsx(Pe,{className:"w-4 h-4 animate-spin"}):e.jsx(Je,{className:"w-4 h-4"}),"Generate Category Content"]})]}),s==="faq"&&e.jsxs("div",{className:"space-y-4 p-4 bg-blue-50 rounded-lg",children:[e.jsx("h3",{className:"text-lg font-semibold text-black",children:"E-commerce FAQ Generator"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Product/Category Name"}),e.jsx("input",{type:"text",value:S.name||ae.categoryName,onChange:r=>{g(p=>({...p,name:r.target.value})),re(p=>({...p,categoryName:r.target.value}))},className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"e.g., iPhone 15 Pro or Men's T-Shirts"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Customer Intent"}),e.jsx("input",{type:"text",value:S.targetAudience,onChange:r=>g(p=>({...p,targetAudience:r.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"e.g., Buying first smartphone, Finding perfect fit"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Paste URL or content (optional)"}),e.jsxs("div",{className:"relative",children:[e.jsx("textarea",{ref:d,value:ne,onChange:r=>{const p=r.target.value;Ce(p);const f=r.target;f.style.height="auto";const V=Math.max(36,Math.min(f.scrollHeight,150));f.style.height=`${V}px`},placeholder:"Paste URL or content here...",rows:1,className:"w-full bg-white border border-gray-300 rounded-lg px-3 py-2 pr-12 text-black text-sm placeholder-black focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200 resize-none scrollbar-hide",style:{minHeight:"36px",maxHeight:"150px",height:"auto",overflow:"auto",scrollbarWidth:"none",msOverflowStyle:"none"}}),e.jsxs("div",{className:"absolute right-2 bottom-2",children:[e.jsx("input",{type:"file",id:"ecom-file-upload",accept:".txt,.md,.doc,.docx",onChange:r=>{const p=r.target.files?.[0];if(p){const f=new FileReader;f.onload=V=>{const Q=V.target?.result||"";Ce(Q),setTimeout(()=>{if(d.current){d.current.style.height="auto";const K=Math.max(36,Math.min(d.current.scrollHeight,150));d.current.style.height=`${K}px`}},100)},f.readAsText(p)}},className:"hidden"}),e.jsx("label",{htmlFor:"ecom-file-upload",className:"cursor-pointer p-1.5 rounded-full transition-all duration-200 flex items-center justify-center bg-gray-100 hover:bg-gray-200 text-gray-600 hover:text-gray-800",title:"Upload file (.txt, .md, .doc, .docx)",children:e.jsx(as,{className:"w-4 h-4"})})]})]})]}),e.jsxs("button",{onClick:G,disabled:z,className:"bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 transition-colors flex items-center gap-2 disabled:opacity-50",children:[z?e.jsx(Pe,{className:"w-4 h-4 animate-spin"}):e.jsx(Je,{className:"w-4 h-4"}),"Generate Questions"]})]})]}),s==="faq"&&m&&le.length>0&&e.jsxs("div",{className:"space-y-4 p-4 bg-blue-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h3",{className:"text-lg font-semibold text-black flex items-center gap-2",children:[e.jsx(Nt,{className:"w-5 h-5"}),"Generated Questions"]}),e.jsx("span",{className:"text-sm text-gray-600",children:"Select questions to generate answers"})]}),e.jsx("div",{className:"space-y-4",children:le.map((r,p)=>{const f=c.find(V=>V.question===r);return e.jsx("div",{className:"bg-white rounded border p-4",children:e.jsxs("label",{className:"flex items-start gap-3 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:ge.has(p),onChange:V=>{const Q=new Set(ge);V.target.checked?Q.add(p):Q.delete(p),fe(Q)},className:"mt-1 h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"text-gray-800 font-medium mb-2",children:["Q",p+1,": ",r]}),f&&e.jsxs("div",{className:"mt-3 p-3 bg-gray-50 rounded border border-gray-200",children:[e.jsx("div",{className:"text-sm text-gray-600 mb-2 font-medium",children:"Answer:"}),e.jsx("div",{className:"text-gray-700 text-sm leading-relaxed",children:f.answer})]})]})]})},p)})}),e.jsx("div",{className:"flex justify-start",children:e.jsxs("button",{onClick:oe,disabled:k||ge.size===0,className:"bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 transition-colors flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:[k?e.jsx(Pe,{className:"w-4 h-4 animate-spin"}):e.jsx(Qe,{className:"w-4 h-4"}),"Generate Answers"]})})]})]}),(!(s==="product"&&P&&P?.productContent||s==="category"&&P&&P?.categoryContent||s==="faq"&&P&&P?.faqs&&P?.faqs.length>0)?!1:(console.log("[E-commerce Display] Rendering content:",P),!0))&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(mt,{className:"w-6 h-6 text-blue-600"}),e.jsx("h3",{className:"text-2xl font-bold text-black",children:"Generated E-commerce Content"})]}),s==="product"&&P?.productContent&&e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"bg-blue-50 p-6 rounded-lg",children:[e.jsxs("h4",{className:"text-lg font-semibold text-black mb-4 flex items-center gap-2",children:[e.jsx(yt,{className:"w-5 h-5"}),"Product Description"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h5",{className:"font-medium text-black mb-2",children:"Short Description"}),e.jsx("p",{className:"text-gray-700 bg-white p-3 rounded border",children:P?.productContent?.shortDescription})]}),e.jsxs("div",{children:[e.jsx("h5",{className:"font-medium text-black mb-2",children:"Long Description"}),e.jsx("div",{className:"text-gray-700 bg-white p-3 rounded border whitespace-pre-wrap",children:P?.productContent.longDescription})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("h5",{className:"font-medium text-black mb-2",children:"Key Features"}),e.jsx("ul",{className:"text-gray-700 bg-white p-3 rounded border",children:P?.productContent.features.map((r,p)=>e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx(Qe,{className:"w-4 h-4 text-green-500 mt-0.5 flex-shrink-0"}),r]},p))})]}),e.jsxs("div",{children:[e.jsx("h5",{className:"font-medium text-black mb-2",children:"Benefits"}),e.jsx("ul",{className:"text-gray-700 bg-white p-3 rounded border",children:P?.productContent.benefits.map((r,p)=>e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx(Qe,{className:"w-4 h-4 text-green-500 mt-0.5 flex-shrink-0"}),r]},p))})]})]}),e.jsxs("div",{children:[e.jsx("h5",{className:"font-medium text-black mb-2",children:"Comparison"}),e.jsx("div",{className:"text-gray-700 bg-white p-3 rounded border whitespace-pre-wrap",children:P?.productContent.comparison})]}),e.jsxs("div",{children:[e.jsx("h5",{className:"font-medium text-black mb-2",children:"Technical Specifications"}),e.jsx("div",{className:"bg-white p-3 rounded border",children:e.jsx("table",{className:"w-full text-sm",children:e.jsx("tbody",{children:Object.entries(P?.productContent.specs).map(([r,p])=>e.jsxs("tr",{className:"border-b border-gray-100",children:[e.jsx("td",{className:"font-medium text-gray-700 py-2 pr-4",children:r}),e.jsx("td",{className:"text-gray-600 py-2",children:p})]},r))})})})]}),e.jsxs("div",{children:[e.jsx("h5",{className:"font-medium text-black mb-2",children:"Use Cases"}),e.jsx("ul",{className:"text-gray-700 bg-white p-3 rounded border",children:P?.productContent.useCases.map((r,p)=>e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx(Qe,{className:"w-4 h-4 text-green-500 mt-0.5 flex-shrink-0"}),r]},p))})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("h5",{className:"font-medium text-black mb-2",children:"Keywords"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:P?.productContent.keywords.map((r,p)=>e.jsx("span",{className:"bg-blue-100 text-blue-800 px-2 py-1 rounded text-sm",children:r},p))})]}),e.jsxs("div",{children:[e.jsx("h5",{className:"font-medium text-black mb-2",children:"Image Alt Text"}),e.jsx("div",{className:"space-y-1",children:P?.productContent.altText.map((r,p)=>e.jsx("div",{className:"text-sm text-gray-600 bg-gray-50 p-2 rounded",children:r},p))})]})]}),e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[e.jsx("h5",{className:"font-medium text-black mb-2",children:"Meta Tags"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-700",children:"Title:"}),e.jsx("div",{className:"text-gray-600 bg-white p-2 rounded border mt-1",children:P?.productContent.metaTags.title})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-700",children:"Description:"}),e.jsx("div",{className:"text-gray-600 bg-white p-2 rounded border mt-1",children:P?.productContent.metaTags.description})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-700",children:"Keywords:"}),e.jsx("div",{className:"text-gray-600 bg-white p-2 rounded border mt-1",children:P?.productContent.metaTags.keywords})]})]})]})]})]})}),s==="category"&&P?.categoryContent&&e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"bg-blue-50 p-6 rounded-lg",children:[e.jsxs("h4",{className:"text-lg font-semibold text-black mb-4 flex items-center gap-2",children:[e.jsx(vt,{className:"w-5 h-5"}),"Category Page Content"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h5",{className:"font-medium text-black mb-2",children:"Introduction"}),e.jsx("div",{className:"text-gray-700 bg-white p-3 rounded border whitespace-pre-wrap",children:P?.categoryContent.intro})]}),e.jsxs("div",{children:[e.jsx("h5",{className:"font-medium text-black mb-2",children:"Buying Guide"}),e.jsx("div",{className:"text-gray-700 bg-white p-3 rounded border whitespace-pre-wrap",children:P?.categoryContent.buyingGuide})]}),e.jsxs("div",{children:[e.jsx("h5",{className:"font-medium text-black mb-2",children:"Comparison Chart"}),(()=>{const r=P?.categoryContent.comparisonChart||"";if(!(/\|\s*Feature\s*\|/i.test(r)||/\|\-+\|/.test(r)))return e.jsx("div",{className:"text-gray-700 bg-white p-3 rounded border whitespace-pre-wrap",children:r});const Q=r.split(/\r?\n/).filter(Ee=>Ee.trim().length>0).map(Ee=>Ee.trim().replace(/^\|/,"").replace(/\|$/,"").split("|").map(Ye=>Ye.trim())).filter(Ee=>!Ee.every(Ye=>/^:?-{2,}:?$/.test(Ye))),K=Q[0]||[],pe=Q.slice(1);return e.jsx("div",{className:"bg-white p-3 rounded border overflow-x-auto",children:e.jsxs("table",{className:"min-w-full text-sm text-gray-700",children:[e.jsx("thead",{children:e.jsx("tr",{children:K.map((Ee,Ye)=>e.jsx("th",{className:"text-left font-semibold border-b border-gray-200 px-3 py-2 whitespace-nowrap",children:Ee},Ye))})}),e.jsx("tbody",{children:pe.map((Ee,Ye)=>e.jsx("tr",{className:"border-b border-gray-100",children:Ee.map((cs,ds)=>e.jsx("td",{className:"px-3 py-2 align-top whitespace-nowrap",children:cs},ds))},Ye))})]})})})()]}),e.jsxs("div",{children:[e.jsx("h5",{className:"font-medium text-black mb-2",children:"Internal Links"}),e.jsx("ul",{className:"text-gray-700 bg-white p-3 rounded border",children:P?.categoryContent.internalLinks.map((r,p)=>e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx(ss,{className:"w-4 h-4 text-blue-500 mt-0.5 flex-shrink-0"}),r]},p))})]})]})]})}),s==="faq"&&P?.faqs&&P?.faqs.length>0&&e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"bg-blue-50 p-6 rounded-lg",children:[e.jsxs("h4",{className:"text-lg font-semibold text-black mb-4 flex items-center gap-2",children:[e.jsx(ht,{className:"w-5 h-5"}),"Generated FAQs"]}),e.jsx("div",{className:"space-y-4",children:P?.faqs.map((r,p)=>e.jsxs("div",{className:"bg-white p-4 rounded border",children:[e.jsxs("div",{className:"font-medium text-black mb-2",children:["Q: ",r.question]}),e.jsxs("div",{className:"text-gray-700",children:["A: ",r.answer]})]},p))})]})}),P?.seoRecommendations&&(s==="product"&&!!P?.productContent||s==="category"&&!!P?.categoryContent||s==="faq"&&!!(P?.faqs&&P?.faqs.length>0))&&e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"bg-yellow-50 p-6 rounded-lg",children:[e.jsxs("h4",{className:"text-lg font-semibold text-black mb-4 flex items-center gap-2",children:[e.jsx(Je,{className:"w-5 h-5"}),"AI SEO Recommendations"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h5",{className:"font-medium text-black mb-2",children:"Schema Suggestions"}),e.jsx("ul",{className:"text-gray-700 bg-white p-3 rounded border",children:P?.seoRecommendations.schemaSuggestions.map((r,p)=>e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx(Qe,{className:"w-4 h-4 text-blue-600 mt-0.5 flex-shrink-0"}),e.jsx(Qe,{className:"w-4 h-4 text-blue-600 mt-0.5 flex-shrink-0"}),e.jsx(Qe,{className:"w-4 h-4 text-blue-600 mt-0.5 flex-shrink-0"}),r]},p))})]}),e.jsxs("div",{children:[e.jsxs("h5",{className:"font-medium text-black mb-2",children:["Content Depth Score: ",P?.seoRecommendations.contentDepthScore,"/100"]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-blue-600 h-2 rounded-full",style:{width:`${P?.seoRecommendations.contentDepthScore}%`}})})]}),e.jsxs("div",{children:[e.jsx("h5",{className:"font-medium text-black mb-2",children:"AI Optimization Tips"}),e.jsx("ul",{className:"text-gray-700 bg-white p-3 rounded border",children:P?.seoRecommendations.aiOptimizationTips.map((r,p)=>e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx(wt,{className:"w-4 h-4 text-blue-500 mt-0.5 flex-shrink-0"}),r]},p))})]}),e.jsxs("div",{children:[e.jsx("h5",{className:"font-medium text-black mb-2",children:"Technical SEO Reminders"}),e.jsx("ul",{className:"text-gray-700 bg-white p-3 rounded border",children:P?.seoRecommendations.technicalSeoReminders.map((r,p)=>e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx(wt,{className:"w-4 h-4 text-orange-500 mt-0.5 flex-shrink-0"}),r]},p))})]})]})]})})]})]})}),e.jsxs("div",{className:"w-80 space-y-6",children:[e.jsx("div",{className:"bg-white border border-gray-200 rounded-lg p-4 shadow-sm",children:e.jsxs("button",{onClick:()=>{if($e(""),Ce(""),h([]),T([]),C(new Set),be([]),fe(new Set),Le(!1),Te(!1),Y(!1),w(!1),me(null),R(!1),L(!1),Me(null),t?.id){const r=v(At,t.id),p=v("pending_faq_generation",t.id),f=v("generated_faqs",t.id);localStorage.removeItem(r),localStorage.removeItem(p),localStorage.removeItem(f);try{localStorage.removeItem(j())}catch{}}E.current&&(E.current.style.height="36px")},className:"w-full bg-white text-black font-bold px-3 py-2 rounded-lg hover:bg-gray-50 transition-all duration-200 flex items-center gap-2 justify-start border border-blue-600 text-sm",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),"New Analysis"]})}),e.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4 shadow-sm",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx("svg",{className:"w-5 h-5 text-black",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),e.jsx("h3",{className:"text-lg font-semibold text-black",children:"History"})]}),e.jsxs("div",{className:"space-y-3 max-h-96 overflow-y-auto scrollbar-hide",style:{scrollbarWidth:"none",msOverflowStyle:"none"},children:[xe.slice(0,50).map((r,p)=>e.jsxs("div",{className:"p-3 bg-gray-50 rounded-lg border border-gray-200 hover:border-gray-300 transition-all duration-200",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[r.type==="faq"?e.jsx("svg",{className:"w-4 h-4 text-black flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}):e.jsx("svg",{className:"w-4 h-4 text-gray-500 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1"})}),e.jsx("div",{className:"text-sm font-medium text-black truncate",children:r.name})]}),e.jsx("div",{className:"text-xs text-gray-500",children:new Date(r.timestamp).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]}),e.jsx("button",{onClick:()=>{const f=new Set(we);f.has(r.id)?f.delete(r.id):f.add(r.id),Re(f)},className:"p-2 bg-white border border-gray-300 rounded-lg text-gray-600 hover:text-gray-800 hover:bg-gray-50 transition-all duration-200",title:we.has(r.id)?"Collapse":"Expand",children:we.has(r.id)?e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 15l7-7 7 7"})}):e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})})]}),we.has(r.id)&&e.jsx("div",{className:"mt-3 pt-3 border-t border-gray-200",children:r.type==="faq"?e.jsxs("div",{className:"space-y-3",children:[r.blogUrl&&e.jsxs("div",{className:"text-xs text-black bg-gray-50 p-2 rounded border border-gray-200",children:[e.jsx("strong",{children:"Source URL:"})," ",r.blogUrl]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"text-xs text-gray-600 font-medium",children:"Generated FAQs:"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>{$e(r.blogContent||""),he(r.questionProvider||"gemini"),U(r.questionModel||(r.questionProvider==="perplexity"?"sonar":r.questionProvider==="claude"?"claude-3.5-sonnet-20241022":"gemini-2.0-flash")),Z()},className:"p-2 bg-white border border-gray-300 rounded-lg text-black hover:text-gray-800 hover:bg-gray-50 transition-all duration-200",title:"Regenerate FAQs",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})}),e.jsx("button",{onClick:()=>{const f=r.qaData?.map(pe=>({question:pe.question,answer:pe.answer}))||[],V=new Blob([JSON.stringify(f,null,2)],{type:"application/json"}),Q=URL.createObjectURL(V),K=document.createElement("a");K.href=Q,K.download=`faqs-${r.name.replace(/\s+/g,"-")}.json`,document.body.appendChild(K),K.click(),document.body.removeChild(K),URL.revokeObjectURL(Q),se("FAQs downloaded successfully!")},className:"p-2 bg-white border border-gray-300 rounded-lg text-gray-600 hover:text-gray-800 hover:bg-gray-50 transition-all duration-200",title:"Download FAQs as JSON",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})}),e.jsx("button",{onClick:()=>He(r.id),className:"p-2 bg-white border border-gray-300 rounded-lg text-red-600 hover:text-red-800 hover:bg-red-50 transition-all duration-200",title:"Delete session",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1 1v3M4 7h16"})})})]})]}),r.generatedQuestions&&r.generatedQuestions.length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"text-xs text-gray-600 font-medium",children:["Questions (",r.generatedQuestions.length,"):"]}),r.generatedQuestions.slice(0,5).map((f,V)=>{const Q=r.qaData?.some(pe=>pe.question===f),K=r.qaData?.find(pe=>pe.question===f);return e.jsxs("div",{className:"p-1.5 bg-white rounded border border-gray-200",children:[e.jsxs("div",{className:"font-medium text-xs text-black leading-tight",children:["Q: ",f]}),Q&&K?e.jsxs("div",{className:"text-xs text-gray-600 leading-tight mt-0.5",children:["A: ",K.answer]}):e.jsx("div",{className:"text-xs text-gray-500 mt-0.5",children:"(Answer not generated yet)"})]},V)}),r.generatedQuestions.length>5&&e.jsxs("div",{className:"text-xs text-gray-500",children:["+",r.generatedQuestions.length-5," more questions"]})]}),e.jsxs("div",{className:"text-xs text-gray-500",children:["Provider: ",r.questionProvider," | Model: ",r.questionModel]})]}):e.jsxs("div",{className:"space-y-3",children:[r.blogUrl&&e.jsxs("div",{className:"text-xs text-black bg-gray-50 p-2 rounded border border-gray-200",children:[e.jsx("strong",{children:"Source URL:"})," ",r.blogUrl]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"text-xs text-gray-600 font-medium",children:"Generated Q&A:"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>{$e(r.blogContent||""),he(r.questionProvider||"gemini"),U(r.questionModel||(r.questionProvider==="perplexity"?"sonar":r.questionProvider==="claude"?"claude-3.5-sonnet-20241022":"gemini-2.0-flash")),Z()},className:"p-2 bg-white border border-gray-300 rounded-lg text-black hover:text-gray-800 hover:bg-gray-50 transition-all duration-200",title:"Regenerate Q&A",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})}),e.jsx("button",{onClick:()=>{const f=r.qaData?.map(pe=>({question:pe.question,answer:pe.answer}))||[],V=new Blob([JSON.stringify(f,null,2)],{type:"application/json"}),Q=URL.createObjectURL(V),K=document.createElement("a");K.href=Q,K.download=`qa-${r.name.replace(/\s+/g,"-")}.json`,document.body.appendChild(K),K.click(),document.body.removeChild(K),URL.revokeObjectURL(Q),se("Q&A data downloaded successfully!")},className:"p-2 bg-white border border-gray-300 rounded-lg text-gray-600 hover:text-gray-800 hover:bg-gray-50 transition-all duration-200",title:"Download Q&A as JSON",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})}),e.jsx("button",{onClick:()=>He(r.id),className:"p-2 bg-white border border-gray-300 rounded-lg text-red-600 hover:text-red-800 hover:bg-red-50 transition-all duration-200",title:"Delete session",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1 1v3M4 7h16"})})})]})]}),r.qaData?.slice(0,3).map((f,V)=>e.jsxs("div",{className:"p-2 bg-white rounded border border-gray-200",children:[e.jsxs("div",{className:"font-medium text-sm text-black mb-1",children:["Q: ",f.question]}),e.jsxs("div",{className:"text-xs text-gray-600",children:["A: ",f.answer]})]},V)),r.qaData&&r.qaData.length>3&&e.jsxs("div",{className:"text-xs text-gray-500",children:["+",r.qaData.length-3," more questions"]}),e.jsxs("div",{className:"text-xs text-gray-500",children:["Provider: ",r.questionProvider," | Model: ",r.questionModel]})]})})]},r.id)),xe.length===0&&e.jsx("div",{className:"text-center text-gray-500 text-sm py-4",children:"No analysis history yet"})]})]})]}),e.jsx(Kt,{message:je,onClose:()=>se(null),autoClose:!0,autoCloseDelay:3e3,type:at})]})}const ya=({idleMinutes:t=10,warningSeconds:o=60,redirectDelayMs:y=2500})=>{const{logout:s}=tt(),l=qe(),[c,h]=n.useState(!1),[u,T]=n.useState(!1),b=n.useRef(null),C=n.useRef(null),$=n.useCallback(()=>{b.current&&(window.clearTimeout(b.current),b.current=null),C.current&&(window.clearTimeout(C.current),C.current=null)},[]),R=n.useCallback(()=>{$(),h(!1);const L=Math.max(1,t)*6e4,O=Math.max(0,L-Math.max(0,o)*1e3);b.current=window.setTimeout(()=>{h(!0)},O),C.current=window.setTimeout(async()=>{h(!1),T(!0),window.setTimeout(async()=>{try{await s(),console.log("ðŸ” IdleSessionManager: Logout completed, redirecting...")}catch(D){console.error("ðŸ” IdleSessionManager: Logout failed:",D)}l("/",{replace:!0})},y)},L)},[$,t,o,y,s,l]),q=n.useCallback(()=>{R()},[R]);return n.useEffect(()=>{R();const L=["mousemove","keydown","click","scroll","touchstart"];L.forEach(D=>window.addEventListener(D,q,{passive:!0}));const O=()=>h(!1);return L.forEach(D=>window.addEventListener(D,O,{passive:!0})),()=>{$(),L.forEach(D=>window.removeEventListener(D,q)),L.forEach(D=>window.removeEventListener(D,O))}},[R,q,$]),e.jsxs(e.Fragment,{children:[c&&e.jsx("div",{className:"fixed inset-0 z-[1000] flex items-center justify-center bg-black/30",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-xl border border-gray-200 p-6 w-[90%] max-w-sm text-center",children:[e.jsx("div",{className:"text-lg font-semibold text-gray-900 mb-2",children:"You are about to be signed out"}),e.jsx("div",{className:"text-sm text-gray-600 mb-4",children:"Due to inactivity, your session will expire soon. Move your mouse or press any key to stay signed in."}),e.jsx("button",{onClick:()=>q(),className:"inline-flex items-center justify-center px-4 py-2 rounded-lg bg-black text-white hover:bg-gray-800 transition-colors w-full",children:"Stay signed in"})]})}),u&&e.jsx("div",{className:"fixed bottom-4 left-1/2 -translate-x-1/2 z-[1100]",children:e.jsx("div",{className:"bg-gray-900 text-white px-4 py-2 rounded-lg shadow-lg text-sm",children:"Session expired. Redirecting to login..."})})]})},ba="llm_qa_sessions",wa="llm_qa_current_session",va=[{label:"Dashboard",icon:e.jsx(Je,{}),path:"/overview"},{label:"Competitor Insight",icon:e.jsx(Ke,{}),path:"/ai-visibility-analysis"},{label:"Product Insights",icon:e.jsx(Fe,{}),path:"/product-insights"},{label:"Content Enhancement",icon:e.jsx(Ge,{}),path:"/enhance-content"},{label:"Structure Analysis",icon:e.jsx(Nt,{}),path:"/content-structure-analysis"},{label:"Content Analysis",icon:e.jsx(Fe,{}),path:"/ecommerce-content-analysis"},{label:"Settings",icon:e.jsx(rs,{}),path:"/configuration"},{label:"History",icon:e.jsx(Jt,{}),path:"/history"},{label:"Statistics",icon:e.jsx(Fe,{}),path:"/statistics"}];function ja({isOpen:t,setIsOpen:o,onLogout:y,user:s,currentPath:l}){const c=qe(),h=u=>{c(u),o(!1)};return e.jsxs(e.Fragment,{children:[t&&e.jsx("div",{className:"fixed inset-0 bg-black/50 z-40 md:hidden",onClick:()=>o(!1)}),e.jsxs("aside",{className:`fixed md:static inset-y-0 left-0 z-50 bg-white w-64 min-h-screen flex flex-col border-r border-gray-200 shadow-lg transform transition-transform duration-300 md:transform-none sidebar-responsive ${t?"translate-x-0":"-translate-x-full"}`,children:[e.jsxs("div",{className:"flex items-center justify-between p-3 border-b border-primary/10 header-responsive",children:[e.jsxs("div",{className:"flex items-center gap-3 flex-1 min-w-0 logo-container",children:[e.jsxs("div",{className:"w-8 h-8 bg-gradient-to-r from-blue-600 to-blue-700 rounded-lg flex items-center justify-center flex-shrink-0 logo-icon",children:[e.jsx(Je,{className:"w-5 h-5 text-white"}),e.jsx("span",{className:"text-white text-lg font-bold",style:{display:"none"},children:"âš¡"})]}),e.jsx("span",{className:"text-lg font-bold text-primary tracking-wide truncate logo-text",children:"Kabini.ai"})]}),e.jsx("button",{className:"md:hidden text-gray-500 hover:text-gray-700 hover:bg-gray-100 transition-colors p-1.5 rounded-md flex items-center justify-center flex-shrink-0 ml-2",onClick:()=>o(!1),"aria-label":"Close menu",children:e.jsxs("div",{className:"relative w-5 h-5 flex items-center justify-center",children:[e.jsx("div",{className:"absolute w-4 h-0.5 bg-gray-600 rounded-full transform rotate-45"}),e.jsx("div",{className:"absolute w-4 h-0.5 bg-gray-600 rounded-full transform -rotate-45"})]})})]}),e.jsx("nav",{className:"flex-1 flex flex-col gap-1 mt-4 px-2 nav-responsive",children:va.map(u=>{const T=l===u.path;return e.jsxs("button",{className:`nav-item-responsive ${T?"active":""}`,onClick:()=>h(u.path),children:[u.icon,u.label]},u.path)})}),e.jsxs("div",{className:"mt-auto user-profile-section",children:[e.jsxs("div",{className:"user-profile-info",children:[e.jsx("div",{className:"user-avatar",children:e.jsx(nt,{})}),e.jsxs("div",{className:"user-details",children:[e.jsx("div",{className:"user-name",children:s?.displayName||s?.name||"User"}),e.jsx("div",{className:"user-email",children:s?.email||""})]})]}),e.jsxs("button",{className:"logout-button",onClick:y,children:[e.jsx(ns,{}),"Logout"]})]})]})]})}function Na({setIsOpen:t,onLogout:o}){return e.jsxs("header",{className:"w-full bg-white border-b border-primary/10 flex items-center justify-between px-3 sm:px-6 py-3 relative z-30 header-responsive",children:[e.jsxs("div",{className:"logo-container",children:[e.jsxs("div",{className:"logo-icon bg-gradient-to-r from-blue-600 to-blue-700 rounded-lg",children:[e.jsx(Je,{className:"w-5 h-5 text-white"}),e.jsx("span",{className:"text-white text-lg font-bold",style:{display:"none"},children:"âš¡"})]}),e.jsx("span",{className:"logo-text text-xl font-extrabold tracking-wide",children:"Kabini.ai"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{className:"md:hidden bg-black border border-black text-white px-2 py-1.5 rounded-lg text-sm font-medium hover:bg-gray-800 hover:border-gray-800 transition-all flex items-center gap-2",onClick:o,"aria-label":"Logout",children:[e.jsx(ns,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Logout"})]}),e.jsx("button",{className:"block md:hidden text-primary hover:text-accent transition-colors p-2 rounded-lg hover:bg-gray-100 flex items-center justify-center border border-gray-200 bg-white",onClick:()=>t(!0),"aria-label":"Open menu",style:{minWidth:"44px",minHeight:"44px"},children:e.jsxs("div",{className:"relative w-6 h-6",children:[e.jsx("div",{className:"absolute w-5 h-1 bg-black rounded-full top-1 left-0.5"}),e.jsx("div",{className:"absolute w-5 h-1 bg-black rounded-full top-3 left-0.5"}),e.jsx("div",{className:"absolute w-5 h-1 bg-black rounded-full top-5 left-0.5"})]})})]})]})}function Sa(){return e.jsxs("footer",{className:"w-full bg-white border-t border-primary/10 text-center text-primary py-3 text-sm",children:["Â© ",new Date().getFullYear()," Kabini.ai. All rights reserved."]})}function Gt(){return e.jsx(fa,{})}function Ca(){const{isAuthenticated:t,isLoading:o,logout:y,user:s,refreshUser:l}=tt();console.log("[App] Authentication state:",{isAuthenticated:t,isLoading:o,hasUser:!!s,userEmail:s?.email}),n.useEffect(()=>{t&&!s&&!o&&(console.log("[App] Authenticated but no user data, forcing refresh..."),l())},[t,s,o,l]),n.useEffect(()=>{t&&s&&(console.log("[App] Clearing stale localStorage data..."),["llm_qa_current_session","structure_last_saved","overview_market_analysis"].forEach(R=>{try{localStorage.getItem(R)&&(console.log(`[App] Clearing stale localStorage key: ${R}`),localStorage.removeItem(R))}catch(q){console.warn(`[App] Could not clear ${R}:`,q)}}))},[t,s]);const[c,h]=n.useState(!1),u=Ft(),[T]=bt(ba,[]),[b]=bt(wa,null);if(o)return e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-white",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-800 font-medium",children:"Loading Kabini.ai..."}),e.jsx("p",{className:"text-gray-600 text-sm mt-2",children:"Please wait while we verify your authentication..."})]})});if(t&&!s)return e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-white",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-800 font-medium",children:"Loading user data..."}),e.jsx("p",{className:"text-gray-600 text-sm mt-2",children:"Please wait while we load your profile..."})]})});if(!t)return console.log("[App] User not authenticated, showing login page"),e.jsxs($t,{children:[e.jsx(ke,{path:"/signup",element:e.jsx(ra,{})}),e.jsx(ke,{path:"/forgot-password",element:e.jsx(na,{})}),e.jsx(ke,{path:"/reset-password",element:e.jsx(oa,{})}),e.jsx(ke,{path:"/verify-email",element:e.jsx(ea,{})}),e.jsx(ke,{path:"/test-notifications",element:e.jsx(pa,{})}),e.jsx(ke,{path:"*",element:e.jsx(Rs,{})})]});console.log("[App] User is authenticated, showing main app");const C=async()=>{try{await y()}catch($){console.error("Logout error:",$)}};return e.jsxs("div",{className:"flex min-h-screen bg-white overflow-hidden",children:[e.jsx(ja,{isOpen:c,setIsOpen:h,onLogout:C,user:s,currentPath:u.pathname}),e.jsxs("div",{className:"flex-1 flex flex-col min-h-screen overflow-hidden content-responsive",children:[e.jsx(ya,{idleMinutes:10,warningSeconds:60}),e.jsx(Na,{setIsOpen:h,onLogout:C}),e.jsx("main",{className:"flex-1 p-responsive-md overflow-x-hidden overflow-y-auto text-black bg-white main-content-responsive",children:e.jsx("div",{className:"main-content-container",children:e.jsxs($t,{children:[e.jsx(ke,{path:"/overview",element:e.jsx(hs,{})}),e.jsx(ke,{path:"/product-insights",element:e.jsx(Xs,{})}),e.jsx(ke,{path:"/ai-visibility-analysis",element:e.jsx(Qs,{})}),e.jsx(ke,{path:"/qa-generation",element:e.jsx(Gt,{})}),e.jsx(ke,{path:"/enhance-content",element:e.jsx(Gt,{})}),e.jsx(ke,{path:"/content-structure-analysis",element:e.jsx(sa,{})}),e.jsx(ke,{path:"/ecommerce-content-analysis",element:e.jsx(xa,{})}),e.jsx(ke,{path:"/configuration",element:e.jsx(ia,{questionProvider:"gemini",questionModel:"gemini-2.0-flash",onQuestionProviderChange:()=>{},onQuestionModelChange:()=>{},answerProvider:"gemini",answerModel:"gemini-2.0-flash",onAnswerProviderChange:()=>{},onAnswerModelChange:()=>{},questionCount:5,onQuestionCountChange:()=>{}})}),e.jsx(ke,{path:"/history",element:e.jsx(Ms,{qaItems:T.flatMap($=>$.qaData),onExport:qs})}),e.jsx(ke,{path:"/statistics",element:e.jsx(gs,{sessions:T,currentSession:b})}),e.jsx(ke,{path:"/CloudFuzeLLMQA",element:e.jsx(Dt,{to:"/overview",replace:!0})}),e.jsx(ke,{path:"/",element:e.jsx(Dt,{to:"/overview",replace:!0})})]})})}),e.jsx(Sa,{})]})]})}function ka(){return e.jsx(ps,{children:e.jsx(Ca,{})})}Ls.createRoot(document.getElementById("root")).render(e.jsx(n.StrictMode,{children:e.jsx(xs,{children:e.jsx(ka,{})})}));
